/*Version 2.0.1.0*/
(function(n){var t={settings:{barWidth:1,barHeight:50,moduleSize:5,showHRI:!0,addQuietZone:!0,marginHRI:5,bgColor:"#FFFFFF",color:"#000000",fontSize:10,output:"css",posX:0,posY:0},intval:function(n){var t=typeof n;return t=="string"?(n=n.replace(/[^0-9-.]/g,""),n=parseInt(n*1,10),isNaN(n)||!isFinite(n)?0:n):t=="number"&&isFinite(n)?Math.floor(n):0},i25:{encoding:["NNWWN","WNNNW","NWNNW","WWNNN","NNWNW","WNWNN","NWWNN","NNNWW","WNNWN","NWNWN"],compute:function(n,i,r){var u,f,o,e;if(i){for(r=="int25"&&n.length%2==0&&(n="0"+n),u=!0,o=0,e=n.length-1;e>-1;e--){if(f=t.intval(n.charAt(e)),isNaN(f))return"";o+=u?3*f:f;u=!u}n+=((10-o%10)%10).toString()}else n.length%2!=0&&(n="0"+n);return n},getDigit:function(n,t,i){var r,u,f,e,o;if(n=this.compute(n,t,i),n=="")return"";if(result="",i=="int25"){for(result+="1010",r=0;r<n.length/2;r++)for(f=n.charAt(2*r),e=n.charAt(2*r+1),u=0;u<5;u++)result+="1",this.encoding[f].charAt(u)=="W"&&(result+="1"),result+="0",this.encoding[e].charAt(u)=="W"&&(result+="0");result+="1101"}else if(i=="std25"){for(result+="11011010",r=0;r<n.length;r++)for(o=n.charAt(r),u=0;u<5;u++)result+="1",this.encoding[o].charAt(u)=="W"&&(result+="11"),result+="0";result+="11010110"}return result}},ean:{encoding:[["0001101","0100111","1110010"],["0011001","0110011","1100110"],["0010011","0011011","1101100"],["0111101","0100001","1000010"],["0100011","0011101","1011100"],["0110001","0111001","1001110"],["0101111","0000101","1010000"],["0111011","0010001","1000100"],["0110111","0001001","1001000"],["0001011","0010111","1110100"]],first:["000000","001011","001101","001110","010011","011001","011100","010101","010110","011010"],getDigit:function(n,i){var e=i=="ean8"?7:12,f,u,o,r;if(n=n.substring(0,e),n.length!=e)return"";for(r=0;r<n.length;r++)if(f=n.charAt(r),f<"0"||f>"9")return"";if(n=this.compute(n,i),u="101",i=="ean8"){for(r=0;r<4;r++)u+=this.encoding[t.intval(n.charAt(r))][0];for(u+="01010",r=4;r<8;r++)u+=this.encoding[t.intval(n.charAt(r))][2]}else{for(o=this.first[t.intval(n.charAt(0))],r=1;r<7;r++)u+=this.encoding[t.intval(n.charAt(r))][t.intval(o.charAt(r-1))];for(u+="01010",r=7;r<13;r++)u+=this.encoding[t.intval(n.charAt(r))][2]}return u+"101"},compute:function(n,r){var e=r=="ean13"?12:7,f,u;for(n=n.substring(0,e),f=0,u=!0,i=n.length-1;i>-1;i--)f+=(u?3:1)*t.intval(n.charAt(i)),u=!u;return n+((10-f%10)%10).toString()}},upc:{getDigit:function(n){return n.length<12&&(n="0"+n),t.ean.getDigit(n,"ean13")},compute:function(n){return n.length<12&&(n="0"+n),t.ean.compute(n,"ean13").substr(1)}},msi:{encoding:["100100100100","100100100110","100100110100","100100110110","100110100100","100110100110","100110110100","100110110110","110100100100","110100100110"],compute:function(n,t){return typeof t=="object"?(t.crc1=="mod10"?n=this.computeMod10(n):t.crc1=="mod11"&&(n=this.computeMod11(n)),t.crc2=="mod10"?n=this.computeMod10(n):t.crc2=="mod11"&&(n=this.computeMod11(n))):typeof t=="boolean"&&t&&(n=this.computeMod10(n)),n},computeMod10:function(n){for(var r=n.length%2,u=0,f=0,e,i=0;i<n.length;i++)r?u=10*u+t.intval(n.charAt(i)):f+=t.intval(n.charAt(i)),r=!r;for(e=(2*u).toString(),i=0;i<e.length;i++)f+=t.intval(e.charAt(i));return n+((10-f%10)%10).toString()},computeMod11:function(n){for(var u=0,i=2,r=n.length-1;r>=0;r--)u+=i*t.intval(n.charAt(r)),i=i==7?2:i+1;return n+((11-u%11)%11).toString()},getDigit:function(n){var t=0,r="";for(n=this.compute(n,!1),r="110",i=0;i<n.length;i++){if(t="0123456789".indexOf(n.charAt(i)),t<0)return"";r+=this.encoding[t]}return r+"1001"}},code11:{encoding:["101011","1101011","1001011","1100101","1011011","1101101","1001101","1010011","1101001","110101","101101"],getDigit:function(n){for(var h="0123456789-",i,r="",u="0",s,l,r="1011001"+u,t=0;t<n.length;t++){if(i=h.indexOf(n.charAt(t)),i<0)return"";r+=this.encoding[i]+u}var f=0,c=0,e=1,o=0;for(t=n.length-1;t>=0;t--)f=f==10?1:f+1,e=e==10?1:e+1,i=h.indexOf(n.charAt(t)),c+=f*i,o+=e*i;return s=c%11,o+=s,l=o%11,r+=this.encoding[s]+u,n.length>=10&&(r+=this.encoding[l]+u),r+"1011001"}},code39:{encoding:["101001101101","110100101011","101100101011","110110010101","101001101011","110100110101","101100110101","101001011011","110100101101","101100101101","110101001011","101101001011","110110100101","101011001011","110101100101","101101100101","101010011011","110101001101","101101001101","101011001101","110101010011","101101010011","110110101001","101011010011","110101101001","101101101001","101010110011","110101011001","101101011001","101011011001","110010101011","100110101011","110011010101","100101101011","110010110101","100110110101","100101011011","110010101101","100110101101","100100100101","100100101001","100101001001","101001001001","100101101101"],getDigit:function(n){var t,i,r="";if(n.indexOf("*")>=0)return"";for(n=("*"+n+"*").toUpperCase(),t=0;t<n.length;t++){if(i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%*".indexOf(n.charAt(t)),i<0)return"";t>0&&(r+="0");r+=this.encoding[i]}return r}},code93:{encoding:["100010100","101001000","101000100","101000010","100101000","100100100","100100010","101010000","100010010","100001010","110101000","110100100","110100010","110010100","110010010","110001010","101101000","101100100","101100010","100110100","100011010","101011000","101001100","101000110","100101100","100010110","110110100","110110010","110101100","110100110","110010110","110011010","101101100","101100110","100110110","100111010","100101110","111010100","111010010","111001010","101101110","101110110","110101110","100100110","111011010","111010110","100110010","101011110"],getDigit:function(n,t){var s="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%____*",u="",r,c;if(n.indexOf("*")>=0)return"";for(n=n.toUpperCase(),u+=this.encoding[47],i=0;i<n.length;i++){if(r=n.charAt(i),index=s.indexOf(r),r=="_"||index<0)return"";u+=this.encoding[index]}if(t){var f=0,h=0,e=1,o=0;for(i=n.length-1;i>=0;i--)f=f==20?1:f+1,e=e==15?1:e+1,index=s.indexOf(n.charAt(i)),h+=f*index,o+=e*index;r=h%47;o+=r;c=o%47;u+=this.encoding[r];u+=this.encoding[c]}return u+=this.encoding[47],u+"1"}},code128:{encoding:["11011001100","11001101100","11001100110","10010011000","10010001100","10001001100","10011001000","10011000100","10001100100","11001001000","11001000100","11000100100","10110011100","10011011100","10011001110","10111001100","10011101100","10011100110","11001110010","11001011100","11001001110","11011100100","11001110100","11101101110","11101001100","11100101100","11100100110","11101100100","11100110100","11100110010","11011011000","11011000110","11000110110","10100011000","10001011000","10001000110","10110001000","10001101000","10001100010","11010001000","11000101000","11000100010","10110111000","10110001110","10001101110","10111011000","10111000110","10001110110","11101110110","11010001110","11000101110","11011101000","11011100010","11011101110","11101011000","11101000110","11100010110","11101101000","11101100010","11100011010","11101111010","11001000010","11110001010","10100110000","10100001100","10010110000","10010000110","10000101100","10000100110","10110010000","10110000100","10011010000","10011000010","10000110100","10000110010","11000010010","11001010000","11110111010","11000010100","10001111010","10100111100","10010111100","10010011110","10111100100","10011110100","10011110010","11110100100","11110010100","11110010010","11011011110","11011110110","11110110110","10101111000","10100011110","10001011110","10111101000","10111100010","11110101000","11110100010","10111011110","10111101110","11101011110","11110101110","11010000100","11010010000","11010011100","11000111010"],getDigit:function(n){for(var c=" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",f="",e=0,h=0,i=0,r=0,o=0,u,s,i=0;i<n.length;i++)if(c.indexOf(n.charAt(i))==-1)return"";for(u=n.length>1,s="",i=0;i<3&&i<n.length;i++)s=n.charAt(i),u&=s>="0"&&s<="9";for(e=u?105:104,f=this.encoding[e],i=0;i<n.length;){if(u)(i==n.length||n.charAt(i)<"0"||n.charAt(i)>"9"||n.charAt(i+1)<"0"||n.charAt(i+1)>"9")&&(u=!1,f+=this.encoding[100],e+=++h*100);else{for(r=0;i+r<n.length&&n.charAt(i+r)>="0"&&n.charAt(i+r)<="9";)r++;u=r>5||i+r-1==n.length&&r>3;u&&(f+=this.encoding[99],e+=++h*99)}u?(o=t.intval(n.charAt(i)+n.charAt(i+1)),i+=2):(o=c.indexOf(n.charAt(i)),i+=1);f+=this.encoding[o];e+=++h*o}return f+=this.encoding[e%103],f+=this.encoding[106],f+"11"}},codabar:{encoding:["101010011","101011001","101001011","110010101","101101001","110101001","100101011","100101101","100110101","110100101","101001101","101100101","1101011011","1101101011","1101101101","1011011011","1011001001","1010010011","1001001011","1010011001"],getDigit:function(n){var t,i,r="",u="0";for(r+=this.encoding[16]+u,t=0;t<n.length;t++){if(i="0123456789-$:/.+".indexOf(n.charAt(t)),i<0)return"";r+=this.encoding[i]+u}return r+this.encoding[16]}},datamatrix:{lengthRows:[10,12,14,16,18,20,22,24,26,32,36,40,44,48,52,64,72,80,88,96,104,120,132,144,8,8,12,12,16,16],lengthCols:[10,12,14,16,18,20,22,24,26,32,36,40,44,48,52,64,72,80,88,96,104,120,132,144,18,32,26,36,36,48],dataCWCount:[3,5,8,12,18,22,30,36,44,62,86,114,144,174,204,280,368,456,576,696,816,1050,1304,1558,5,10,16,22,32,49],solomonCWCount:[5,7,10,12,14,18,20,24,28,36,42,48,56,68,84,112,144,192,224,272,336,408,496,620,7,11,14,18,24,28],dataRegionRows:[8,10,12,14,16,18,20,22,24,14,16,18,20,22,24,14,16,18,20,22,24,18,20,22,6,6,10,10,14,14],dataRegionCols:[8,10,12,14,16,18,20,22,24,14,16,18,20,22,24,14,16,18,20,22,24,18,20,22,16,14,24,16,16,22],regionRows:[1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,4,4,4,4,4,4,6,6,6,1,1,1,1,1,1],regionCols:[1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,4,4,4,4,4,4,6,6,6,1,2,1,2,2,2],interleavedBlocks:[1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,4,4,4,4,6,6,8,8,1,1,1,1,1,1],logTab:[-255,255,1,240,2,225,241,53,3,38,226,133,242,43,54,210,4,195,39,114,227,106,134,28,243,140,44,23,55,118,211,234,5,219,196,96,40,222,115,103,228,78,107,125,135,8,29,162,244,186,141,180,45,99,24,49,56,13,119,153,212,199,235,91,6,76,220,217,197,11,97,184,41,36,223,253,116,138,104,193,229,86,79,171,108,165,126,145,136,34,9,74,30,32,163,84,245,173,187,204,142,81,181,190,46,88,100,159,25,231,50,207,57,147,14,67,120,128,154,248,213,167,200,63,236,110,92,176,7,161,77,124,221,102,218,95,198,90,12,152,98,48,185,179,42,209,37,132,224,52,254,239,117,233,139,22,105,27,194,113,230,206,87,158,80,189,172,203,109,175,166,62,127,247,146,66,137,192,35,252,10,183,75,216,31,83,33,73,164,144,85,170,246,65,174,61,188,202,205,157,143,169,82,72,182,215,191,251,47,178,89,151,101,94,160,123,26,112,232,21,51,238,208,131,58,69,148,18,15,16,68,17,121,149,129,19,155,59,249,70,214,250,168,71,201,156,64,60,237,130,111,20,93,122,177,150],aLogTab:[1,2,4,8,16,32,64,128,45,90,180,69,138,57,114,228,229,231,227,235,251,219,155,27,54,108,216,157,23,46,92,184,93,186,89,178,73,146,9,18,36,72,144,13,26,52,104,208,141,55,110,220,149,7,14,28,56,112,224,237,247,195,171,123,246,193,175,115,230,225,239,243,203,187,91,182,65,130,41,82,164,101,202,185,95,190,81,162,105,210,137,63,126,252,213,135,35,70,140,53,106,212,133,39,78,156,21,42,84,168,125,250,217,159,19,38,76,152,29,58,116,232,253,215,131,43,86,172,117,234,249,223,147,11,22,44,88,176,77,154,25,50,100,200,189,87,174,113,226,233,255,211,139,59,118,236,245,199,163,107,214,129,47,94,188,85,170,121,242,201,191,83,166,97,194,169,127,254,209,143,51,102,204,181,71,142,49,98,196,165,103,206,177,79,158,17,34,68,136,61,122,244,197,167,99,198,161,111,222,145,15,30,60,120,240,205,183,67,134,33,66,132,37,74,148,5,10,20,40,80,160,109,218,153,31,62,124,248,221,151,3,6,12,24,48,96,192,173,119,238,241,207,179,75,150,1],champGaloisMult:function(n,t){return!n||!t?0:this.aLogTab[(this.logTab[n]+this.logTab[t])%255]},champGaloisDoub:function(n,t){return n?t?this.aLogTab[(this.logTab[n]+t)%255]:n:0},champGaloisSum:function(n,t){return n^t},selectIndex:function(n,t){if((n<1||n>1558)&&!t||(n<1||n>49)&&t)return-1;var i=0;for(t&&(i=24);this.dataCWCount[i]<n;)i++;return i},encodeDataCodeWordsASCII:function(n){for(var u=[],r=0,t,i=0;i<n.length;i++)t=n.charCodeAt(i),t>127?(u[r]=235,t=t-127,r++):t>=48&&t<=57&&i+1<n.length&&n.charCodeAt(i+1)>=48&&n.charCodeAt(i+1)<=57?(t=(t-48)*10+(n.charCodeAt(i+1)-48),t+=130,i++):t++,u[r]=t,r++;return u},addPadCW:function(n,t,i){if(!(t>=i)){n[t]=129;for(var u,r=t+1;r<i;r++)u=149*(r+1)%253+1,n[r]=(129+u)%254}},calculSolFactorTable:function(n){for(var r=[],i,t=0;t<=n;t++)r[t]=1;for(t=1;t<=n;t++)for(i=t-1;i>=0;i--)r[i]=this.champGaloisDoub(r[i],t),i>0&&(r[i]=this.champGaloisSum(r[i],r[i-1]));return r},addReedSolomonCW:function(n,t,i,r,u){for(var c=0,h=n/u,o=[],f,e,s=0;s<u;s++){for(f=0;f<h;f++)o[f]=0;for(f=s;f<i;f=f+u)for(c=this.champGaloisSum(r[f],o[h-1]),e=h-1;e>=0;e--)o[e]=c?this.champGaloisMult(c,t[e]):0,e>0&&(o[e]=this.champGaloisSum(o[e-1],o[e]));for(e=i+s,f=h-1;f>=0;f--)r[e]=o[f],e=e+u}return r},getBits:function(n){for(var i=[],t=0;t<8;t++)i[t]=n&128>>t?1:0;return i},next:function(n,t,i,r,u,f){var s=0,e=4,o=0;do{e==t&&o==0?(this.patternShapeSpecial1(u,f,r[s],t,i),s++):n<3&&e==t-2&&o==0&&i%4!=0?(this.patternShapeSpecial2(u,f,r[s],t,i),s++):e==t-2&&o==0&&i%8==4?(this.patternShapeSpecial3(u,f,r[s],t,i),s++):e==t+4&&o==2&&i%8==0&&(this.patternShapeSpecial4(u,f,r[s],t,i),s++);do e<t&&o>=0&&f[e][o]!=1&&(this.patternShapeStandard(u,f,r[s],e,o,t,i),s++),e-=2,o+=2;while(e>=0&&o<i);e+=1;o+=3;do e>=0&&o<i&&f[e][o]!=1&&(this.patternShapeStandard(u,f,r[s],e,o,t,i),s++),e+=2,o-=2;while(e<t&&o>=0);e+=3;o+=1}while(e<t||o<i)},patternShapeStandard:function(n,t,i,r,u,f,e){this.placeBitInDatamatrix(n,t,i[0],r-2,u-2,f,e);this.placeBitInDatamatrix(n,t,i[1],r-2,u-1,f,e);this.placeBitInDatamatrix(n,t,i[2],r-1,u-2,f,e);this.placeBitInDatamatrix(n,t,i[3],r-1,u-1,f,e);this.placeBitInDatamatrix(n,t,i[4],r-1,u,f,e);this.placeBitInDatamatrix(n,t,i[5],r,u-2,f,e);this.placeBitInDatamatrix(n,t,i[6],r,u-1,f,e);this.placeBitInDatamatrix(n,t,i[7],r,u,f,e)},patternShapeSpecial1:function(n,t,i,r,u){this.placeBitInDatamatrix(n,t,i[0],r-1,0,r,u);this.placeBitInDatamatrix(n,t,i[1],r-1,1,r,u);this.placeBitInDatamatrix(n,t,i[2],r-1,2,r,u);this.placeBitInDatamatrix(n,t,i[3],0,u-2,r,u);this.placeBitInDatamatrix(n,t,i[4],0,u-1,r,u);this.placeBitInDatamatrix(n,t,i[5],1,u-1,r,u);this.placeBitInDatamatrix(n,t,i[6],2,u-1,r,u);this.placeBitInDatamatrix(n,t,i[7],3,u-1,r,u)},patternShapeSpecial2:function(n,t,i,r,u){this.placeBitInDatamatrix(n,t,i[0],r-3,0,r,u);this.placeBitInDatamatrix(n,t,i[1],r-2,0,r,u);this.placeBitInDatamatrix(n,t,i[2],r-1,0,r,u);this.placeBitInDatamatrix(n,t,i[3],0,u-4,r,u);this.placeBitInDatamatrix(n,t,i[4],0,u-3,r,u);this.placeBitInDatamatrix(n,t,i[5],0,u-2,r,u);this.placeBitInDatamatrix(n,t,i[6],0,u-1,r,u);this.placeBitInDatamatrix(n,t,i[7],1,u-1,r,u)},patternShapeSpecial3:function(n,t,i,r,u){this.placeBitInDatamatrix(n,t,i[0],r-3,0,r,u);this.placeBitInDatamatrix(n,t,i[1],r-2,0,r,u);this.placeBitInDatamatrix(n,t,i[2],r-1,0,r,u);this.placeBitInDatamatrix(n,t,i[3],0,u-2,r,u);this.placeBitInDatamatrix(n,t,i[4],0,u-1,r,u);this.placeBitInDatamatrix(n,t,i[5],1,u-1,r,u);this.placeBitInDatamatrix(n,t,i[6],2,u-1,r,u);this.placeBitInDatamatrix(n,t,i[7],3,u-1,r,u)},patternShapeSpecial4:function(n,t,i,r,u){this.placeBitInDatamatrix(n,t,i[0],r-1,0,r,u);this.placeBitInDatamatrix(n,t,i[1],r-1,u-1,r,u);this.placeBitInDatamatrix(n,t,i[2],0,u-3,r,u);this.placeBitInDatamatrix(n,t,i[3],0,u-2,r,u);this.placeBitInDatamatrix(n,t,i[4],0,u-1,r,u);this.placeBitInDatamatrix(n,t,i[5],1,u-3,r,u);this.placeBitInDatamatrix(n,t,i[6],1,u-2,r,u);this.placeBitInDatamatrix(n,t,i[7],1,u-1,r,u)},placeBitInDatamatrix:function(n,t,i,r,u,f,e){r<0&&(r+=f,u+=4-(f+4)%8);u<0&&(u+=e,r+=4-(e+4)%8);t[r][u]!=1&&(n[r][u]=i,t[r][u]=1)},addFinderPattern:function(n,t,i,r,u){var h=(r+2)*t,s=(u+2)*i,o=[],e,f;for(o[0]=[],f=0;f<s+2;f++)o[0][f]=0;for(e=0;e<h;e++)for(o[e+1]=[],o[e+1][0]=0,o[e+1][s+1]=0,f=0;f<s;f++)e%(r+2)==0?o[e+1][f+1]=f%2==0?1:0:e%(r+2)==r+1?o[e+1][f+1]=1:f%(u+2)==u+1?o[e+1][f+1]=e%2==0?0:1:f%(u+2)==0?o[e+1][f+1]=1:(o[e+1][f+1]=0,o[e+1][f+1]=n[e-1-2*parseInt(e/(r+2))][f-1-2*parseInt(f/(u+2))]);for(o[h+1]=[],f=0;f<s+2;f++)o[h+1][f]=0;return o},getDigit:function(n,t){var s=this.encodeDataCodeWordsASCII(n),a=s.length,f=this.selectIndex(a,t),h=this.dataCWCount[f],c=this.solomonCWCount[f],b=h+c,k=this.lengthRows[f],d=this.lengthCols[f],v=this.regionRows[f],y=this.regionCols[f],g=this.dataRegionRows[f],nt=this.dataRegionCols[f],r=k-2*v,i=d-2*y,p=this.interleavedBlocks[f],tt=c/p,w,l,e,o,u;for(this.addPadCW(s,a,h),w=this.calculSolFactorTable(tt),this.addReedSolomonCW(c,w,h,s,p),l=[],u=0;u<b;u++)l[u]=this.getBits(s[u]);for(e=[],o=[],u=0;u<i;u++)e[u]=[],o[u]=[];return r*i%8==4&&(e[r-2][i-2]=1,e[r-1][i-1]=1,e[r-1][i-2]=0,e[r-2][i-1]=0,o[r-2][i-2]=1,o[r-1][i-1]=1,o[r-1][i-2]=1,o[r-2][i-1]=1),this.next(0,r,i,l,e,o),this.addFinderPattern(e,v,y,g,nt)}},lec:{cInt:function(n,t){for(var i="",r=0;r<t;r++)i+=String.fromCharCode(n&255),n=n>>8;return i},cRgb:function(n,t,i){return String.fromCharCode(i)+String.fromCharCode(t)+String.fromCharCode(n)},cHexColor:function(n){var t=parseInt("0x"+n.substr(1)),u=t&255,i,r;return t=t>>8,i=t&255,r=t>>8,this.cRgb(r,i,u)}},hexToRGB:function(n){var t=parseInt("0x"+n.substr(1)),u=t&255,i,r;return t=t>>8,i=t&255,r=t>>8,{r:r,g:i,b:u}},isHexColor:function(n){var t=new RegExp("#[0-91-F]","gi");return n.match(t)},base64Encode:function(n){for(var s="",e,t,i,h,c,o,r,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",f=0;f<n.length;)e=n.charCodeAt(f++),t=n.charCodeAt(f++),i=n.charCodeAt(f++),h=e>>2,c=(e&3)<<4|t>>4,o=(t&15)<<2|i>>6,r=i&63,isNaN(t)?o=r=64:isNaN(i)&&(r=64),s+=u.charAt(h)+u.charAt(c)+u.charAt(o)+u.charAt(r);return s},bitStringTo2DArray:function(n){var i=[],t;for(i[0]=[],t=0;t<n.length;t++)i[0][t]=n.charAt(t);return i},resize:function(n,t){return n.css("padding","0px").css("overflow","auto").css("width",t+"px").html(""),n},digitToBmpRenderer:function(n,t,i,r,u,f){for(var a=i.length,o=i[0].length,e=0,g=this.isHexColor(t.bgColor)?this.lec.cHexColor(t.bgColor):this.lec.cRgb(255,255,255),nt=this.isHexColor(t.color)?this.lec.cHexColor(t.color):this.lec.cRgb(0,0,0),w="",b="",y,s,h,c,p,l,e=0;e<u;e++)w+=g,b+=nt;var v=(4-u*o*3%4)%4,k=(u*o+v)*f*a,d="";for(e=0;e<v;e++)d+='\0';for(y="BM"+this.lec.cInt(54+k,4)+'\0\0\0\0'+this.lec.cInt(54,4)+this.lec.cInt(40,4)+this.lec.cInt(u*o,4)+this.lec.cInt(f*a,4)+this.lec.cInt(1,2)+this.lec.cInt(24,2)+'\0\0\0\0'+this.lec.cInt(k,4)+this.lec.cInt(2835,4)+this.lec.cInt(2835,4)+this.lec.cInt(0,4)+this.lec.cInt(0,4),s=a-1;s>=0;s--){for(h="",c=0;c<o;c++)h+=i[s][c]=="0"?w:b;for(h+=d,p=0;p<f;p++)y+=h}l=document.createElement("object");l.setAttribute("type","image/bmp");l.setAttribute("data","data:image/bmp;base64,"+this.base64Encode(y));this.resize(n,u*o+v).append(l)},digitToBmp:function(n,i,r,u){var f=t.intval(i.barWidth),e=t.intval(i.barHeight);this.digitToBmpRenderer(n,i,this.bitStringTo2DArray(r),u,f,e)},digitToBmp2D:function(n,i,r,u){var f=t.intval(i.moduleSize);this.digitToBmpRenderer(n,i,r,u,f,f)},digitToCssRenderer:function(n,t,i,r,u,f){for(var h,y=i.length,l=i[0].length,c="",a='<div style="float: left; font-size: 0px; background-color: '+t.bgColor+"; height: "+f+'px; width: &Wpx"><\/div>',v='<div style="float: left; font-size: 0px; width:0; border-left: &Wpx solid '+t.color+"; height: "+f+'px;"><\/div>',e,o,s=0;s<y;s++){for(e=0,o=i[s][0],h=0;h<l;h++)o==i[s][h]?e++:(c+=(o=="0"?a:v).replace("&W",e*u),o=i[s][h],e=1);e>0&&(c+=(o=="0"?a:v).replace("&W",e*u))}t.showHRI&&(c+='<div style="clear:both; width: 100%; background-color: '+t.bgColor+"; color: "+t.color+"; text-align: center; font-size: "+t.fontSize+"px; margin-top: "+t.marginHRI+'px;">'+r+"<\/div>");this.resize(n,u*l).html(c)},digitToCss:function(n,i,r,u){var f=t.intval(i.barWidth),e=t.intval(i.barHeight);this.digitToCssRenderer(n,i,this.bitStringTo2DArray(r),u,f,e)},digitToCss2D:function(n,i,r,u){var f=t.intval(i.moduleSize);this.digitToCssRenderer(n,i,r,u,f,f)},digitToSvgRenderer:function(n,i,r,u,f,e){var k=r.length,w=r[0].length,a=f*w,v=e*k,y,o,b,s,l,h,c,p;for(i.showHRI&&(y=t.intval(i.fontSize),v+=t.intval(i.marginHRI)+y),o='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="'+a+'" height="'+v+'">',o+='<rect width="'+a+'" height="'+v+'" x="0" y="0" fill="'+i.bgColor+'" />',b='<rect width="&W" height="'+e+'" x="&X" y="&Y" fill="'+i.color+'" />',h=0;h<k;h++){for(s=0,l=r[h][0],c=0;c<w;c++)l==r[h][c]?s++:(l=="1"&&(o+=b.replace("&W",s*f).replace("&X",(c-s)*f).replace("&Y",h*e)),l=r[h][c],s=1);s>0&&l=="1"&&(o+=b.replace("&W",s*f).replace("&X",(w-s)*f).replace("&Y",h*e))}i.showHRI&&(o+='<g transform="translate('+Math.floor(a/2)+' 0)">',o+='<text y="'+(v-Math.floor(y/2))+'" text-anchor="middle" style="font-family: Arial; font-size: '+y+'px;" fill="'+i.color+'">'+u+"<\/text>",o+="<\/g>");o+="<\/svg>";p=document.createElement("object");p.setAttribute("type","image/svg+xml");p.setAttribute("data","data:image/svg+xml,"+o);this.resize(n,a).append(p)},digitToSvg:function(n,i,r,u){var f=t.intval(i.barWidth),e=t.intval(i.barHeight);this.digitToSvgRenderer(n,i,this.bitStringTo2DArray(r),u,f,e)},digitToSvg2D:function(n,i,r,u){var f=t.intval(i.moduleSize);this.digitToSvgRenderer(n,i,r,u,f,f)},digitToCanvasRenderer:function(n,t,i,r,u,f,e,o){var y=n.get(0),h,c,a,l,w;if(y&&y.getContext){var p=i.length,v=i[0].length,s=y.getContext("2d");for(s.lineWidth=1,s.lineCap="butt",s.fillStyle=t.bgColor,s.fillRect(u,f,v*e,p*o),s.fillStyle=t.color,h=0;h<p;h++){for(c=0,a=i[h][0],l=0;l<v;l++)a==i[h][l]?c++:(a=="1"&&s.fillRect(u+(l-c)*e,f+h*o,e*c,o),a=i[h][l],c=1);c>0&&a=="1"&&s.fillRect(u+(v-c)*e,f+h*o,e*c,o)}t.showHRI&&(w=s.measureText(r),s.fillText(r,u+Math.floor((v*e-w.width)/2),f+p*o+t.fontSize+t.marginHRI))}},digitToCanvas:function(n,i,r,u){var f=t.intval(i.barWidth),e=t.intval(i.barHeight),o=t.intval(i.posX),s=t.intval(i.posY);this.digitToCanvasRenderer(n,i,this.bitStringTo2DArray(r),u,o,s,f,e)},digitToCanvas2D:function(n,i,r,u){var f=t.intval(i.moduleSize),e=t.intval(i.posX),o=t.intval(i.posY);this.digitToCanvasRenderer(n,i,r,u,e,o,f,f)}};n.fn.extend({barcode:function(i,r,u){var e="",o="",f="",s=!0,v=!1,c=!1,h,l,a;if(typeof i=="string"?f=i:typeof i=="object"&&(f=typeof i.code=="string"?i.code:"",s=typeof i.crc!="undefined"?i.crc:!0,v=typeof i.rect!="undefined"?i.rect:!1),f=="")return!1;typeof u=="undefined"&&(u=[]);for(h in t.settings)u[h]==undefined&&(u[h]=t.settings[h]);switch(r){case"std25":case"int25":e=t.i25.getDigit(f,s,r);o=t.i25.compute(f,s,r);break;case"ean8":case"ean13":e=t.ean.getDigit(f,r);o=t.ean.compute(f,r);break;case"upc":e=t.upc.getDigit(f);o=t.upc.compute(f);break;case"code11":e=t.code11.getDigit(f);o=f;break;case"code39":e=t.code39.getDigit(f);o=f;break;case"code93":e=t.code93.getDigit(f,s);o=f;break;case"code128":e=t.code128.getDigit(f);o=f;break;case"codabar":e=t.codabar.getDigit(f);o=f;break;case"msi":e=t.msi.getDigit(f,s);o=t.msi.compute(f,s);break;case"datamatrix":e=t.datamatrix.getDigit(f,v);o=f;c=!0}return e.length==0?n(this):(!c&&u.addQuietZone&&(e="0000000000"+e+"0000000000"),l=n(this),a="digitTo"+u.output.charAt(0).toUpperCase()+u.output.substr(1)+(c?"2D":""),typeof t[a]=="function"&&t[a](l,u,e,o),l)}})})(jQuery),function(n){function i(n,t){if(!(n.originalEvent.touches.length>1)){n.preventDefault();var i=n.originalEvent.changedTouches[0],r=document.createEvent("MouseEvents");r.initMouseEvent(t,!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null);n.target.dispatchEvent(r)}}if(n.support.touch="ontouchend"in document,n.support.touch){var t=n.ui.mouse.prototype,u=t._mouseInit,f=t._mouseDestroy,r;t._touchStart=function(n){var t=this;!r&&t._mouseCapture(n.originalEvent.changedTouches[0])&&(r=!0,t._touchMoved=!1,i(n,"mouseover"),i(n,"mousemove"),i(n,"mousedown"))};t._touchMove=function(n){r&&(this._touchMoved=!0,i(n,"mousemove"))};t._touchEnd=function(n){r&&(i(n,"mouseup"),i(n,"mouseout"),this._touchMoved||i(n,"click"),r=!1)};t._mouseInit=function(){var t=this;t.element.bind({touchstart:n.proxy(t,"_touchStart"),touchmove:n.proxy(t,"_touchMove"),touchend:n.proxy(t,"_touchEnd")});u.call(t)};t._mouseDestroy=function(){var t=this;t.element.unbind({touchstart:n.proxy(t,"_touchStart"),touchmove:n.proxy(t,"_touchMove"),touchend:n.proxy(t,"_touchEnd")});f.call(t)}}}(jQuery);VA005=window.VA005||{},function(n,t){n.ProductMgtForm=function(){function la(){var r,n;gr=t("<td class='VA005-Left-Bar vis-leftsidebarouterwrap'>");sr=t("<div class='VA005-apanel-lb'>");be=t("<div class='vis-apanel-lb-toggle' ><i class='fa fa-bars' aria-hidden='true'><\/i><\/div>");ls=t('<div class="vis-input-wrap"><div class="VA005-Serach-Query vis-control-wrap"><Select id = queryCat_'+i.windowNo+" ><\/Select><label>"+VIS.Msg.getMsg("VA005_SearchQuery")+"<\/label><\/div><\/div>");cc=t('<div class="vis-input-wrap"><div class="VA005-Serach-Query vis-control-wrap"><Select id = "searchBy_'+i.windowNo+'" ><option selected="selected" value="C">'+VIS.Msg.getMsg("VA005_SearchByCat")+'<\/option><option value="T">'+VIS.Msg.getMsg("VA005_SearchByTree")+"<\/option><\/Select><label>"+VIS.Msg.getMsg("VA005_SearchBy")+"<\/label><\/div><\/div>");yf=t('<div class="VA005-left-input-panel input-group vis-input-wrap"><div class="vis-control-wrap"><input id = VA005_searchCat_'+i.windowNo+' class="VA005-left-panelInput" type="text" value="" placeholder="'+VIS.Msg.getMsg("Search")+'" data-hasbtn=" "><\/div><div class="input-group-append"><button class="VA005-leftpanelcatsearchbtn input-group-text vis-group-search-icon"><i class="vis vis-search"><\/i><\/button><\/div><\/div>');yi=t("<ul id= leftUi_"+i.windowNo+">");ot=t('<div class="vis-apanel-lb-main VA005-div-left-main">');ot.append(ls);ot.append(cc);ot.append('<div class="VA005-left-cat-panel"> <h4>'+VIS.Msg.getMsg("VA005_Categories")+"<\/h4><\/div>");ot.append(yf);ot.append(yi);ot.append(si);sr.append(be);sr.append(ot);gr.append(sr);ur=t('<div class="VA005-middle-head"><div class="VA005-middle-search"><button class="vis-group-add-btn VA005-leftpanelcatsearchbtn input-group-text" style="margin-bottom: 15px;"><i class="vis vis-plus"><\/i><\/button><div class="input-group vis-input-wrap"><div class="vis-control-wrap"><input class="vis-group-SearchText vis-group-addLeft" value="" placeholder="'+VIS.Msg.getMsg("Search")+'" data-placeholder="" data-hasbtn=" " type="text"><\/div><div class="input-group-append"><button class="vis-group-search-icon VA005-leftpanelcatsearchbtn input-group-text"><i class="vis vis-search"><\/i><\/button><\/div><\/div><\/div><div class="VA005-middle-icons"><ul><li id="btnRefreshForm_'+i.windowNo+'"><span class="vis vis-refresh VA005-icons-font" title="'+VIS.Msg.getMsg("VA005_Refresh")+'"><\/span><\/li><li id="btnCopy_'+i.windowNo+'"><span class="vis vis-copy VA005-icons-font" title="'+VIS.Msg.getMsg("Copy")+'"><\/span><\/li><li id="btnImage_'+i.windowNo+'"><span class="vis vis-image VA005-icons-font" title="'+VIS.Msg.getMsg("VA005_UploadImage")+'"><\/span><\/li><li id="btnSupplier_'+i.windowNo+'"><span class="vis vis-user VA005-icons-font" title="'+VIS.Msg.getMsg("VA005_UpdateSupplier")+'"><\/span><\/li><li id="btnPriceList_'+i.windowNo+'"><span class="fa fa-usd VA005-icons-font" title="'+VIS.Msg.getMsg("VA005_UpdatePrice")+'"><\/span><\/li><li id="btnAddCart_'+i.windowNo+'"><span class="fa fa-shopping-cart VA005-icons-font" title="'+VIS.Msg.getMsg("VA005_AddCart")+'"><\/span><\/li><li id="btnEditMuLtiple_'+i.windowNo+'"><span class="vis vis-edit VA005-icons-font" title="'+VIS.Msg.getMsg("VA005_UpdateProduct")+'"><\/span><\/li><\/ul><\/div><\/div><div class="VA005-middle-cat-bar"><span style="font-weight:bold;">'+VIS.Msg.getMsg("VA005_Categories")+' : <\/span><span id="btnShowAll_'+i.windowNo+'" class="vis-group-pointer" style="color:rgba(var(--v-c-primary), 1);">'+VIS.Msg.getMsg("All")+'<\/span> <span id="catInfo_'+i.windowNo+'" style="display:none;"><\/span><\/div><div class="VA005-middle-cart-bar"><input type="checkbox" id="VA005_chkAll_'+i.windowNo+'"><\/input><span>'+VIS.Msg.getMsg("SelectAll")+'<\/span><div class="VA005-selectedCartLblWrap"><span style="font-weight:bold;">'+VIS.Msg.getMsg("VA005_SelectedCart")+' : <\/span><span id="VA005_cartInfo_'+i.windowNo+'">'+VIS.Msg.getMsg("None")+"<\/span><\/div><\/div>");vr=t('<div class="VA005-right-head VA005-tab-control"><ul class="VA005-tabs" style="overflow: auto;white-space: nowrap;"><li id="VA005_btnDetails_'+i.windowNo+'" class="VA005-selectedTab">'+VIS.Msg.getMsg("Details")+'<\/li><li id="VA005_btnVarient_'+i.windowNo+'">'+VIS.Msg.getMsg("VA005_Varients")+'<\/li><li id="VA005_btnUom_'+i.windowNo+'">'+VIS.Msg.getElement(VIS.Env.getCtx(),"C_UOM_ID")+'<\/li><li id="VA005_btnRelated_'+i.windowNo+'">'+VIS.Msg.getMsg("Related")+'<\/li><li id="VA005_btnCart_'+i.windowNo+'">'+VIS.Msg.getMsg("VA005_Cart")+"<\/li><\/ul><\/div>");go=t('<div class="VA005-attListing-header"><p id="VA005_SelectedNodeText_'+i.windowNo+'" class="VA005-attListing-title">bfehfh<\/p><div style="float:right"><span id="VA005_btnDeleteAttVal_'+i.windowNo+'"  class="VA005-RemoveLinkeImage VA005-AttValOpacity" style="font-size:18px;margin-right:6px" title="'+VIS.Msg.getMsg("VA005_RemoveImage")+'"><\/span><span id="VA005_btnDeleteCross_'+i.windowNo+'"  style="font-size: 18px; cursor: pointer" class="vis vis-mark " title="'+VIS.Msg.getMsg("VA005_Close")+'"><\/span><\/div><\/div>');v=t('<div class="VA005-AttributesValMainDiv"><\/div>');li=t('<div class="VA005-middle-left-main" style="height:98%" >').append(ur);o=t('<div class="VA005-middle-right-main">');hr=t('<div class="VA005-middle-right-main">');r='<div class="VA005-Image-panel-top"><div class="VA005-Image-panel-div"><i id="VA005_btnerase_'+i.windowNo+'" class="fa fa-eraser" title="'+VIS.Msg.getMsg("Clear")+'"><\/i><span id="VA005_ImgDelete_'+i.windowNo+'" class="vis vis-delete" title="'+VIS.Msg.getMsg("DeleteActivity")+'"><\/span><span id="VA005_btnUpload_'+i.windowNo+'" class="vis vis-upload" title="'+VIS.Msg.getMsg("VA005_UploadImage")+'"><\/span><span id="VA005_btnImgCancel_'+i.windowNo+'" class="fa fa-times-circle-o" style="font-size: 22px !important;" title="'+VIS.Msg.getMsg("Cancel")+'"><\/span><\/div><\/div>';hr.append(r);n=t('<div class="VA005-div-images"><ul class="VA005-productimgul"><\/ul><\/div>');hr.append(n);wu=n.find(".VA005-productimgul");hr.hide();pf=t("<td>");ke=t('<div style="position: relative;width: 100%;height: 100%;background-color:white;">');lc=t('<div class="VA005-middle-div-main vis-formouterwrpdiv">').append(li).append(o).append(hr);ke.append(lc);pf.append(ke);as=t("<tr>").append(gr).append(pf);vf=t("<table style='width:100%;height:100%;'>");vf.append(as);f.append(vf);o.append(vr);ft=f.find("#queryCat_"+i.windowNo);wf=f.find("#searchBy_"+i.windowNo);vs=f.find("#leftUi_"+i.windowNo);ys=f.find(".VA005-left-cat-panel");gi=ot.find("#VA005_searchCat_"+i.windowNo);ac=ot.find(".vis-group-search-icon");uh=f.find("#btnCopy_"+i.windowNo);to=f.find("#btnImage_"+i.windowNo);fh=f.find("#btnPriceList_"+i.windowNo);eh=f.find("#btnSupplier_"+i.windowNo);oh=f.find("#btnEditMuLtiple_"+i.windowNo);ue=f.find("#btnAddCart_"+i.windowNo);sh=f.find("#btnShowAll_"+i.windowNo);lt=f.find("#VA005_chkAll_"+i.windowNo);rf=f.find("#VA005_btnDetails_"+i.windowNo);lu=f.find("#VA005_btnVarient_"+i.windowNo);au=f.find("#VA005_btnUom_"+i.windowNo);uf=f.find("#VA005_btnRelated_"+i.windowNo);fe=f.find("#VA005_btnCart_"+i.windowNo);ro=f.find("#VA005_ImgDelete_"+i.windowNo);eo=f.find("#VA005_btnerase_"+i.windowNo);io=f.find("#VA005_btnUpload_"+i.windowNo);vh=f.find("#VA005_btnImgCancel_"+i.windowNo);nl=f.find("#btnRefreshForm_"+i.windowNo);tf=f.find("#catInfo_"+i.windowNo);aa();va();dr=t('<ul class="vis-apanel-rb-ul"><li data-action="zoom" style="opacity: 1" title="'+VIS.Msg.getMsg("VA005_Zoom")+'"><i class="vis vis-find" data-action="zoom"><\/i><\/li><li data-action="refresh" title="'+VIS.Msg.getMsg("VA005_Refresh")+'"><i class="vis vis-refresh" data-action="refresh"><\/i><\/li><\/ul');$ImageZoom=t('<div id="popupPhotoLandscape" class="VA005-large"><\/div>');f.append($ImageZoom);$ImageZoom.hide();sr.height(gr.height());ot.height(sr.height()-43);ko=ot.height()-f.find(".VA005-Serach-Query").height()*2-30}function bu(n,i,u){t.ajax({url:VIS.Application.contextUrl+"VA005/ProductManagement/GetProdCats",type:"GET",datatype:"json",contentType:"application/json; charset=utf-8",data:{searchText:n,pageNo:i,pageSize:u},success:function(n){var t=JSON.parse(n);if(t.length>0){i==1&&(gh=Math.ceil(t[0].TotalRecords/u));for(item in t)yi.append("<li procatid = "+t[item].M_ProdCatID+"><span procatid = "+t[item].M_ProdCatID+">"+VIS.Utility.encodeText(t[item].Catname)+" ("+t[item].ProdCount+")<\/span><\/li>")}i>1&&(r[0].style.visibility="hidden")},error:function(){VIS.ADialog.error("VA005_ErrorLoadingProdCats");r[0].style.visibility="hidden"}})}function aa(){pt=ur.find(".vis-group-SearchText");ps=ur.find(".vis-group-search-icon");ws=ur.find(".vis-group-add-btn");ct=t('<div style="width:100%">');e=t('<div class="vis-group-users-container VA005-productouterwrp" style="margin:0;">');bf=t('<div class="vis-group-DataContainer">');e.height(t(f.parent()).height()-95);ct.append(e);e.append(bf);ts=t('<div style="height:100%">');ts.append(ct).append(t('<div class="VA005-attrValuesWraperDiv" >').append(v));li.append(ts);ca=ts.find(".VA005-attrValuesWraperDiv");ct.resizable({handles:"s,se"});ct.find(".ui-resizable-s").css("display","none");ct.find(".ui-resizable-se").css("display","none");f.find(".ui-resizable-s").css("height","10px")}function va(){var u,n;bs='<div id="VA005_divUom_'+i.windowNo+'" class="VA005-right-head-btn"><div class="VA005-Add-Btn" id="VA005_btnAddUom_'+i.windowNo+'"><span class="vis vis-plus" ><\/span><span style="margin-left:10px;">'+VIS.Msg.getMsg("VA005_AddUom")+'<\/span><\/div><div id="VA005_divConversion_'+i.windowNo+'" class="VA005-conv-form"><div class="VA005-conv-data input-group vis-input-wrap"><div class="vis-control-wrap"><select id="cmbUomTo_'+i.windowNo+'"><\/select><\/div><\/div><div class="VA005-conv-data"><div class="VA005-conversion-data input-group vis-input-wrap"><div class="vis-control-wrap VA005-Multiplier-data"><\/div><\/div><div class="VA005-conversion-data input-group vis-input-wrap"><div class="vis-control-wrap VA005-Division-data"><\/div><\/div><\/div><div class="VA005-conv-data"><div class="VA005-conversion-data input-group vis-input-wrap"><div class="vis-control-wrap"><input id="VA005_uomUPC_'+i.windowNo+'" placeholder=" " data-placeholder=""><label>'+VIS.Msg.getElement(VIS.Env.getCtx(),"UPC")+'<\/label><\/div><\/div><div class="VA005-conversion-icons"><span id="VA005_btnSaveUom_'+i.windowNo+'" class="VA005-icons vis vis-save VA005-icons-font" tabindex="0" title="'+VIS.Msg.getMsg("Save")+'"><\/span><span id="VA005_btnCancelUom_'+i.windowNo+'" class="VA005-icons fa fa-times-circle-o VA005-icons-font" tabindex="0" title="'+VIS.Msg.getMsg("Cancel")+'" style="font-size: 1.4rem;"><\/span><\/div><\/div>';pr=new VIS.Controls.VAmountTextBox("MulAmount",!1,!1,!0,50,100,VIS.DisplayType.Amount,VIS.Msg.getMsg("Amount"));wr=new VIS.Controls.VAmountTextBox("DivAmount",!1,!1,!0,50,100,VIS.DisplayType.Amount,VIS.Msg.getMsg("Amount"));wr.addVetoableChangeListener(this);pr.addVetoableChangeListener(this);o.append(bs);a=t('<div class="VA005-uom-list">');dc=o.find(".VA005-Multiplier-data");dc.append(pr.getControl().attr("placeholder"," ").attr("data-placeholder","")).append("<label>"+VIS.Msg.getElement(VIS.Env.getCtx(),"MultiplyRate")+"<\/label>");gc=o.find(".VA005-Division-data");gc.append(wr.getControl().attr("placeholder"," ").attr("data-placeholder","")).append("<label>"+VIS.Msg.getElement(VIS.Env.getCtx(),"DivideRate")+"<\/label>");o.append(a);cr=o.find("#VA005_divUom_"+i.windowNo);cr.hide();a.hide();ff=o.find("#VA005_btnAddUom_"+i.windowNo);gu=o.find("#VA005_divConversion_"+i.windowNo);gu.hide();bi=o.find("#cmbUomTo_"+i.windowNo);he=o.find("#VA005_uomUPC_"+i.windowNo);ee=o.find("#VA005_btnSaveUom_"+i.windowNo);ah=o.find("#VA005_btnCancelUom_"+i.windowNo);a.on("click",wy);o.append('<div id="VA005_divVarient_'+i.windowNo+'" class="VA005-right-head-btn"><div class="VA005-Add-Btn" id="VA005_btnAddVarient_'+i.windowNo+'"><span class="vis vis-plus" ><\/span><span style="margin-left:10px;">'+VIS.Msg.getMsg("VA005_AddVarient")+'<\/span><\/div><div class="VA005-Gen-Btn" id="VA005_btnGenerate_'+i.windowNo+'"><span class="glyphicon glyphicon-list-alt" ><\/span><span class="VA005-GenVariantLabl">'+VIS.Msg.getMsg("VA005_GenVariant")+'<\/span><\/div><div class="VA005-conv-form"><div class="VA005-conv-data" id="VA005_divAttr_'+i.windowNo+'"><\/div><\/div>');c=t('<div class="VA005-uom-list">');wt=t('<div class="VA005-tree-list">');dt=t('<div class="VA005-tree-data">');wt.append('<div style="float:right;margin-top: 5px;"><span id="VA005_SaveAttribute_'+i.windowNo+'" class="VA005-icons vis vis-save VA005-icons-font" title="'+VIS.Msg.getMsg("Save")+'"><\/span><span id="VA005_btnCancelGenerate_'+i.windowNo+'" class="VA005-icons vis vis-mark VA005-icons-font" title="'+VIS.Msg.getMsg("Cancel")+'"><\/span><\/div>').append(dt);o.append(c).append(wt);ir=o.find("#VA005_divVarient_"+i.windowNo);ir.hide();c.hide();wt.hide();ar=o.find("#VA005_divAttr_"+i.windowNo);ar.hide();ef=o.find("#VA005_btnAddVarient_"+i.windowNo);iu=o.find("#VA005_btnGenerate_"+i.windowNo);hh=o.find("#VA005_SaveAttribute_"+i.windowNo);ch=o.find("#VA005_btnCancelGenerate_"+i.windowNo);u=new VIS.MPAttributeLookup(VIS.context,i.windowNo);oo=new VIS.Controls.VPAttribute("M_AttributeSetInstance_ID",!1,!1,!0,VIS.DisplayType.PAttribute,u,i.windowNo,!1,!1,!1,!0);ar.css("display","flex");var r=t('<div class="input-group vis-input-wrap">'),f=t('<div class="vis-control-wrap">'),e=t('<div class="input-group-append">');ar.append(r);r.append(f);r.append(e);f.append(oo.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," "));e.append('<button class="input-group-text VA005_AttrBtn"><i class="vis vis-pattribute"><\/i><\/button>');ar.append('<span id="VA005_btnCancelVarient_'+i.windowNo+'" class="VA005-icons vis vis-mark VA005-icons-color" style="float:left;" title="'+VIS.Msg.getMsg("Cancel")+'"><\/span>');o.find(".VA005_AttrBtn").on(VIS.Events.onClick,py);lh=o.find("#VA005_btnCancelVarient_"+i.windowNo);c.on("click",by);o.append('<div id="VA005_divCart_'+i.windowNo+'" class="VA005-right-head"><div id="VA005_divCartList_'+i.windowNo+'" class="VA005-conv-data"><div class="VA005-conversion-data input-group vis-input-wrap"><div class="vis-control-wrap"><select id="VA005_cmbCart_'+i.windowNo+'"><\/select><label>'+VIS.Msg.getMsg("VA005_Cart")+'<\/label><\/div><\/div><div><span class="VA005-icons vis vis-plus VA005-icons-font" title="'+VIS.Msg.getMsg("VA005_AddNewCart")+'"><\/span><span class="VA005-icons vis vis-edit VA005-icons-font" title="'+VIS.Msg.getMsg("Edit")+'"><\/span><span class="VA005-icons vis vis-refresh VA005-icons-font" title="'+VIS.Msg.getMsg("VA005_Refresh")+'"><\/span><span class="VA005-icons vis vis-print VA005-icons-font" title="'+VIS.Msg.getMsg("Print")+'"><\/span><\/div><\/div><div id="VA005_divNewCart_'+i.windowNo+'" class="VA005-conv-data"><div class="VA005-conversion-data"><input id="VA005_scanName_'+i.windowNo+'"><\/div><div><span id="VA005_SaveScanName_'+i.windowNo+'" class="VA005-icons vis vis-save VA005-icons-font" tabindex="0" title="'+VIS.Msg.getMsg("Save")+'"><\/span><span id="VA005_btnCancelScan_'+i.windowNo+'" class="VA005-icons vis vis-mark VA005-icons-font" tabindex="0" title="'+VIS.Msg.getMsg("Cancel")+'"><\/span><span class="VA005-cart-update" style="display:none;"><\/span><\/div><\/div><\/div>');pi=t('<div class="VA005-uom-list">');pi.append(gs);o.append(pi);ii=o.find("#VA005_divCart_"+i.windowNo);lr=o.find("#VA005_divCartList_"+i.windowNo);tr=o.find("#VA005_divNewCart_"+i.windowNo);ii.hide();tr.hide();pi.hide();yh=ii.find(".vis-plus");ph=ii.find(".vis-edit");wh=ii.find(".vis-refresh");tl=ii.find(".vis-print");it=ii.find("#VA005_cmbCart_"+i.windowNo);ru=o.find("#VA005_scanName_"+i.windowNo);uo=o.find("#VA005_SaveScanName_"+i.windowNo);fo=o.find("#VA005_btnCancelScan_"+i.windowNo);o.find(".VA005-cart-update").text(VIS.Msg.getMsg("Updated"));nr=t('<div class="VA005-uom-list">');nu=t('<div class="VA005-right-head" ><div class="VA005-form-top-fields VA005-prodmgtrightfieldtop"><div id="VA005_ProdDetZoomName_'+i.windowNo+'" style= "display:none"><h4 id="VA005_prodName_'+i.windowNo+'" style="flex: 1"><\/h4><span id="VA005_ZoomProduct" title='+VIS.Msg.getMsg("VA005_ZoomToProduct")+' class="VA005-icons VA005-icons-font vis vis-edit" style="margin-top:5px"><\/span><\/div><div style="float:left; width:100%" class="VA005-data-wrap" id="VA005_UPC_'+i.windowNo+'"><p>'+VIS.Msg.getElement(VIS.Env.getCtx(),"UPC")+'<\/p><\/div><div style="float:left;" class="VA005-data-wrap" id="VA005_AttributeSet_'+i.windowNo+'"><p>'+VIS.Msg.getElement(VIS.Env.getCtx(),"M_AttributeSet_ID")+'<\/p><\/div><\/div><!-- end of form-top-fields --><div class="VA005-image-wrap VA005-prodmgtimgwrap"><\/div><\/div>');o.append(nr);nr.append(nu);er=nu.find(".VA005-image-wrap");wo=t('<img style="max-height: 100%; max-width: 100%;" src='+VIS.Application.contextUrl+"Areas/VA005/Images/img-defult.png>");er.append(t('<i style="max-height: 100%; max-width: 100%;" class="vis vis-image" ><\/i>'));tu=t('<div class="VA005-form-fullFields"><div id="VA005_ProductType_'+i.windowNo+'" class="VA005-data-wrap"><p>'+VIS.Msg.getElement(VIS.Env.getCtx(),"ProductType")+'<\/p><\/div><div id="VA005_ProdCategory_'+i.windowNo+'" class="VA005-data-wrap"><p>'+VIS.Msg.getElement(VIS.Env.getCtx(),"M_Product_Category_ID")+'<\/p><\/div><div id="VA005_prodTaxCat_'+i.windowNo+'" class="VA005-data-wrap"><p>'+VIS.Msg.getElement(VIS.Env.getCtx(),"C_TaxCategory_ID")+'<\/p><\/div><div id="VA005_prodUOM_'+i.windowNo+'" class="VA005-data-wrap"><p>'+VIS.Msg.getElement(VIS.Env.getCtx(),"C_UOM_ID")+'<\/p><\/div><div id="VA005_ProdParent_'+i.windowNo+'" class="VA005-data-wrap"><p>'+VIS.Msg.getElement(VIS.Env.getCtx(),"IsSummary")+"<\/p><\/div><\/div><!-- end of form-fullFields -->");nr.append(tu);de=t("#VA005_ProdDetZoomName_"+i.windowNo);ge=nu.find("#VA005_prodName_"+i.windowNo);kf=nu.find("#VA005_UPC_"+i.windowNo);df=nu.find("#VA005_AttributeSet_"+i.windowNo);te=tu.find("#VA005_ProductType_"+i.windowNo);gf=tu.find("#VA005_ProdCategory_"+i.windowNo);ne=tu.find("#VA005_prodTaxCat_"+i.windowNo);ie=tu.find("#VA005_prodUOM_"+i.windowNo);no=tu.find("#VA005_ProdParent_"+i.windowNo);vc=nu.find(".vis-edit");ai=t('<div class="VA005-uom-list">');o.append(ai);ai.hide();o.append("<div class='VA005-popup'><input type='text' maxlength=40 id='VA005_upcTxt_"+i.windowNo+"'><\/input><span id='VA005_upcOK_"+i.windowNo+"' class='vis vis-markx' title='"+VIS.Msg.getMsg("Save")+"'><\/span><span id='VA005_btnCancelUpc_"+i.windowNo+"' class='vis vis-cross' title='"+VIS.Msg.getMsg("Cancel")+"'><\/span><\/div>");oe=o.find(".VA005-popup");yr=o.find("#VA005_upcTxt_"+i.windowNo);o.find("#VA005_upcOK_"+i.windowNo).on("click",function(){if(yr.val()!="")yl();else return});n=[];n.push(8);n.push(9);n.push(46);n.push(36);n.push(35);n.push(37);n.push(39);n.push(13);yr.on("keydown",function(t){if(t.keyCode>=48&&t.keyCode<=57||t.keyCode>=65&&t.keyCode<=90||t.keyCode>=97&&t.keyCode<=105||n.indexOf(t.keyCode)!=-1&&t.charCode!=t.keyCode){if(t.keyCode==13)if(yr.val()!="")yl();else return!1}else return!1});o.find("#VA005_btnCancelUpc_"+i.windowNo).on("click",function(){oe.popup("hide");yr.val("");of=0})}function ya(){nt.append(ks);ks.append('<div class="VA005-product-data"><div class="input-group vis-input-wrap"><div class="vis-control-wrap"><input id="txtValue_'+i.windowNo+'" type="text" placeholder=" " data-placeholder=""><label>'+VIS.Msg.getElement(VIS.Env.getCtx(),"Value")+'<\/label><\/div><\/div><\/div><div class="VA005-product-data"><div class="input-group vis-input-wrap"><div class="vis-control-wrap"><select id="VA005_cmbOrg_'+i.windowNo+'"><\/select><label>'+VIS.Msg.getElement(VIS.Env.getCtx(),"AD_Org_ID")+'<\/label><\/div><\/div><\/div><div class="VA005-product-data"><div class="input-group vis-input-wrap"><div class="vis-control-wrap"><input class="vis-ev-col-mandatory" id="txtName_'+i.windowNo+'" type="text" placeholder=" " data-placeholder="" ><label>'+VIS.Msg.getElement(VIS.Env.getCtx(),"Name")+'<\/label><\/div><\/div><\/div><div class="VA005-product-data"><div class="input-group vis-input-wrap"><div class="vis-control-wrap"><select class="vis-ev-col-mandatory" id="cmbCat_'+i.windowNo+'" placeholder=" " data-placeholder="" data-hasbtn=" "><\/select><label>'+VIS.Msg.getElement(VIS.Env.getCtx(),"M_Product_Category_ID")+'<\/label><\/div><div class="input-group-append"><button  id="btnProdCat_'+i.windowNo+'" class="input-group-text VA005-leftpanelcatsearchbtn"><i class="fa fa-ellipsis-v"><\/i><\/button><\/div><\/div><\/div><div class="VA005-product-data"><div class="input-group vis-input-wrap"><div class="vis-control-wrap"><select id="cmbType_'+i.windowNo+'" placeholder=" " data-placeholder="" data-hasbtn=" " ><\/select><label>'+VIS.Msg.getElement(VIS.Env.getCtx(),"ProductType")+'<\/label><\/div><\/div><\/div><div class="VA005-product-data"><div class="input-group vis-input-wrap"><div class="vis-control-wrap"><select class="vis-ev-col-mandatory" id="cmbTax_'+i.windowNo+'" placeholder=" " data-placeholder="" data-hasbtn=" "><\/select><label>'+VIS.Msg.getElement(VIS.Env.getCtx(),"C_TaxCategory_ID")+'<\/label><\/div><div class="input-group-append"><button id="btnTaxCategory_'+i.windowNo+'" class="input-group-text VA005-leftpanelcatsearchbtn"><i class="fa fa-ellipsis-v"><\/i><\/button><\/div><\/div><\/div><div class="VA005-product-data"><div class="input-group vis-input-wrap"><div class="vis-control-wrap"><select id="cmbAttribute_'+i.windowNo+'" placeholder=" " data-placeholder="" data-hasbtn=" "><\/select><label>'+VIS.Msg.getElement(VIS.Env.getCtx(),"M_AttributeSet_ID")+'<\/label><\/div><div class="input-group-append"><button id="btnAttributeSet_'+i.windowNo+'" class="input-group-text VA005-leftpanelcatsearchbtn"><i class="fa fa-ellipsis-v"><\/i><\/button><\/div><\/div><\/div><div class="VA005-product-data"><div class="input-group vis-input-wrap"><div class="vis-control-wrap"><select class="vis-ev-col-mandatory" id="cmbUom_'+i.windowNo+'" placeholder=" " data-placeholder="" data-hasbtn=" " ><\/select><label>'+VIS.Msg.getElement(VIS.Env.getCtx(),"C_UOM_ID")+'<\/label><\/div><div class="input-group-append"><button id="btnUom_'+i.windowNo+'" class="input-group-text VA005-leftpanelcatsearchbtn"><i class="fa fa-ellipsis-v"><\/i><\/button><\/div><\/div><\/div><div class="VA005-product-data"><div class="input-group vis-input-wrap"><div class="vis-control-wrap"><input id="txtUpc_'+i.windowNo+'" type="text" placeholder=" " data-placeholder=""><label>'+VIS.Msg.getElement(VIS.Env.getCtx(),"UPC")+"<\/label><\/div><\/div><\/div>");uu=nt.find("#VA005_cmbOrg_"+i.windowNo);hf=nt.find("#txtValue_"+i.windowNo);sf=nt.find("#txtName_"+i.windowNo);gt=nt.find("#cmbCat_"+i.windowNo);fi=nt.find("#cmbTax_"+i.windowNo);br=nt.find("#cmbType_"+i.windowNo);fr=nt.find("#cmbUom_"+i.windowNo);wi=nt.find("#cmbAttribute_"+i.windowNo);se=nt.find("#txtUpc_"+i.windowNo);lo=nt.find("#btnAttributeSet_"+i.windowNo);ao=nt.find("#btnProdCat_"+i.windowNo);vo=nt.find("#btnTaxCategory_"+i.windowNo);yo=nt.find("#btnUom_"+i.windowNo);rc();uc();is();rs();us();fs(fr);gt.on("change",function(){cl(gt.val())})}function pa(){ds.append(cu);cu.append('<div style=" float: left; width: 100%; "><div class="VA005-form-data VA005-popup-head"><div class="input-group vis-input-wrap"><div class="vis-control-wrap"><select id="cmbPricelist_'+i.windowNo+'"><\/select><label id="lblPriceList_"'+i.windowNo+'">'+VIS.Msg.getMsg("PriceListVersion")+'<\/label><\/div><\/div><\/div><div style = "float:right; margin-top:10px"><label id="CurrInfo_'+i.windowNo+'" style="float:right;"><\/label><\/div><\/div><div id="VA005_priceGrid_'+i.windowNo+'" class="VA005-popup-data">');ei=cu.find("#cmbPricelist_"+i.windowNo);th=cu.find("#VA005_priceGrid_"+i.windowNo);kc=cu.find("#CurrInfo_"+i.windowNo);h=null;h=th.w2grid({name:"gridprice_"+i.windowNo,recordHeight:25,columns:[{field:"product_ID",caption:"",sortable:!1,size:"80px",display:!1},{field:"ImageUrl",caption:'<div class="imgPrice" style="text-align: center;" ><span>'+VIS.Msg.translate(VIS.Env.getCtx(),"AD_Image_ID")+"<\/span><\/div>",sortable:!1,size:"80px",hidden:!1,render:function(){return'<div style="text-align: center;"><\/div>'}},{field:"Product",caption:"<div ><span>"+VIS.Msg.translate(VIS.Env.getCtx(),"Product")+"<\/span><\/div>",sortable:!1,size:"200px",hidden:!1},{field:"PriceList",caption:"<div ><span>"+VIS.Msg.getElement(VIS.Env.getCtx(),"PriceList")+"<\/span><\/div>",sortable:!1,size:"100px",min:80,hidden:!1,style:"text-align: right",editable:{type:"number"},render:function(n){var t=n.PriceList;return t=su(event,t),parseFloat(t).toLocaleString()}},{field:"PriceStd",caption:"<div ><span>"+VIS.Msg.getElement(VIS.Env.getCtx(),"PriceStd")+"<\/span><\/div>",sortable:!1,size:"100px",min:80,hidden:!1,style:"text-align: right",editable:{type:"number"},render:function(n){var t=n.PriceStd;return t=su(event,t),parseFloat(t).toLocaleString()}},{field:"PriceLimit",caption:"<div ><span>"+VIS.Msg.getElement(VIS.Env.getCtx(),"PriceLimit")+"<\/span><\/div>",sortable:!1,size:"100px",min:80,hidden:!1,style:"text-align: right",editable:{type:"number"},render:function(n){var t=n.PriceLimit;return t=su(event,t),parseFloat(t).toLocaleString()}},{field:"UOM",caption:"",sortable:!1,size:"80px",display:!1},{field:"C_Uom_ID",caption:"<div ><span>"+VIS.Msg.getElement(VIS.Env.getCtx(),"C_UOM_ID")+"<\/span><\/div>",sortable:!1,size:"80px",min:80,hidden:!1,editable:{type:"select",items:yt,showAll:!0},render:function(n,t,i){var r="";for(var u in yt)yt[u].id==this.getCellValue(t,i)&&(r=yt[u].text);return r}},{field:"Lot",caption:"<div ><span>"+VIS.Msg.getElement(VIS.Env.getCtx(),"Lot")+"<\/span><\/div>",sortable:!1,size:"80px",min:80,hidden:!1,editable:{type:"text"}},{field:"attribute_ID",caption:"",sortable:!1,size:"80px",display:!1},{field:"Attribute",caption:"<div ><span>"+VIS.Msg.translate(VIS.Env.getCtx(),"Attribute")+"<\/span><\/div>",sortable:!1,size:"150px",hidden:!1,render:function(){return'<div><input type=text readonly="readonly" style= "width:85%; border:none" ><i class="fa fa-list-alt VA005-gridicon" title="Attribute Set Instance" style="opacity: 1;"><\/i><\/div>'}},{field:"updated",caption:"",sortable:!1,size:"80px",display:!1}],onEditField:function(n){if(id=n.recid,n.column==3||n.column==4||n.column==5){h.records[n.index][h.columns[n.column].field]=su(n,h.records[n.index][h.columns[n.column].field]);var r=di.GetFormatAmount(h.records[n.index][h.columns[n.column].field],"init",kt);h.records[n.index][h.columns[n.column].field]=di.GetConvertedString(r,kt);t("#grid_gridprice_"+i.windowNo+"_rec_"+id).keydown(function(n){if(kt||n.keyCode!=190&&n.keyCode!=110){if(kt&&n.keyCode==188)return!1}else return!1;return n.target.value.contains(".")&&(n.which==110||n.which==190||n.which==188)?n.target.value.indexOf(".")>-1&&(n.target.value=n.target.value.replace(".","")):n.target.value.contains(",")&&(n.which==110||n.which==190||n.which==188)&&n.target.value.indexOf(",")>-1&&(n.target.value=n.target.value.replace(",","")),n.keyCode!=8&&n.keyCode!=9&&(n.keyCode<37||n.keyCode>40)&&(n.keyCode<48||n.keyCode>57)&&(n.keyCode<96||n.keyCode>105)&&n.keyCode!=109&&n.keyCode!=189&&n.keyCode!=110&&n.keyCode!=144&&n.keyCode!=188&&n.keyCode!=190?!1:void 0})}},onChange:function(n){var t;h.records[n.index].updated=!0;n.column==3?(t=di.GetConvertedNumber(n.value_new,kt),h.records[n.index].PriceList=t.toFixed(or)):n.column==4?(t=di.GetConvertedNumber(n.value_new,kt),h.records[n.index].PriceStd=t.toFixed(or)):n.column==5?(t=di.GetConvertedNumber(n.value_new,kt),h.records[n.index].PriceLimit=t.toFixed(or)):n.column==7?h.records[n.index].C_Uom_ID=n.value_new:n.column==8&&(h.records[n.index].Lot=n.value_new)},onClick:function(n){var r,u,e,o;if(n.column==1&&h.records.length>0)r=VIS.dataContext.getJSONRecord("VA005/ProductManagement/GetImageUrl",h.records[n.recid-1].product_ID.toString()),u="",r!=null?r!=""?(r=r.substring(r.lastIndexOf("/")+1,r.length),e=new Date,u='<img style="max-height: 100%; max-width: 100%;" src="'+VIS.Application.contextUrl+"Images/Thumb140x120/"+r+"?"+e.getTime()+'">'):u='<i class= "vis vis-image" ><\/i>':u='<i class= "vis vis-image" ><\/i>',$ImageZoom.empty(),$ImageZoom.append(u),$ImageZoom.fadeIn("slow"),$ImageZoom.popup({tooltipanchor:ds,autoopen:!0,type:"tooltip",background:!0,backgroundactive:!1,horizontal:"center"});else if(n.column==10&&h.records.length>0)if(o=VIS.dataContext.getJSONRecord("VA005/ProductManagement/GetAttributeSet",VIS.Utility.Util.getValueOfInt(h.records[n.recid-1].product_ID)),o!=0){var s=cf==8418,c=VIS.context.getContextAsInt(i.windowNo,"M_Locator_ID"),l=VIS.context.getContextAsInt(i.windowNo,"C_BPartner_ID"),f=new VIS.PAttributesForm(VIS.Utility.Util.getValueOfInt(h.records[n.recid-1].attribute_ID),VIS.Utility.Util.getValueOfInt(h.records[n.recid-1].product_ID),c,l,s,cf,i.windowNo);f.hasAttribute&&f.showDialog();f.onClose=function(r,u){h.records[n.recid-1].attribute_ID!=r&&(h.records[n.recid-1].attribute_ID=r,h.records[n.recid-1].Attribute=u,t("#grid_gridprice_"+i.windowNo+"_rec_"+n.recid).find("input[type=text]").val(u),h.records[n.recid-1].updated=!0)}}else return}});h.hideColumn("UOM");h.hideColumn("attribute_ID");h.hideColumn("product_ID");h.hideColumn("updated")}function su(n,t){var u=!1,r,i;if(n.value_new=VIS.Utility.Util.getValueOfString(t),n.value_new.contains(".")){for(u=!0,r=[],i=0;i<n.value_new.length;i++)n.value_new[i]==="."&&r.push(i);r.length>1&&(n.value_new=ic(n.value_new,"."))}if(n.value_new.contains(","))if(u)n.value_new=ic(n.value_new,",");else{for(r=[],i=0;i<n.value_new.length;i++)n.value_new[i]===","&&r.push(i);n.value_new=r.length>1?ic(n.value_new,","):n.value_new.replace(",",".")}return n.value_new==""&&(n.value_new="0"),n.value_new}function ic(n,t){var i=n.split(t);return n=i.slice(0,-1).join("")+"."+i.slice(-1),n.indexOf(".")==n.length-1&&(n=n.replace(".","")),n}function wa(){yc.append(nf);nf.append('<div class="VA005-form-data VA005-popup-head"><div class="input-group vis-input-wrap"><div class="vis-control-wrap"><select id="cmbSupplier_'+i.windowNo+'"><\/select><label id="lblPriceList_"'+i.windowNo+'">'+VIS.Msg.getMsg("VA005_Supplier")+'<\/label><\/div><\/div><\/div><div id="VA005_supplierGrid_'+i.windowNo+'" class="VA005-popup-data">');ki=nf.find("#cmbSupplier_"+i.windowNo);ih=nf.find("#VA005_supplierGrid_"+i.windowNo);p=null;p=ih.w2grid({name:"gridsupplier_"+i.windowNo,recordHeight:25,show:{},columns:[{field:"product_ID",caption:"",sortable:!1,size:"80px",display:!1},{field:"Product",caption:"<div ><span>"+VIS.Msg.translate(VIS.Env.getCtx(),"Product")+"<\/span><\/div>",sortable:!1,size:"200px",hidden:!1},{field:"OrderMin",caption:"<div ><span>"+VIS.Msg.getElement(VIS.Env.getCtx(),"Order_Min")+"<\/span><\/div>",sortable:!1,size:"120px",min:80,hidden:!1,style:"text-align: right",editable:{type:"number"},render:function(n){var t=n.OrderMin;return t=su(event,t),parseFloat(t).toLocaleString()}},{field:"OrderPack",caption:"<div ><span>"+VIS.Msg.getElement(VIS.Env.getCtx(),"Order_Pack")+"<\/span><\/div>",sortable:!1,size:"100px",min:80,hidden:!1,style:"text-align: right",editable:{type:"number"},render:function(n){var t=n.OrderPack;return t=su(event,t),parseFloat(t).toLocaleString()}},{field:"C_Uom_ID",caption:"<div ><span>"+VIS.Msg.getElement(VIS.Env.getCtx(),"C_UOM_ID")+"<\/span><\/div>",sortable:!1,size:"80px",min:80,hidden:!1,editable:{type:"select",items:yt,showAll:!0},render:function(n,t,i){var r="";for(var u in yt)yt[u].id==this.getCellValue(t,i)&&(r=yt[u].text);return r}},{field:"C_Currency_ID",caption:"<div ><span>"+VIS.Msg.getElement(VIS.Env.getCtx(),"C_Currency_ID")+"<\/span><\/div>",sortable:!1,size:"80px",min:80,hidden:!1,editable:{type:"select",items:fu,showAll:!0},render:function(n,t,i){var r="";for(var u in fu)fu[u].id==this.getCellValue(t,i)&&(r=fu[u].text);return r}},{field:"PriceList",caption:"<div ><span>"+VIS.Msg.getElement(VIS.Env.getCtx(),"PriceList")+"<\/span><\/div>",sortable:!1,size:"80px",min:80,hidden:!1,style:"text-align: right",editable:{type:"number"},render:function(n){var t=n.PriceList;return t=su(event,t),parseFloat(t).toLocaleString()}},{field:"DeliveryTime",caption:"<div ><span>"+VIS.Msg.getElement(VIS.Env.getCtx(),"DeliveryTime_Promised")+"<\/span><\/div>",sortable:!1,size:"100px",min:80,hidden:!1,editable:{type:"int"}},{field:"updated",caption:"",sortable:!1,size:"80px",display:!1}],onEditField:function(n){if(id=n.recid,n.column==2||n.column==3||n.column==6){p.records[n.index][p.columns[n.column].field]=su(n,p.records[n.index][p.columns[n.column].field]);var r=di.GetFormatAmount(p.records[n.index][p.columns[n.column].field],"init",kt);p.records[n.index][p.columns[n.column].field]=di.GetConvertedString(r,kt);t("#grid_gridsupplier_"+i.windowNo+"_rec_"+id).keydown(function(n){if(kt||n.keyCode!=190&&n.keyCode!=110){if(kt&&n.keyCode==188)return!1}else return!1;return n.target.value.contains(".")&&(n.which==110||n.which==190||n.which==188)&&n.target.value.indexOf(".")>-1&&(n.target.value=n.target.value.replace(".","")),n.target.value.contains(",")&&(n.which==110||n.which==190||n.which==188)&&n.target.value.indexOf(",")>-1&&(n.target.value=n.target.value.replace("","")),n.keyCode!=8&&n.keyCode!=9&&(n.keyCode<37||n.keyCode>40)&&(n.keyCode<48||n.keyCode>57)&&(n.keyCode<96||n.keyCode>105)&&n.keyCode!=109&&n.keyCode!=189&&n.keyCode!=110&&n.keyCode!=144&&n.keyCode!=188&&n.keyCode!=190?!1:void 0})}},onChange:function(n){var t;p.records[n.index].updated=!0;n.column==2?(t=di.GetConvertedNumber(n.value_new,kt),p.records[n.index].OrderMin=t.toFixed(or)):n.column==3?(t=di.GetConvertedNumber(n.value_new,kt),p.records[n.index].OrderPack=t.toFixed(or)):n.column==4?p.records[n.index].C_Uom_ID=n.value_new:n.column==5?p.records[n.index].C_Currency_ID=n.value_new:n.column==6?(t=di.GetConvertedNumber(n.value_new,kt),p.records[n.index].PriceList=t.toFixed(or)):n.column==7&&(p.records[n.index].DeliveryTime=n.value_new)},onClick:function(){}});p.hideColumn("product_ID");p.hideColumn("updated");p.hideColumn("DeliveryTime")}function ba(){re.append(pc);pc.append('<div class="VA005-form-data input-group vis-input-wrap" style="margin-top: 5px;"><div class="vis-control-wrap"><input class="vis-ev-col-mandatory" id="txtHeader_'+i.windowNo+'" type="text" maxlength="40"><label>'+VIS.Msg.getMsg("VA005_StickerHeader")+'<\/label><\/div><\/div><div class="VA005-form-data input-group vis-input-wrap"><div class="vis-control-wrap"><select class="vis-ev-col-mandatory" id="cmbVarsion_'+i.windowNo+'"><\/select><label>'+VIS.Msg.getElement(VIS.Env.getCtx(),"M_PriceList_Version_ID")+"<\/label><\/div><\/div>");so=re.find("#txtHeader_"+i.windowNo);vu=re.find("#cmbVarsion_"+i.windowNo)}function ka(){ai.append(wc);st=null;st=wc.w2grid({name:"VA005_gridRelated_"+i.windowNo,recordHeight:25,show:{toolbar:!0,selectColumn:!0,toolbarReload:!1,toolbarColumns:!0,toolbarSearch:!1,toolbarAdd:!1,toolbarDelete:!0,toolbarSave:!0},columns:[{field:"Product",caption:VIS.Msg.getElement(VIS.Env.getCtx(),"Name"),sortable:!1,size:"36%",editable:{type:"text"}},{field:"RelatedProduct",caption:VIS.Msg.getElement(VIS.Env.getCtx(),"RelatedProduct_ID"),sortable:!1,size:"36%"},{field:"RelatedType",caption:"<div ><span>"+VIS.Msg.getElement(VIS.Env.getCtx(),"RelatedProductType")+"<\/span><\/div>",sortable:!1,size:"32%",hidden:!1,editable:{type:"select",items:pu,showAll:!0},render:function(n,t,i){var r="";for(var u in pu)pu[u].id==this.getCellValue(t,i)&&(r=pu[u].text);return r}},{field:"M_Product_ID",caption:"M_Product_ID",sortable:!1,size:"80px",display:!1},{field:"updated",caption:VIS.Msg.getElement(VIS.Env.getCtx(),"Updated"),sortable:!1,size:"80px",display:!1}],records:[],onChange:function(n){st.records[n.index].updated=!0;n.column==0?st.records[n.index].Product=n.value_new:n.column==2&&(st.records[n.index].RelatedType=n.value_new)},onClick:function(){},onDelete:function(n){n.preventDefault();ey()},onSubmit:function(n){n.preventDefault();fy()}});st.hideColumn("M_Product_ID");st.hideColumn("updated")}function da(){gs.append(nh);s=null;s=nh.w2grid({name:"gridcart_"+i.windowNo,recordHeight:25,show:{toolbar:!0,selectColumn:!0,toolbarReload:!1,toolbarColumns:!0,toolbarSearch:!1,toolbarAdd:!1,toolbarDelete:!0,toolbarSave:!0},records:[],columns:[{field:"product_ID",caption:"product_ID",sortable:!1,size:"80px",display:!1},{field:"Product",caption:"<div ><span>"+VIS.Msg.translate(VIS.Env.getCtx(),"Product")+"<\/span><\/div>",sortable:!1,size:"35%",hidden:!1},{field:"Qty",caption:"<div ><span>"+VIS.Msg.getElement(VIS.Env.getCtx(),"Quantity")+"<\/span><\/div>",sortable:!1,size:"15%",hidden:!1,style:"text-align: right",editable:{type:"float"},render:function(n){var t=VIS.Utility.Util.getValueOfDecimal(n.Qty.toFixed(or));return t.toLocaleString()}},{field:"C_Uom_ID",caption:"<div ><span>"+VIS.Msg.getElement(VIS.Env.getCtx(),"C_UOM_ID")+"<\/span><\/div>",sortable:!1,size:"15%",hidden:!1,editable:{type:"select",items:yt,showAll:!0},render:function(n,t,i){var r="";for(var u in yt)yt[u].id==this.getCellValue(t,i)&&(r=yt[u].text);return r}},{field:"attribute_ID",caption:VIS.Msg.getElement(VIS.Env.getCtx(),"M_AttributeSetInstance_ID"),sortable:!1,size:"80px",display:!1},{field:"Attribute",caption:"<div ><span>"+VIS.Msg.translate(VIS.Env.getCtx(),"Attribute")+"<\/span><\/div>",sortable:!1,size:"35%",hidden:!1,render:function(){return'<div><input type=text readonly="readonly" style= "width:85%; border:none" ><i class="fa fa-list-alt VA005-gridicon" title="Attribute Set Instance" style="opacity: 1;"><\/i><\/div>'}},{field:"UPC",caption:VIS.Msg.getElement(VIS.Env.getCtx(),"UPC"),sortable:!1,size:"80px",editable:{type:"text"}},{field:"LineID",caption:VIS.Msg.getElement(VIS.Env.getCtx(),"VAICNT_InventoryCountLine_ID"),sortable:!1,size:"80px",display:!1},{field:"updated",caption:VIS.Msg.getElement(VIS.Env.getCtx(),"Updated"),sortable:!1,size:"80px",display:!1}],onChange:function(n){s.records[n.index].updated=!0;n.column==2?s.records[n.index].Qty=n.value_new:n.column==3&&(s.records[n.index].C_Uom_ID=n.value_new)},onClick:function(n){var u;if(n.column==5&&s.records.length>0)if(u=VIS.dataContext.getJSONRecord("VA005/ProductManagement/GetAttributeSet",VIS.Utility.Util.getValueOfInt(s.records[n.recid-1].product_ID)),u!=0){var f=cf==8418,e=VIS.context.getContextAsInt(i.windowNo,"M_Locator_ID"),o=VIS.context.getContextAsInt(i.windowNo,"C_BPartner_ID"),r=new VIS.PAttributesForm(VIS.Utility.Util.getValueOfInt(s.records[n.recid-1].attribute_ID),VIS.Utility.Util.getValueOfInt(s.records[n.recid-1].product_ID),e,o,f,cf,i.windowNo);r.hasAttribute&&r.showDialog();r.onClose=function(r,u){s.records[n.recid-1].attribute_ID!=r&&(s.records[n.recid-1].attribute_ID=r,s.records[n.recid-1].Attribute=u,t("#grid_gridcart_"+i.windowNo+"_rec_"+n.recid).find("input[type=text]").val(u),s.records[n.recid-1].updated=!0)}}else return},onDelete:function(n){n.preventDefault();uy()},onSubmit:function(n){n.preventDefault();ry()},onColumnOnOff:function(n){n.onComplete=function(){du()}},onSelect:function(n){n.all&&(n.onComplete=function(){for(var r,n=0;n<s.records.length;n++)t("#grid_gridcart_"+i.windowNo+"_rec_"+s.records[n].recid).find("input[type=text]").val(s.records[n].Attribute),r=VIS.dataContext.getJSONRecord("VA005/ProductManagement/GetAttributeSet",s.records[n].product_ID),r<=0&&(t("#grid_gridcart_"+i.windowNo+"_rec_"+s.records[n].recid).find("input:not([type='checkbox'])").hide(),t("#grid_gridcart_"+i.windowNo+"_rec_"+s.records[n].recid).find("img").hide())})}});s.hideColumn("product_ID");s.hideColumn("attribute_ID");s.hideColumn("UPC");s.hideColumn("LineID");s.hideColumn("updated");es()}function ga(n){var i,r,t;if(n.length>0)for(t in n)i=VIS.Utility.Util.getValueOfInt(n[t].AD_Org_ID),r=VIS.Utility.Util.getValueOfString(n[t].Name),uu.append(" <option value="+i+">"+VIS.Utility.encodeText(r)+"<\/option>");uu.val(ho)}function nv(n){var i,r,t;if(n.length>0)for(t in n)i=VIS.Utility.Util.getValueOfString(n[t].Value),r=VIS.Utility.Util.getValueOfString(n[t].Name),br.append(" <option value="+i+">"+VIS.Utility.encodeText(r)+"<\/option>")}function tv(n){var i,r,t;if(wi.append(" <option value = 0><\/option>"),n.length>0)for(t in n)i=VIS.Utility.Util.getValueOfInt(n[t].M_AttributeSet_ID),r=VIS.Utility.Util.getValueOfString(n[t].Name),wi.append(" <option value="+i+">"+VIS.Utility.encodeText(r)+"<\/option>")}function iv(n){var i,r,t;if(fi.append(" <option value = 0><\/option>"),n.length>0)for(t in n)i=VIS.Utility.Util.getValueOfInt(n[t].C_TaxCategory_ID),r=VIS.Utility.Util.getValueOfString(n[t].Name),fi.append(" <option value="+i+">"+VIS.Utility.encodeText(r)+"<\/option>")}function rv(n){var i,r,t;if(gt.append(" <option value = 0><\/option>"),n.length>0)for(t in n)i=VIS.Utility.Util.getValueOfInt(n[t].M_Product_Category_ID),r=VIS.Utility.Util.getValueOfString(n[t].Name),gt.append(" <option value="+i+">"+VIS.Utility.encodeText(r)+"<\/option>")}function uv(n){var i,r,t;if(po.append(" <option value = 0><\/option>"),n.length>0)for(t in n)i=VIS.Utility.Util.getValueOfInt(n[t].C_UOM_ID),r=VIS.Utility.Util.getValueOfString(n[t].Name),po.append(" <option value="+i+">"+VIS.Utility.encodeText(r)+"<\/option>")}function fv(n){var i,r,t;if(n.length>0)for(t in n)i=VIS.Utility.Util.getValueOfInt(n[t].C_UOM_ID),r=VIS.Utility.Util.getValueOfString(n[t].Name),yt.push({id:i,text:r});da();pa();wa();ba();yv()}function ev(n){var i,r,t;if(n.length>0)for(t in n)i=VIS.Utility.Util.getValueOfInt(n[t].C_Currency_ID),r=VIS.Utility.Util.getValueOfString(n[t].ISO_Code),fu.push({id:i,text:r});el()}function ov(n){var i,r,t;if(bi.append(" <option value = -1>"+VIS.Msg.getMsg("VA005_UomTo")+"<\/option>"),n.length>0)for(t in n)i=VIS.Utility.Util.getValueOfInt(n[t].C_UOM_ID),r=VIS.Utility.Util.getValueOfString(n[t].Name),bi.append(" <option value="+i+">"+VIS.Utility.encodeText(r)+"<\/option>")}function sv(n){var i,r,t;if(ei.append(" <option value = 0><\/option>"),n.length>0)for(t in n)i=VIS.Utility.Util.getValueOfInt(n[t].M_PriceList_Version_ID),r=VIS.Utility.Util.getValueOfString(n[t].Name),ei.append(" <option value="+i+">"+VIS.Utility.encodeText(r)+"<\/option>");ei.prop("selectedIndex",1);bl()}function hv(n){var i,r,t;if(ki.append(" <option value = 0>"+VIS.Msg.getMsg("VA005_SelSupplier")+"<\/option>"),n.length>0)for(t in n)i=VIS.Utility.Util.getValueOfInt(n[t].C_BPartner_ID),r=VIS.Utility.Util.getValueOfString(n[t].Name),ki.append(" <option value="+i+">"+VIS.Utility.encodeText(r)+"<\/option>");ki.prop("selectedIndex",0);kl()}function cv(n){var r,u,t;if(it.append(" <option value = 0><\/option>"),n.length>0)for(t in n)r=n[t].VAICNT_InventoryCount_ID,u=n[t].Name,it.append(" <option value="+r+">"+VIS.Utility.encodeText(u)+"<\/option>");it.val(co);co>0?ur.find("#VA005_cartInfo_"+i.windowNo).text(it.find("option:selected").text()):ur.find("#VA005_cartInfo_"+i.windowNo).text(VIS.Msg.getMsg("None"))}function lv(n){var i,r,t;if(ft.append(" <option value = 0><\/option>"),n!=null)for(t in n)i=n[t].AD_UserQuery_ID,r=n[t].Name,ft.append(" <option value="+i+">"+VIS.Utility.encodeText(r)+"<\/option>")}function vv(n){n!=null&&(nc=n._countDTD001,nc&&br.val(n.ProductType),n.C_TaxCategory_ID>0?fi.val(n.C_TaxCategory_ID).prop("selected",!0):fi.val(-1),n.M_AttributeSet_ID>0?wi.val(n.M_AttributeSet_ID).prop("selected",!0):wi.val(-1))}function yv(){pu=[];VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductManagement/LoadRelatedType","",pv)}function pv(n){var i,r,t;if(pu.push({id:"-1",text:""}),n!=null)for(t in n)i=n[t].Value,r=n[t].Name,pu.push({id:i,text:VIS.Utility.encodeText(r)});ka()}function wv(){vu.empty();VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductManagement/LoadPriceList","",bv)}function bv(n){var i,r,t;if(vu.append(" <option value = 0><\/option>"),n.length>0)for(t in n)i=VIS.Utility.Util.getValueOfInt(n[t].M_PriceList_Version_ID),r=VIS.Utility.Util.getValueOfString(n[t].Name),vu.append(" <option value="+i+">"+VIS.Utility.encodeText(r)+"<\/option>")}function kv(){r=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"><\/i><\/div><\/div>');r[0].style.visibility="visible";f.append(r)}function dv(){e.find(".vis-group-user-wrap").remove();ci("",0,0,d,tt,0);e.on("click",yy)}function ci(n,i,f,o,s,h){vi();var c=(o-1)*s;f==null&&(f=0);t.ajax({url:VIS.Application.contextUrl+"VA005/ProductManagement/GetProdInfo",type:"GET",datatype:"json",contentType:"application/json; charset=utf-8",data:{searchText:n,proCategory:i,SearchQuery:f,pageNo:o,pageSize:s,Parent_ID:h},success:function(n){var i,f,h;if(e.css("width","100%"),i=JSON.parse(n),i.length>0)if(o==1&&(kh=i[0].productCount,dh=Math.ceil(kh/tt)),lt.prop("checked"))for(f in i){c=c+1;var v=VIS.Utility.encodeText(i[f].Prodname),y=VIS.Utility.encodeText(i[f].ProCatName),s=i[f].M_ProductID,p=VIS.Utility.encodeText(i[f].SearchKey),w=i[f].C_UomID,b=VIS.Utility.encodeText(i[f].UOM),k=VIS.Utility.encodeText(i[f].UPC),d=new Date,l=i[f].ProdImage,a="";l==""?a='<i class="fa fa-user" alt="prod-img"><\/i>':(l=VIS.Application.contextUrl+l,a='<img src="'+l+"?"+d.getTime()+'" alt="prod-img">');u.push(s);h=t('<div class="vis-group-user-wrap vis-group-selected-op vis-group-selected-opbackground" data-UID="'+s+'"><input type="checkbox" data-UID="'+s+'"style="margin-left:0px;" class="vis-group-addLeft VA005-checkbox" checked="true"><div draggable="true" class="VA005-productinfowrp vis-group-user-profile" data-UID="'+s+'"><div class="vis-group-user-img vis-chatimgwrap">'+a+'<\/div><div class="vis-group-user-text"><p class="VA005-NameOfSelectedNode" style="font-weight: bold">'+v+"<\/p><span>"+y+'<\/span><span style="display:list-item;">'+p+'<\/span><\/div><\/div><div class="vis-group-user-right d-flex"><span id="VA005_Barcode_'+c+'" style="float:left;"><\/span><div class="d-flex flex-column"><div class="vis-group-user-right d-flex"><span class="VA005-uom-icons vis vis-image VA005-icons-color" data-UID="'+s+'" title="'+VIS.Msg.getMsg("VA005_ShowAllImages")+'"><\/span><span class="VA005-uom-icons vis vis-edit VA005-icons-color" data-UID="'+s+'" title="'+VIS.Msg.getMsg("Edit")+'"><\/span><span class="VA005-uom-icons fa fa-shopping-cart VA005-icons-color" data-UID="'+s+'" title="'+VIS.Msg.getMsg("VA005_AddCart")+'"><\/span><\/div><span class="VA005-Uom-span" data-UID="'+w+'">'+b+"<\/span><\/div><\/div><\/div>");bf.append(h);hs(k,e.find("#VA005_Barcode_"+c));h.find(".vis-group-user-profile").width(h.width()-h.find(".vis-group-user-right:eq(0)").width()-20)}else for(f in i){c=c+1;var v=VIS.Utility.encodeText(i[f].Prodname),y=VIS.Utility.encodeText(i[f].ProCatName),s=i[f].M_ProductID,p=VIS.Utility.encodeText(i[f].SearchKey),w=i[f].C_UomID,b=VIS.Utility.encodeText(i[f].UOM),k=VIS.Utility.encodeText(i[f].UPC),d=new Date,l=i[f].ProdImage,a="";l==""?a='<i class="fa fa-user" alt="prod-img"><\/i>':(l=VIS.Application.contextUrl+l,a='<img src="'+l+"?"+d.getTime()+'" alt="prod-img">');h=t('<div class="vis-group-user-wrap" data-UID="'+s+'"><input type="checkbox" data-UID="'+s+'" style="margin-left:0px;" class="vis-group-addLeft VA005-checkbox"><div draggable="true" class="VA005-productinfowrp vis-group-user-profile" data-UID="'+s+'"><div class="vis-group-user-img vis-chatimgwrap">'+a+'<\/div><div class="vis-group-user-text"><p class="VA005-NameOfSelectedNode" style="font-weight: bold">'+v+"<\/p><span>"+y+'<\/span><span style="display:list-item;">'+p+'<\/span><\/div><\/div><div class="vis-group-user-right d-flex"><span id="VA005_Barcode_'+c+'" style="float:left;"><\/span><div class="d-flex flex-column"><div class="vis-group-user-right d-flex"><span class="VA005-uom-icons vis vis-image VA005-icons-color" data-UID="'+s+'" title="'+VIS.Msg.getMsg("VA005_ShowAllImages")+'"><\/span><span class="VA005-uom-icons vis vis-edit VA005-icons-color" data-UID="'+s+'" title="'+VIS.Msg.getMsg("Edit")+'"><\/span><span class="VA005-uom-icons fa fa-shopping-cart VA005-icons-color" data-UID="'+s+'" title="'+VIS.Msg.getMsg("VA005_AddCart")+'"><\/span><\/div><span class="VA005-Uom-span" data-UID="'+w+'">'+b+"<\/span><\/div><\/div><\/div>");bf.append(h);hs(k,e.find("#VA005_Barcode_"+c));h.find(".vis-group-user-profile").width(h.width()-h.find(".vis-group-user-right:eq(0)").width()-20)}else VIS.ADialog.info("FindZeroRecords");rl=t(t(".vis-group-user-wrap")[0]).width();cs();window.setTimeout(function(){ct.css("float","left");r[0].style.visibility="hidden"},500)},error:function(){VIS.ADialog.error("VA005_ErrorLoadingProducts");r[0].style.visibility="hidden"}});we()}function gv(){r[0].style.visibility="visible";t.ajax({type:"POST",url:VIS.Application.contextUrl+"VA005/ProductManagement/Save",dataType:"json",data:{id:yu,Org:uu.val(),Name:VIS.Utility.Util.getValueOfString(sf.val()),Value:VIS.Utility.Util.getValueOfString(hf.val()),ProductType:br.val(),attrSet:VIS.Utility.Util.getValueOfInt(wi.val()),taxcat:VIS.Utility.Util.getValueOfInt(fi.val()),prodCat:VIS.Utility.Util.getValueOfInt(gt.val()),UOM:VIS.Utility.Util.getValueOfInt(fr.val()),UPC:VIS.Utility.Util.getValueOfString(se.val()),Parent_ID:kr},success:function(n){var t=JSON.parse(n);t.error==""?(yu==0&&(yu=t.M_Product_ID),lf(),u=[],k=[],d=1,yi.find("li").remove(),bu(gi.val(),1,tt),e.find(".vis-group-user-wrap").remove(),ci(pt.val(),vt,ft.val(),d,tt,kr),y.close(),r[0].style.visibility="hidden",VIS.ADialog.info("RecSaved")):(r[0].style.visibility="hidden",VIS.ADialog.error(t.error))},error:function(n,t,i){console.log(t);r[0].style.visibility="hidden";alert(i)}})}function ny(){r[0].style.visibility="visible";var n=[];for(item in h.records)h.records[item].updated==!0&&n.push(h.records[item]);t.ajax({type:"POST",url:VIS.Application.contextUrl+"VA005/ProductManagement/UpdatePrice",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify({id:ei.val(),priceData:n}),success:function(n){var t=n.result;r[0].style.visibility="hidden";t==""?(ri.close(),VIS.ADialog.info("Updated")):VIS.ADialog.error("","",t,"")},error:function(n,t,i){console.log(t);r[0].style.visibility="hidden";alert(i);return}})}function ty(){r[0].style.visibility="visible";t.ajax({type:"POST",url:VIS.Application.contextUrl+"VA005/ProductManagement/UpdateSupplier",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify({Supplier:ki.val(),ColumnName:p.records}),success:function(n){var t=n.result;r[0].style.visibility="hidden";t==""?(ui.close(),VIS.ADialog.info("Updated")):VIS.ADialog.error("","",t,"")},error:function(n,t,i){console.log(t);r[0].style.visibility="hidden";alert(i);return}})}function ll(){r[0].style.visibility="visible";t.ajax({type:"POST",url:VIS.Application.contextUrl+"VA005/ProductManagement/saveInventoryCount",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify({ColumnName:ru.val()}),success:function(n){n.result!=""?(tr.hide(),lr.show(),ru.val(""),co=n.result,es(),du()):(r[0].style.visibility="hidden",VIS.ADialog.error(RecordNotSaved))},error:function(n,t,i){console.log(t);r[0].style.visibility="hidden";alert(i);return}})}function iy(){l.length>0?t.ajax({type:"POST",url:VIS.Application.contextUrl+"VA005/ProductManagement/saveInventory",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify({prodIDs:u,count_id:it.val(),ColumnName:l}),success:function(n){n.result==""?du():(oi=!1,VIS.ADialog.error(n.result),r[0].style.visibility="hidden")},error:function(n,t){oi=!1;console.log(t);r[0].style.visibility="hidden";alert("RecordNotSaved");return}}):(oi=!1,r[0].style.visibility="hidden")}function ry(){var n=[];for(item in s.records)s.records[item].updated==!0&&n.push(s.records[item]);n.length>0&&(r[0].style.visibility="visible",t.ajax({type:"POST",url:VIS.Application.contextUrl+"VA005/ProductManagement/updateInventory",dataType:"json",async:!1,contentType:"application/json; charset=utf-8",data:JSON.stringify({count_id:it.val(),ColumnName:n}),success:function(n){r[0].style.visibility="hidden";n.result==""?(du(),t(".VA005-cart-update").fadeIn(),t(".VA005-cart-update").fadeOut(2e3)):VIS.ADialog.error(n.result)},error:function(n,t){console.log(t);r[0].style.visibility="hidden";alert("RecordNotSaved");return}}))}function uy(){r[0].style.visibility="visible";var n=[],i=s.getSelection();for(item in i)n.push(s.get(i[item]));t.ajax({type:"POST",url:VIS.Application.contextUrl+"VA005/ProductManagement/deleteInventory",dataType:"json",async:!1,contentType:"application/json; charset=utf-8",data:JSON.stringify({ColumnName:n}),success:function(n){r[0].style.visibility="hidden";n.result==""?(du(),s.selectNone()):(VIS.ADialog.error(n.result),du())},error:function(n,t){console.log(t);r[0].style.visibility="hidden";alert("DeleteError");return}})}function fy(){var n=[];for(item in st.records)st.records[item].updated==!0&&n.push(st.records[item]);n.length>0&&(r[0].style.visibility="visible",t.ajax({type:"POST",url:VIS.Application.contextUrl+"VA005/ProductManagement/UpdateRelatedProduct",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify({id:u[0],relatedData:n}),success:function(n){r[0].style.visibility="hidden";n.result==""?af():VIS.ADialog.error(n.result)},error:function(n,t){console.log(t);r[0].style.visibility="hidden";alert("RecordNotSaved");return}}))}function ey(){r[0].style.visibility="visible";var n=[],i=st.getSelection();for(item in i)n.push(st.get(i[item]));t.ajax({type:"POST",url:VIS.Application.contextUrl+"VA005/ProductManagement/deleteRelatedProduct",dataType:"json",async:!1,contentType:"application/json; charset=utf-8",data:JSON.stringify({id:u[0],relatedData:n}),success:function(n){r[0].style.visibility="hidden";n.result==""?(af(),st.selectNone()):(VIS.ADialog.error(n.result),af())},error:function(n,t){console.log(t);r[0].style.visibility="hidden";alert("DeleteError");return}})}function oy(n){n!=null&&(uu.val(n.AD_Org_ID),sf.val(n.Name),yu==0?hf.val(""):hf.val(n.Value),fr.val(n.C_UOM_ID),wi.val(n.M_AttributeSet_ID),gt.val(n.M_Product_Category_ID),br.val(n.ProductType),fi.val(n.C_TaxCategory_ID),se.val(n.UPC))}function al(){so.val("");vu.val(0)}function sy(){v.on("click",function(n){var i=t(n.target),r;i.hasClass("VA005-AttValofbindingImg")?v.find(".VA005-AttValueImgaeBorderSelect").removeClass("VA005-AttValueImgaeBorderSelect"):i.hasClass("VA005-Image-AttValImg")?(r=i.parent(),r.hasClass("VA005-AttValueImgaeBorderSelect")?r.removeClass("VA005-AttValueImgaeBorderSelect"):r.addClass("VA005-AttValueImgaeBorderSelect")):i.hasClass("VA005-Image-AttValPar")?(r=i.parent(),r.hasClass("VA005-AttValueImgaeBorderSelect")?r.removeClass("VA005-AttValueImgaeBorderSelect"):r.addClass("VA005-AttValueImgaeBorderSelect")):i.hasClass("VA005-AttributesValuesImgTop")&&(i.hasClass("VA005-AttValueImgaeBorderSelect")?i.removeClass("VA005-AttValueImgaeBorderSelect"):i.addClass("VA005-AttValueImgaeBorderSelect"));v.find(".VA005-AttValueImgaeBorderSelect").length>0?ve.removeClass("VA005-AttValOpacity"):ve.addClass("VA005-AttValOpacity")});ct.on("resize",function(n,t){ul=t.size.height;f.find(".vis-group-users-container").height(ul);v.parent().height(li.height()-(f.find(".vis-group-users-container").height()+108));v.height(li.height()-(f.find(".vis-group-users-container").height()+128));var i=li.height()-90;ct.css("max-height",i);f.find(".vis-group-users-container").css("max-height",i);ct.css("width","100%");f.find(".vis-group-users-container").css("width","100%");e.height(e.height()-20);window.setTimeout(function(){v.height(v.parent().height()-15)},200)});if(v.mouseover(function(){f.find(".vis-group-users-container .vis-group-user-wrap").hasClass("ui-droppable")&&f.find(".vis-group-users-container .vis-group-user-wrap").droppable("destroy")}),f.find(".vis-group-users-container").mouseover(function(){f.find(".vis-group-users-container .vis-group-user-wrap").droppable({drop:function(n,i){dl(t(i.draggable).attr("path"),t(i.draggable).attr("filename"),parseInt(t(this).attr("data-uid")),t(this))}})}),$ImageZoom.click(function(){$ImageZoom.fadeOut("slow")}),yi)yi.on("click","LI",function(n){vt=VIS.Utility.Util.getValueOfInt(t(n.target).attr("procatid"));var i=t(n.target).text();i=" -> "+i.substr(0,i.indexOf("("));vt>0&&(d=1,u=[],k=[],ft.val(0),pt.val(""),lt.prop("checked",!1),vi(),tf.text(i).show(),ti==!0&&hi.trigger("click"),e.find(".vis-group-user-wrap").remove(),ci("",vt,0,d,tt,0))});if(dr!=null)dr.on("click","LI",function(n){var i=t(n.target).data("action");i==VIS.Actions.refresh?b.Attribute=="Y"?is():b.Category=="Y"?us(gt):b.Tax=="Y"?rs():b.UOM=="Y"&&fs(fr):i==VIS.Actions.zoom&&(b.Attribute=="Y"&&ku(VIS.Utility.Util.getValueOfInt(wi.val()),"Attribute Set"),b.Category=="Y"?ku(VIS.Utility.Util.getValueOfInt(gt.val()),"Product Category"):b.Tax=="Y"?ku(VIS.Utility.Util.getValueOfInt(fi.val()),"Tax Category"):b.UOM=="Y"&&ku(VIS.Utility.Util.getValueOfInt(fr.val()),"Unit of Measure"))});wf.on("change",function(){wf.val()!=""&&(wf.val()=="C"?(f.find(".VA005-middle-cat-bar").show(),ys.css({display:"block"}),yf.show(),gi.val(""),yi.find("li").remove(),bu(gi.val(),1,tt),vs.css({display:"block"}),si.css({display:"none"}),vt=0,d=1,u=[],k=[],kr=0,parentAttribute=0,ce=0,parentQuality=0,le=0,ft.val(0),pt.val(""),lt.prop("checked",!1),vi(),ti==!0&&hi.trigger("click"),e.find(".vis-group-user-wrap").remove(),ci("",vt,0,d,tt,0)):wf.val()=="T"&&(tf.text(""),f.find(".VA005-middle-cat-bar").hide(),ys.css({display:"none"}),yf.hide(),vs.css({display:"none"}),r[0].style.visibility="visible",pp(),vt=0,d=1,u=[],k=[],parentAttribute=0,ce=0,parentQuality=0,le=0,ft.val(0),pt.val(""),lt.prop("checked",!1),vi(),ti==!0&&hi.trigger("click"),e.find(".vis-group-user-wrap").remove(),ci("",vt,0,d,tt,kr)))});nl.on("click",function(){r[0].style.visibility="visible";window.setTimeout(function(){ti==!0&&hi.trigger("click");ec();fc();rc();uc();is();rs();us();fs(fr);we();cs();vi();o.show();hr.hide();d=1;u=[];yi.find("li").remove();bu(gi.val(),1,tt);e.find(".vis-group-user-wrap").remove();ci(pt.val(),vt,0,d,tt,kr)},1e3)});io.on("click",function(){io!=null&&n.uploadImage(0,0,0,0,wu,i)});ro.on("click",function(){ro!=null&&lp()});eo.on("click",function(){eo!=null&&(ou=[],wu.find("li").removeClass("VA005-highlighted"))});ac.on("click",function(){r[0].style.visibility="visible";yi.find("li").remove();bu(gi.val(),1,tt);window.setTimeout(function(){r[0].style.visibility="hidden"},1e3)});gi.on("keydown",function(n){(n.keyCode==9||n.keyCode==13)&&(r[0].style.visibility="visible",yi.find("li").remove(),bu(gi.val(),1,tt),window.setTimeout(function(){r[0].style.visibility="hidden"},1e3))});ps.on("click",function(){r[0].style.visibility="visible";d=1;u=[];k=[];vi();lt.prop("checked",!1);ti==!0&&hi.trigger("click");e.find(".vis-group-user-wrap").remove();ci(pt.val(),vt,ft.val(),d,tt,0)});pt.on("keydown",function(n){(n.keyCode==9||n.keyCode==13)&&(r[0].style.visibility="visible",d=1,u=[],k=[],vi(),lt.prop("checked",!1),ti==!0&&hi.trigger("click"),e.find(".vis-group-user-wrap").remove(),ci(pt.val(),vt,ft.val(),d,tt,0))});e.on("scroll",ip);ft&&ft.change(function(){d=1;u=[];k=[];vt=0;lt.prop("checked",!1);pt.val("");tf.hide();vi();ti==!0&&hi.trigger("click");e.find(".vis-group-user-wrap").remove();ci("",0,ft.val(),d,tt,kr)});ot.on("scroll",rp);be.on("click",function(n){n.stopPropagation();var t=gr.width(),i=pf.width();t>50&&ot.hide();gr.animate({width:t>50?40:250},300,"swing",function(){t<50&&ot.show();e.find(".vis-group-user-profile").width(e.width()-e.find(".vis-group-user-right:eq(0)").width()-20);s.resize();st.resize()})});ws.on("click",function(){r[0].style.visibility="visible";gt.val(ce);fi.val(le);y=new VIS.ChildDialog;y.setContent(nt);nt.show();y.setWidth(600);y.setTitle(VIS.Msg.getMsg("VA005_AddProduct"));y.setModal(!0);y.onClose=function(){lf()};y.show();hc();r[0].style.visibility="hidden"});uh.on("click",function(){if(u.length==0)return VIS.ADialog.error("VA005_SelectProduct"),!1;if(u.length>1)return!1;r[0].style.visibility="visible";yu=0;oc();y=new VIS.ChildDialog;y.setContent(nt);nt.show();y.setWidth(600);y.setTitle(VIS.Msg.getMsg("VA005_AddProduct"));y.setModal(!0);y.onClose=function(){lf()};y.show();hc();r[0].style.visibility="hidden"});vc.on("click",function(){r[0].style.visibility="visible";yu=u[0];oc();y=new VIS.ChildDialog;y.setContent(nt);nt.show();y.setWidth(600);y.setTitle(VIS.Msg.getMsg("VA005_AddProduct"));y.setModal(!0);y.onClose=function(){lf()};y.show();hc();r[0].style.visibility="hidden"});to.on("click",function(){o.hide();hr.show();i.GetImages()});vh.on("click",function(){o.show();hr.hide()});wu.on("click","li",function(){t(this).hasClass("VA005-highlighted")?(t(this).removeClass("VA005-highlighted"),ou.splice(ou.indexOf(t(this).attr("filename")),1)):(t(this).addClass("VA005-highlighted"),ou.push(t(this).attr("filename")))});fh.on("click",function(){if(u.length==0)return VIS.ADialog.error("VA005_SelectProduct"),!1;r[0].style.visibility="visible";ri=new VIS.ChildDialog;ri.setContent(ds);cu.show();ri.setHeight(500);ri.setWidth(853);ri.setTitle(VIS.Msg.getMsg("VA005_UpdatePrice"));ri.setModal(!0);ri.onClose=function(){ei.val(0);h.clear();$ImageZoom.fadeOut("slow")};ri.show();sl();up()});eh.on("click",function(){if(u.length==0)return VIS.ADialog.error("VA005_SelectProduct"),!1;r[0].style.visibility="visible";ui=new VIS.ChildDialog;ui.setContent(yc);nf.show();ui.setHeight(500);ui.setWidth(703);ui.setTitle(VIS.Msg.getMsg("VA005_UpdateSupplier"));ui.setModal(!0);ui.onClose=function(){ki.val(0);p.clear()};ui.show();hl();hp()});oh.on("click",function(){if(u.length==0)return VIS.ADialog.error("VA005_SelectProduct"),!1;var t=new n.updateProductPanel(i.windowNo,140,208,u);t.onClose=function(){t.okBtnPressed&&(u=[],k=[],e.find(".vis-group-user-wrap").remove(),ci(pt.val(),vt,ft.val(),1,tt,0));t.dispose()};t.show()});sh.on("click",function(){vi();d=1;ft.val(0);pt.val("");vt=0;lt.prop("checked",!1);tf.hide();u=[];ti==!0&&hi.trigger("click");e.find(".vis-group-user-wrap").remove();ci("",0,0,d,tt,0)});lt.on("click",function(){window.setTimeout(function(){if(lt.is(":checked")){u=[];for(var n=0;n<e.find(".vis-group-user-wrap").length;n++)u.push(t(e.find(".vis-group-user-wrap")[n]).data("uid"));e.find(".vis-group-user-wrap").addClass("vis-group-selected-op vis-group-selected-opbackground");e.find(".VA005-checkbox").prop("checked",!0);vi()}else u=[],e.find(".vis-group-user-wrap").removeClass("vis-group-selected-op vis-group-selected-opbackground"),e.find(".VA005-checkbox").prop("checked",!1);ti==!0&&hi.trigger("click")},200)});ue.on("click",function(){if(!oi){if(it.val()==0){VIS.ADialog.error("VA005_selectCart");return}(u.length!=0||et.length!=0||rt.length!=0)&&(r[0].style.visibility="visible",oi=!0,ue.find("span").css("color","lime"),window.setTimeout(function(){ue.find("span").css("color","#616364")},1e3),os("A"))}});rf.on("click",function(){if(u.length==0)return VIS.ADialog.error("VA005_SelectProduct"),!1;if(u.length>1)return!1;vr.find("li").removeClass("VA005-selectedTab");rf.addClass("VA005-selectedTab");ye();ir.hide();hu();cr.hide();a.hide();rt=[];g=0;et=[];w={};ht=0;c.find(".VA005-checkbox").prop("checked",!1);c.find(".VA005-uom-wrap").removeClass("vis-group-selected-op vis-group-selected-opbackground");a.find(".VA005-checkbox").prop("checked",!1);a.find(".VA005-uom-wrap").removeClass("vis-group-selected-op vis-group-selected-opbackground");c.hide();wt.hide();ii.hide();lr.show();tr.hide();pi.hide();ai.hide();nr.show();sc()});lu.on("click",function(){if(u.length==0)return VIS.ADialog.error("VA005_SelectProduct"),!1;if(u.length>1)return!1;lu.hasClass("VA005-selectedTab")||(vr.find("li").removeClass("VA005-selectedTab"),lu.addClass("VA005-selectedTab"),hu(),cr.hide(),a.hide(),rt=[],g=0,a.find(".VA005-checkbox").prop("checked",!1),a.find(".VA005-uom-wrap").removeClass("vis-group-selected-op vis-group-selected-opbackground"),ii.hide(),lr.show(),tr.hide(),pi.hide(),nr.hide(),ai.hide(),ir.show(),c.show(),pe())});au.on("click",function(){if(u.length==0)return VIS.ADialog.error("VA005_SelectProduct"),!1;if(u.length>1)return!1;au.hasClass("VA005-selectedTab")||(vr.find("li").removeClass("VA005-selectedTab"),au.addClass("VA005-selectedTab"),ye(),ir.hide(),et=[],w={},ht=0,c.find(".VA005-checkbox").prop("checked",!1),c.find(".VA005-uom-wrap").removeClass("vis-group-selected-op vis-group-selected-opbackground"),c.hide(),wt.hide(),ii.hide(),lr.show(),tr.hide(),pi.hide(),nr.hide(),ai.hide(),cr.show(),a.show(),ss())});uf.on("click",function(){if(u.length==0)return VIS.ADialog.error("VA005_SelectProduct"),!1;if(u.length>1)return!1;uf.hasClass("VA005-selectedTab")||(vr.find("li").removeClass("VA005-selectedTab"),uf.addClass("VA005-selectedTab"),hu(),cr.hide(),a.hide(),ye(),ir.hide(),c.hide(),w={},wt.hide(),nr.hide(),ii.hide(),pi.hide(),ai.show(),ai.css("height","92%"),af())});fe.on("click",function(){fe.hasClass("VA005-selectedTab")||(vr.find("li").removeClass("VA005-selectedTab"),fe.addClass("VA005-selectedTab"),hu(),cr.hide(),a.hide(),ye(),ir.hide(),c.hide(),w={},wt.hide(),nr.hide(),ai.hide(),ii.show(),pi.show(),pi.css("height","75%"),s.resize())});ff.on("click",function(){gu.show();ff.hide();g=0;a.css("height","55%")});ef.on("click",function(){eu>0&&(ar.show(),ef.hide(),iu.hide(),c.css("height","75%"))});hh.on("click",function(){for(var i,n=0;n<ae.length;n++)i=ae[n],w[i]&&(w[i]=w[i].join(","));w&&(r[0].style.visibility="visible",t.ajax({type:"POST",url:VIS.Application.contextUrl+"VA005/ProductManagement/SaveAttribute",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify({id:u[0],AttributeSet:eu,ColumnName:ae,ColumnValue:w}),success:function(n){var t=n.result;t==""||t==null?(w={},wt.hide(),pe(),c.show()):(w={},dt.find(".VA005-checkbox").prop("checked",!1),VIS.ADialog.error(t));r[0].style.visibility="hidden"},error:function(n,t){w={};dt.find(".VA005-checkbox").prop("checked",!1);console.log(t);r[0].style.visibility="hidden";alert("RecordNotSaved");return}}))});ch.on("click",function(){w={};ir.show();c.show();wt.hide()});iu.on("click",function(){c.hide();wt.show();wl()});lh.on("click",function(){ar.hide();wt.hide();ef.show();iu.show();c.show();c.css("height","85%")});ee.on("click",function(){if(bi.val()==-1){VIS.ADialog.error("VA005_SelectUom");return}hy()});ah.on("click",function(){hu()});yh.on("click",function(){lr.hide();tr.show()});ph.on("click",function(){ku(VIS.Utility.Util.getValueOfInt(it.val()),"VAICNT_InventoryCount")});wh.on("click",function(){es()});uo.on("click",function(){if(VIS.Utility.Util.getValueOfString(ru.val())==""){VIS.ADialog.error("VA005_EnterScanName");return}ll()});uo.on("keydown",function(n){if(n.keyCode==13){if(VIS.Utility.Util.getValueOfString(ru.val())==""){VIS.ADialog.error("VA005_EnterScanName");return}ll()}});fo.on("click",function(){tr.hide();lr.show();ru.val("")});fo.on("keydown",function(n){n.keyCode==13&&(tr.hide(),lr.show(),ru.val(""))});tl.on("click",function(){var n=s.getSelection();if(n.length>0){r[0].style.visibility="visible";bh=[];for(item in n)bh.push(s.get(n[item]));rr=new VIS.ChildDialog;rr.setContent(re);re.show();rr.setWidth(300);rr.setTitle(VIS.Msg.getMsg("VA005_PrintStickers"));rr.setModal(!0);rr.onClose=function(){al()};rr.show();wv();ep();r[0].style.visibility="hidden"}else VIS.ADialog.info("NoRecordsSelected")});it.on("change",function(){co=it.val();it.val()==0?ur.find("#VA005_cartInfo_"+i.windowNo).text(VIS.Msg.getMsg("None")):ur.find("#VA005_cartInfo_"+i.windowNo).text(it.find("option:selected").text());du()});bi.on("change",function(){bi.val()>0?ee.removeClass("VA005-disabled"):ee.removeClass("VA005-disabled")});this.vetoablechange=function(n){if(n.propertyName=="MulAmount"){pr.setValue(n.newValue);var t=n.newValue,i=VIS.Env.ZERO,r=1;VIS.Utility.Util.getValueOfDouble(t)!=0&&(i=(r/t).toFixed(12));tc=!0;wr.setValue(i)}else if(n.propertyName=="DivAmount"){if(wr.setValue(n.newValue),tc){tc=!1;return}var t=n.newValue,i=VIS.Env.ZERO,r=1;VIS.Utility.Util.getValueOfDouble(t)!=0&&(i=(r/t).toFixed(12));pr.setValue(i)}}}function os(n){var f=n,r=0,i,t;if(f=="U")t=VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductManagement/LoadUOMConversionData",{C_UOM_Conversion_ID:g}),t!=null&&l.push({recid:r,product_ID:t.M_Product_ID,Product:t.Name,C_Uom_ID:t.C_UOM_To_ID,attribute_ID:0,Attribute:"",UPC:t.UPC,Qty:1});else if(f=="V")at==""&&(at=" "),t=VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductManagement/LoadProdAttributeData",{M_Product_ID:u[0],M_AttributeSetInstance_ID:ht,UPC:at}),t!=null&&l.push({recid:r,product_ID:t.M_Product_ID,Product:t.Name,C_Uom_ID:t.C_UOM_ID,attribute_ID:t.M_AttributeSetInstance_ID,Attribute:t.Description,UPC:t.UPC,Qty:1});else if(f=="P")t=VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductManagement/LoadProductCartData",{M_Product_ID:ut}),t!=null&&l.push({recid:r,product_ID:ut,Product:t.Name,C_Uom_ID:t.C_UOM_ID,attribute_ID:t.M_AttributeSetInstance_ID,Attribute:t.Description,UPC:t.UPC,Qty:1});else if(f=="A")if(rt.length>0)for(i in rt)t=VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductManagement/LoadUOMConversionData",{C_UOM_Conversion_ID:rt[i]}),t!=null&&l.push({recid:r,product_ID:t.M_Product_ID,Product:t.Name,C_Uom_ID:t.C_UOM_To_ID,attribute_ID:0,Attribute:"",UPC:t.UPC,Qty:1});else if(et.length>0)for(i in et)bt[i]==""&&(bt[i]=" "),t=VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductManagement/LoadProdAttributeData",{M_Product_ID:u[0],M_AttributeSetInstance_ID:et[i],UPC:bt[i]}),t!=null&&l.push({recid:r,product_ID:t.M_Product_ID,Product:t.Name,C_Uom_ID:t.C_UOM_ID,attribute_ID:t.M_AttributeSetInstance_ID,Attribute:t.Description,UPC:t.UPC,Qty:1});else if(u.length>0)for(i in u)t=VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductManagement/LoadProductCartData",{M_Product_ID:u[i]}),t!=null&&l.push({recid:r,product_ID:u[i],Product:t.Name,C_Uom_ID:t.C_UOM_ID,attribute_ID:t.M_AttributeSetInstance_ID,Attribute:t.Description,UPC:t.UPC,Qty:1});iy()}function hy(){r[0].style.visibility="visible";t.ajax({type:"POST",url:VIS.Application.contextUrl+"VA005/ProductManagement/SaveConversion",dataType:"json",data:{id:u[0],Conv_ID:g,Mul:VIS.Utility.Util.getValueOfDouble(pr.getValue()),Div:VIS.Utility.Util.getValueOfDouble(wr.getValue()),UOM:k[0],UomTo:VIS.Utility.Util.getValueOfInt(bi.val()),UOMUPC:VIS.Utility.Util.getValueOfString(he.val())},success:function(n){var t=n.result;t==""?(hu(),ss(),a.show()):VIS.ADialog.error("","",t,"");r[0].style.visibility="hidden"},error:function(n,t){console.log(t);r[0].style.visibility="hidden";alert("RecordNotSaved");return}})}function hu(){bi.val(-1);pr.setValue(0);wr.setValue(0);he.val("");g=0;gu.hide();ff.show();a.css("height","85%")}function ye(){oo.getControl().val("");ar.hide();ef.show()}function cy(){de.css("display","none");ge.text("");kf.find("span").remove();df.find("span").remove();te.find("span").remove();gf.find("span").remove();ne.find("span").remove();ie.find("span").remove();no.find("span").remove();er.empty();er.append(t('<i style="max-height: 100%; max-width: 100%;" class="vis vis-image" ><\/i>'))}function vi(){au.removeClass("VA005-selectedTab");lu.removeClass("VA005-selectedTab");uf.removeClass("VA005-selectedTab");rt=[];et=[];w={};g=0;ht=0;c.find(".VA005-checkbox").prop("checked",!1);c.find(".VA005-uom-wrap").removeClass("vis-group-selected-op vis-group-selected-opbackground");a.find(".VA005-checkbox").prop("checked",!1);a.find(".VA005-uom-wrap").removeClass("vis-group-selected-op vis-group-selected-opbackground");hu();ye();cy();cr.hide();a.hide();ir.hide();c.hide();wt.hide();ai.hide()}function ly(n,u){r[0].style.visibility="visible";t.ajax({type:"POST",url:VIS.Application.contextUrl+"VA005/ProductManagement/GetAttributeValues",dataType:"json",async:!1,data:{product_id:u},success:function(o){var h=JSON.parse(o),s,c,b,k,d,p,g;if(v.empty(),h!=null&&h.length>0){var w=0,l="",a=null,y=null;for(s=0;s<h.length;s++){if(c=h[s].imageurl,s==0){l=t('<div class="VA005-AttributesValuesBtm VA005-AttValues-Btm"><div><span class="glyphicon glyphicon-minus VA005-vis-plus"><\/span><p style="color:rgba(var(--v-c-primary), 1);font-weight:bold;">'+h[s].AttributeName+"<\/p><\/div><\/div>");v.append(l.append(t('<div class="VA005-getDiv_'+s+' VA005-AttValofbindingImg" style="width:100%;">')));a=v.find(".VA005-getDiv_"+s+"");l.find(".VA005-vis-plus").on("click",function(){vl(t(this),t(t(this).parents()[1]).find(".VA005-AttValofbindingImg"))})}else if(w!=h[s].attributeID){l=t('<div class="VA005-AttributesValuesDown VA005-AttValues-Btm"><div><span class="glyphicon glyphicon-minus VA005-vis-plus" style="float: left; margin: 2px 5px 0 0; font-size: 12px;"><\/span><p style="color:rgba(var(--v-c-primary), 1);font-weight:bold;">'+h[s].AttributeName+"<\/p><\/div><\/div>");v.append(l.append(t('<div class="VA005-getDiv_'+s+' VA005-AttValofbindingImg" style="width:100%;">')));a=v.find(".VA005-getDiv_"+s+"");l.find(".VA005-vis-plus").on("click",function(){vl(t(this),t(t(this).parents()[1]).find(".VA005-AttValofbindingImg"))})}c==""?(c=VIS.Application.contextUrl+"Areas/VA005/Images/img-defult.png",y=t('<div class="vis-group-user-img VA005-AttributesValuesImgTop"><img style="height: 32px;width: 32px;" class="VA005-Image-AttValImg" src="'+c+'" data-uid="'+u+'" data-attimages_id="'+h[s].attimages+'"  data-attvalID="'+h[s].AttributeValueID+'"  alt="prod-img"><p class="VA005-Image-AttValPar">'+h[s].attValueName+"<\/p><\/div>")):(b=new Date,k=b.getTime(),c=VIS.Application.contextUrl+c+"?"+k,y=t('<div class="vis-group-user-img VA005-AttributesValuesImgTop"><img class="VA005-Image-AttValImg" src="'+c+'" data-uid="'+u+'" data-attimages_id="'+h[s].attimages+'"  data-attvalID="'+h[s].AttributeValueID+'"  alt="prod-img"><p class="VA005-Image-AttValPar">'+h[s].attValueName+"<\/p><\/div>"));a.append(y);w=h[s].attributeID}}(h.length==0||h==null)&&(d=t('<span style="float: left;width: 100%;text-align: center;"><p style="padding-top: 5%;">'+VIS.Msg.getMsg("TMRecordNotFound")+"<\/p><\/span>"),v.append(d));vy(n);v.parent().prepend(go);ns=f.find("#VA005_SelectedNodeText_"+i.windowNo);ns.text(e.find(".vis-group-selected-op").find(".VA005-NameOfSelectedNode").text());p=ns.text();p+=" "+VIS.Msg.getMsg("VA005_Attributelisting");ns.text(p);ve=go.find("#VA005_btnDeleteAttVal_"+i.windowNo);hi=go.find("#VA005_btnDeleteCross_"+i.windowNo);ve.on("click",function(){v.find(".VA005-AttValueImgaeBorderSelect").length>0&&VIS.ADialog.confirm("VA005_DoyouWanttoDelete",!0,"","Confirm",function(n){if(n)ay();else return})});hi.on("click",function(){e.height(t(f.parent()).height()-95);v.parent().css("display","none");e.css("border-bottom","none");ct.find(".ui-resizable-s").css("display","none");ct.find(".ui-resizable-se").css("display","none");ct.css("border-bottom","none");e.height(e.height()+20);ti=!1});r[0].style.visibility="visible";g=li.height()-(e.height()+105);v.parent().height(g);ct.height(t(f.parent()).height()-400);e.height(t(f.parent()).height()-400);v.parent().height(li.height()-(f.find(".vis-group-users-container").height()+130));v.height(li.height()-(f.find(".vis-group-users-container").height()+130));v.parent().css("display","inherit");ct.find(".ui-resizable-s").css("display","inherit");ct.find(".ui-resizable-se").css("display","inherit");e.height(e.height()-20);ct.css("border-bottom","2px solid rgba(var(--v-c-primary), 1)");window.setTimeout(function(){r[0].style.visibility="hidden"},300)},error:function(){r[0].style.visibility="hidden"}})}function ay(){var u,f,i,n;for(r[0].style.visibility="visible",u=[],f=v.find(".VA005-AttValueImgaeBorderSelect"),i=0;i<f.length;i++)(n=t(f.find("img")[i]),n.attr("data-attimages_id")!="")&&u.push({M_AttributeValue_ID:n.attr("data-attvalid"),M_Product_ID:n.attr("data-uid"),AD_Imaeg_ID:n.attr("data-attimages_id")});t.ajax({type:"post",dataType:"json",url:VIS.Application.contextUrl+"VA005/ProductManagement/DeleteAttributeValues",data:{attValueImagesID:JSON.stringify(u)},success:function(n){var u=JSON.parse(n),i,t;u==""&&(i=VIS.Application.contextUrl+"Areas/VA005/Images/img-defult.png",t=v.find(".VA005-AttValueImgaeBorderSelect").find("img"),t.attr("src",i),t.css({height:"32px",width:"32px"}),v.find(".VA005-AttValueImgaeBorderSelect").removeClass("VA005-AttValueImgaeBorderSelect"),ve.addClass("VA005-AttValOpacity"));r[0].style.visibility="hidden"},error:function(n){console.log(n);r[0].style.visibility="hidden"}})}function vy(){v.find(".VA005-AttributesValuesImgTop").droppable({drop:function(n,i){var r="";r=t(i.draggable).attr("path").contains("Thumb100x100")?t(i.draggable).attr("path").replace("Thumb100x100\\",""):t(i.draggable).attr("path");yp(r,t(i.draggable).attr("filename"),parseInt(t(this).find("img").attr("data-uid")),t(this),t(this).find("img").attr("data-attvalID"),t(this).find("img").attr("data-attimages_id"))},tolerance:"pointer"})}function vl(n,i){t(i).height()=="0"?(t(i).css("height","auto"),n.removeClass("vis vis-plus"),n.addClass("glyphicon glyphicon-minus")):(t(i).css("height","0px"),n.removeClass("glyphicon glyphicon-minus"),n.addClass("vis vis-plus"))}function yy(n){var i=t(n.target);if(i.hasClass("vis-image"))r[0].style.visibility="visible",ti=!0,to.trigger("click"),lt.prop("checked",!1),u=[],k=[],e.find(".VA005-checkbox").prop("checked",!1),e.find(".vis-group-user-wrap").removeClass("vis-group-selected-op vis-group-selected-opbackground"),t(i.parents(".vis-group-user-wrap")).addClass("vis-group-selected-op vis-group-selected-opbackground"),t(i.parents(".vis-group-user-wrap")).find(".VA005-checkbox").prop("checked",!0),ut=t(i.parents(".vis-group-user-wrap")).data("uid"),ni=t(i.parents(".vis-group-user-wrap")).find(".VA005-Uom-span").data("uid"),u.push(ut),k.push(ni);else{if(i.hasClass("vis-edit")){ut=i.data("uid");ku(ut,"Product");fl=ut;ut=0;return}if(i.hasClass("fa-shopping-cart")){if(!oi){if(it.val()==0){VIS.ADialog.error("VA005_selectCart");return}ut=i.data("uid");r[0].style.visibility="visible";oi=!0;i.css("color","lime");window.setTimeout(function(){i.css("color","#616364")},1e3);os("P")}return}if(i.hasClass("VA005-checkbox"))ut=i.data("uid"),ni=t(i.parents(".vis-group-user-wrap")).find(".VA005-Uom-span").data("uid"),i.prop("checked")?(window.setTimeout(function(){t(i.parents(".vis-group-user-wrap")).addClass("vis-group-selected-op vis-group-selected-opbackground")},200),u.push(ut),k.push(ni)):(window.setTimeout(function(){t(i.parents(".vis-group-user-wrap")).removeClass("vis-group-selected-op vis-group-selected-opbackground")},200),u.splice(u.indexOf(ut),1),k.splice(k.indexOf(ni),1)),ut=0;else if(i.hasClass("vis-group-user-wrap"))lt.prop("checked",!1),u=[],k=[],e.find(".VA005-checkbox").prop("checked",!1),i.hasClass("vis-group-selected-op vis-group-selected-opbackground")?(e.find(".vis-group-user-wrap").removeClass("vis-group-selected-op vis-group-selected-opbackground"),ut=0,ni=i.find(".VA005-Uom-span").data("uid"),k.splice(k.indexOf(ni),1)):(e.find(".vis-group-user-wrap").removeClass("vis-group-selected-op vis-group-selected-opbackground"),i.addClass("vis-group-selected-op vis-group-selected-opbackground"),i.find(".VA005-checkbox").prop("checked",!0),ut=i.data("uid"),ni=i.find(".VA005-Uom-span").data("uid"),u.push(ut),k.push(ni));else if(t(i.parents(".vis-group-user-wrap")).length>0)lt.prop("checked",!1),u=[],k=[],e.find(".VA005-checkbox").prop("checked",!1),t(i.parents(".vis-group-user-wrap")).hasClass("vis-group-selected-op vis-group-selected-opbackground")?(e.find(".vis-group-user-wrap").removeClass("vis-group-selected-op vis-group-selected-opbackground"),ut=0,ni=t(i.parents(".vis-group-user-wrap")).find(".VA005-Uom-span").data("uid"),k.splice(k.indexOf(ni),1)):(e.find(".vis-group-user-wrap").removeClass("vis-group-selected-op vis-group-selected-opbackground"),t(i.parents(".vis-group-user-wrap")).addClass("vis-group-selected-op vis-group-selected-opbackground"),t(i.parents(".vis-group-user-wrap")).find(".VA005-checkbox").prop("checked",!0),ut=t(i.parents(".vis-group-user-wrap")).data("uid"),ni=t(i.parents(".vis-group-user-wrap")).find(".VA005-Uom-span").data("uid"),u.push(ut),k.push(ni));else return}u.length==0||u.length>1?(vi(),u.length>1&&ti==!0&&hi.trigger("click")):i.hasClass("vis-image")||(hu(),vr.find("li").hasClass("VA005-selectedTab")?rf.hasClass("VA005-selectedTab")?sc():au.hasClass("VA005-selectedTab")?ss():lu.hasClass("VA005-selectedTab")?(pe(),wl()):uf.hasClass("VA005-selectedTab")&&af():(rf.addClass("VA005-selectedTab"),nr.show(),sc()));window.setTimeout(function(){if(ti==!0&&(r[0].style.visibility="visible",!i.hasClass("vis-edit"))){var u=0;u=t(e.find(".vis-group-selected-opbackground")[0]).attr("data-uid")==0||t(e.find(".vis-group-selected-opbackground")[0]).attr("data-uid")==""?fl:t(e.find(".vis-group-selected-opbackground")[0]).attr("data-uid");ly(n,u)}window.setTimeout(function(){r[0].style.visibility="hidden"},500)},100)}function py(){var t=VIS.dataContext.getJSONRecord("VA005/ProductManagement/GetAttributeSet",u[0]);if(t!=0){var r=VIS.context.getContextAsInt(i.windowNo,"M_Locator_ID"),f=VIS.context.getContextAsInt(i.windowNo,"C_BPartner_ID"),n=new VIS.PAttributesForm(0,u[0],r,f,!1,cf,i.windowNo);n.hasAttribute&&n.showDialog();n.onClose=function(){pe()}}else return}function wy(n){var i=t(n.target),u;if(i.hasClass("vis-edit"))g=i.attr("conversionid"),ff.hide(),gu.show(),ky(g);else if(i.hasClass("vis-delete"))u=i.attr("conversionid"),dy(u);else if(i.hasClass("fa-shopping-cart")){if(!oi){if(it.val()==0){VIS.ADialog.error("VA005_selectCart");return}g=i.attr("conversionid");r[0].style.visibility="visible";oi=!0;i.css("color","lime");window.setTimeout(function(){i.css("color","#616364")},1e3);os("U")}}else if(i.hasClass("VA005-checkbox"))g=t(i.parents(".VA005-uom-wrap")).attr("conversionid"),i.prop("checked")?(rt.push(g),window.setTimeout(function(){t(i.parents(".VA005-uom-wrap")).addClass("vis-group-selected-op vis-group-selected-opbackground")},200)):(rt.splice(rt.indexOf(g),1),window.setTimeout(function(){t(i.parents(".VA005-uom-wrap")).removeClass("vis-group-selected-op vis-group-selected-opbackground")},200));else if(i.hasClass("VA005-uom-wrap"))rt=[],a.find(".VA005-checkbox").prop("checked",!1),i.hasClass("vis-group-selected-op vis-group-selected-opbackground")?(a.find(".VA005-uom-wrap").removeClass("vis-group-selected-op vis-group-selected-opbackground"),g=i.attr("conversionid"),rt.splice(rt.indexOf(g),1)):(a.find(".VA005-uom-wrap").removeClass("vis-group-selected-op vis-group-selected-opbackground"),i.addClass("vis-group-selected-op vis-group-selected-opbackground"),i.find(".VA005-checkbox").prop("checked",!0),g=i.attr("conversionid"),rt.push(g));else if(t(i.parents(".VA005-uom-wrap")).length>0)rt=[],a.find(".VA005-checkbox").prop("checked",!1),t(i.parents(".VA005-uom-wrap")).hasClass("vis-group-selected-op vis-group-selected-opbackground")?(a.find(".VA005-uom-wrap").removeClass("vis-group-selected-op vis-group-selected-opbackground"),g=t(i.parents(".VA005-uom-wrap")).attr("conversionid"),rt.splice(rt.indexOf(g),1)):(a.find(".VA005-uom-wrap").removeClass("vis-group-selected-op vis-group-selected-opbackground"),t(i.parents(".VA005-uom-wrap")).addClass("vis-group-selected-op vis-group-selected-opbackground"),t(i.parents(".VA005-uom-wrap")).find(".VA005-checkbox").prop("checked",!0),g=t(i.parents(".VA005-uom-wrap")).attr("conversionid"),rt.push(g));else return}function by(n){var i=t(n.target),u;if(i.hasClass("VA005-checkbox"))ht=t(i.parents(".VA005-uom-wrap")).attr("attr_id"),at=t(i.parents(".VA005-uom-wrap")).attr("upc"),i.prop("checked")?(et.push(ht),bt.push(at),window.setTimeout(function(){t(i.parents(".VA005-uom-wrap")).addClass("vis-group-selected-op vis-group-selected-opbackground")},200)):(et.splice(et.indexOf(ht),1),bt.splice(bt.indexOf(at),1),window.setTimeout(function(){t(i.parents(".VA005-uom-wrap")).removeClass("vis-group-selected-op vis-group-selected-opbackground")},200));else if(i.hasClass("fa-shopping-cart")){if(!oi){if(it.val()==0){VIS.ADialog.error("VA005_selectCart");return}ht=i.attr("attr_id");at=i.attr("upc");r[0].style.visibility="visible";oi=!0;i.css("color","lime");window.setTimeout(function(){i.css("color","#616364")},1e3);os("V")}}else if(i.hasClass("VA005-Edit-UPC"))oe.popup({tooltipanchor:i,autoopen:!0,type:"tooltip",background:!0,backgroundactive:!0,offsetleft:-43,offsettop:-10}),of=i.attr("patrid"),u=VIS.dataContext.getJSONRecord("VA005/ProductManagement/GetProductUPC",of),yr.val(u);else if(i.hasClass("VA005-uom-wrap"))et=[],bt=[],c.find(".VA005-checkbox").prop("checked",!1),i.hasClass("vis-group-selected-op vis-group-selected-opbackground")?(c.find(".VA005-uom-wrap").removeClass("vis-group-selected-op vis-group-selected-opbackground"),ht=i.attr("attr_id"),at=i.attr("upc"),et.splice(et.indexOf(ht),1),bt.splice(bt.indexOf(at),1)):(c.find(".VA005-uom-wrap").removeClass("vis-group-selected-op vis-group-selected-opbackground"),i.addClass("vis-group-selected-op vis-group-selected-opbackground"),i.find(".VA005-checkbox").prop("checked",!0),ht=i.attr("attr_id"),at=i.attr("upc"),et.push(ht),bt.push(at));else if(t(i.parents(".VA005-uom-wrap")).length>0)et=[],bt=[],c.find(".VA005-checkbox").prop("checked",!1),t(i.parents(".VA005-uom-wrap")).hasClass("vis-group-selected-op vis-group-selected-opbackground")?(c.find(".VA005-uom-wrap").removeClass("vis-group-selected-op vis-group-selected-opbackground"),ht=t(i.parents(".VA005-uom-wrap")).attr("attr_id"),at=t(i.parents(".VA005-uom-wrap")).attr("upc"),et.splice(et.indexOf(ht),1),bt.splice(bt.indexOf(at),1)):(c.find(".VA005-uom-wrap").removeClass("vis-group-selected-op vis-group-selected-opbackground"),t(i.parents(".VA005-uom-wrap")).addClass("vis-group-selected-op vis-group-selected-opbackground"),t(i.parents(".VA005-uom-wrap")).find(".VA005-checkbox").prop("checked",!0),ht=t(i.parents(".VA005-uom-wrap")).attr("attr_id"),at=t(i.parents(".VA005-uom-wrap")).attr("upc"),et.push(ht),bt.push(at));else return}function ky(n){var t=VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductManagement/LoadUOMRate",{C_UOM_Conversion_ID:n});t!=null&&(bi.val(t.C_UOM_To_ID),wr.setValue(t.DivideRate),pr.setValue(t.MultiplyRate),he.val(t.UPC))}function dy(n){VIS.ADialog.confirm("VA005_DeleteIt",!0,"","Confirm",function(t){if(t==!0){var i=VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductManagement/DeleteConversion",{C_UOM_Conversion_ID:n});i>0?ss():VIS.ADialog.error("VA005_ConversionNotDeleted")}})}function ss(){r[0].style.visibility="visible";rt=[];g=0;a.find(".VA005-uom-wrap").remove();VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductManagement/LoadUomGroup",{M_Product_ID:u[0]},gy)}function gy(n){var i=0,t;if(n!=null)for(t in n){i=i+1;var f=n[t].Name,c=n[t].C_UOM_To_ID,e=n[t].DivideRate,o=n[t].MultiplyRate,u=n[t].C_UOM_Conversion_ID,s=n[t].UPC,h='<div class="VA005-uom-wrap" conversionid = '+u+'><div class="VA005-item-top"><div class="VA005-item-name"><input class="VA005-checkbox" type="checkbox"><label>'+f+'<\/label><\/div><div class="VA005-item-icons"><span id = "VA005_BarCode_'+i+'" ><\/span><span conversionid = '+u+' class="VA005-uom-icons vis vis-delete VA005-icons-color" title="'+VIS.Msg.getMsg("DeleteActivity")+'"><\/span><span conversionid = '+u+' class="VA005-uom-icons vis vis-edit VA005-icons-color" title="'+VIS.Msg.getMsg("Edit")+'"><\/span><span class="VA005-uom-icons fa fa-shopping-cart VA005-icons-color" conversionid = '+u+' title="'+VIS.Msg.getMsg("VA005_AddCart")+'"><\/span><\/div><\/div><div><span class="VA005-multiplier">'+VIS.Msg.getElement(VIS.Env.getCtx(),"MultiplyRate")+" : "+o.toLocaleString()+'<\/span><span class="VA005-divide">'+VIS.Msg.getElement(VIS.Env.getCtx(),"DivideRate")+" : "+e.toLocaleString()+"<\/span><\/div><\/div>";a.append(h);hs(s,a.find("#VA005_BarCode_"+i))}window.setTimeout(function(){r[0].style.visibility="hidden"},60)}function pe(){if(r[0].style.visibility="visible",c.empty(),VIS.Env.getCtx().setContext(i.windowNo,"M_Product_ID",VIS.Utility.Util.getValueOfInt(u[0])),eu=VIS.dataContext.getJSONRecord("VA005/ProductManagement/GetAttributeSet",u[0]),eu>0)VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductManagement/LoadVarients",{M_Product_ID:u[0]},np);else{var n='<div style="float: left;width: 100%;"><span style="font-style:italic;font-weight:bold;">'+VIS.Msg.getMsg("PAttributeNoAttributeSet")+"<\/span><\/div>";c.append(n);r[0].style.visibility="hidden"}}function np(n){var i=0,t;if(n!=null)for(t in n){i=i+1;var u=n[t].UPC,f=n[t].M_AttributeSetInstance_ID,e=n[t].Description,o=n[t].M_ProductAttributes_ID,s='<div class="VA005-uom-wrap" attr_id = '+f+" upc = "+u+'><div class="VA005-item-top"><div class="VA005-item-name"><input class="VA005-checkbox" type="checkbox" ><label>'+e+'<\/label><\/div><div class="VA005-item-icons"><span id = "VA005_BarCode_'+i+'" style="float:left;"><\/span><span attr_id = '+f+' upc = "'+u+'" class="VA005-uom-icons fa fa-shopping-cart VA005-icons-color" title="'+VIS.Msg.getMsg("VA005_AddCart")+'"><\/span><\/div><\/div><div style="float: left;width: 100%;"><span patrid='+o+' class="VA005-Edit-UPC">'+VIS.Msg.getMsg("VA005_EditUPC")+"<\/span><\/div>";c.append(s);hs(u,c.find("#VA005_BarCode_"+i))}window.setTimeout(function(){r[0].style.visibility="hidden"},60)}function sc(){r[0].style.visibility="visible";VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductManagement/GetProductDetails",{M_Product_ID:u[0]},tp)}function tp(n){var i,u;r[0].style.visibility="visible";n.Table[0]!=null&&(de.css("display","flex"),ge.text(n.Table[0].NAME),kf.find("span").remove(),kf.append("<span>"+n.Table[0].UPC+"<\/span>"),df.find("span").remove(),df.append("<span>"+n.Table[0].ATTRIBUTE+"<\/span>"),te.find("span").remove(),te.append("<span>"+n.Table[0].PRODUCTTYPE+"<\/span>"),gf.find("span").remove(),gf.append("<span>"+n.Table[0].PRODUCTCATEGORY+"<\/span>"),ne.find("span").remove(),ne.append("<span>"+n.Table[0].TAXCATEGORY+"<\/span>"),ie.find("span").remove(),ie.append("<span>"+n.Table[0].UOM+"<\/span>"),no.find("span").remove(),no.append("<span>"+n.Table[0].TREE+"<\/span>"),i=n.Table[0].IMAGEURL,i!=null?i!=""?(i=i.substring(i.lastIndexOf("/")+1,i.length),u=new Date,wo.removeAttr("src"),wo.attr("src",VIS.Application.contextUrl+"Images/Thumb140x120/"+i+"?"+u.getTime()),er.empty(),er.append(wo)):(er.empty(),er.append(t('<i style="max-height: 100%; max-width: 100%;" class="vis vis-image" ><\/i>'))):(er.empty(),er.append(t('<i style="max-height: 100%; max-width: 100%;" class="vis vis-image" ><\/i>'))));window.setTimeout(function(){r[0].style.visibility="hidden"},60)}function yl(){r[0].style.visibility="visible";t.ajax({type:"POST",url:VIS.Application.contextUrl+"VA005/ProductManagement/updateVarient",dataType:"json",data:{id:of,UpcCode:yr.val()},success:function(n){var t=n.result;t==""?(oe.popup("hide"),yr.val(""),of=0,pe()):VIS.ADialog.error(t);r[0].style.visibility="hidden"},error:function(n,t){console.log(t);r[0].style.visibility="hidden";alert("RecordNotSaved");return}})}function pl(n){var u=0,i=0,r=t(n.target);r.data("dtype")=="3"&&(u=r.data("nodeid"),i=r.data("parentid"),r.hasClass("VA005-checkbox")?r.prop("checked")?(w[i]||(w[i]=[]),w[i].push(u)):w[i].splice(w[i].indexOf(u),1):t(r.parents(".VA005-attribute")).find(".VA005-checkbox").prop("checked")?(t(r.parents(".VA005-attribute")).find(".VA005-checkbox").prop("checked",!1),w[i].splice(w[i].indexOf(u),1)):(t(r.parents(".VA005-attribute")).find(".VA005-checkbox").prop("checked",!0),w[i]||(w[i]=[]),w[i].push(u)))}function wl(){w={};eu=VIS.dataContext.getJSONRecord("VA005/ProductManagement/GetAttributeSet",u[0]);eu>0?(r[0].style.visibility="visible",t.ajax({url:VIS.Application.contextUrl+"VA005/ProductManagement/AttributeSetListing",type:"Get",data:{AttributeSet_ID:eu},success:function(n){var t=JSON.parse(n),i,u;if(ae=[],dt&&dt.data("kendoTreeView")!=undefined&&(dt.data("kendoTreeView").destroy(),dt.empty()),t!=null){iu.show();for(i in t[0].items)ae.push(t[0].items[i].NodeID)}else{dt.empty();u='<div style="float: left;width: 100%;"><span style="font-style:italic;font-weight:bold;white-space:normal;">'+VIS.Msg.getMsg("VA005_LotSerialAttribute")+"<\/span><\/div>";dt.append(u);iu.hide();r[0].style.visibility="hidden";return}dt.kendoTreeView({dragAndDrop:!1,dataSource:t,template:"<div style='margin:#= item.margin #;float:left' data-parentid='#= item.ParentID #' data-nodeid='#= item.NodeID #' data-dType= '#= item.Type #' class='VA005-attribute'><div style='width:auto;float:left;display: flex;align-items: center;' data-parentid='#= item.ParentID #' data-nodeid='#= item.NodeID #' data-dType= '#= item.Type #'><input type='checkbox' class='VA005-checkbox' style='margin: 0;display:#= item.checkbox #' data-parentid='#= item.ParentID #' data-nodeid='#= item.NodeID #' data-dType= '#= item.Type #'><img src='"+VIS.Application.contextUrl+"#= item.ImageSource #' style='display:#= item.visibility #' data-parentid='#= item.ParentID #' data-nodeid='#= item.NodeID #' data-dType= '#= item.Type #'><p style='border-radius:4px;padding: 5px 10px' data-parentid='#= item.ParentID #' data-nodeid='#= item.NodeID #' data-dType= '#= item.Type #'>#= item.text #<\/p><\/div><\/div>"});window.setTimeout(function(){r[0].style.visibility="hidden"},60);dt.off("click",pl);dt.on("click",pl)},error:function(n){alert(n);r[0].style.visibility="hidden"}})):(wt.hide(),iu.hide(),c.show())}function hs(n,t){var i={output:"css",bgColor:"#FFFFFF",color:"#000000",barWidth:1,barHeight:30,moduleSize:2,addQuietZone:1};n.length==12?t.barcode(n,"ean13",i):n.length==7?t.barcode(n,"ean8",i):n.length==4?t.barcode(n,"code39",i):t.barcode(n,"code128",i)}function ip(){t(this).scrollTop()>0&&t(this).scrollTop()+t(this).innerHeight()+5>=this.scrollHeight&&d<dh&&(r[0].style.visibility="visible",d++,ci(pt.val(),vt,ft.val(),d,tt,0))}function rp(){t(this).scrollTop()>0&&t(this).scrollTop()+t(this).innerHeight()>=this.scrollHeight&&bo<gh&&(r[0].style.visibility="visible",bo++,bu(gi.val(),bo,tt))}function hc(){y.onOkClick=function(n){return VIS.Utility.Util.getValueOfString(br.val())==""?(VIS.ADialog.error("VA005_ProductType"),n!=undefined&&n.preventDefault(),!1):VIS.Utility.Util.getValueOfString(sf.val())==""||VIS.Utility.Util.getValueOfInt(fi.val())==0||VIS.Utility.Util.getValueOfInt(gt.val())==0||VIS.Utility.Util.getValueOfInt(fr.val())==0?(VIS.ADialog.error("FillMandatory"),!1):(gv(),!1)};y.onCancelClick=function(){lf()};lo.on("click",function(n){b.Attribute="Y";b.Category="N";b.Tax="N";b.UOM="N";lo.w2overlay(dr.clone(!0));n.stopPropagation()});ao.on("click",function(n){b.Attribute="N";b.Category="Y";b.Tax="N";b.UOM="N";ao.w2overlay(dr.clone(!0));n.stopPropagation()});vo.on("click",function(n){b.Attribute="N";b.Category="N";b.Tax="Y";b.UOM="N";vo.w2overlay(dr.clone(!0));n.stopPropagation()});yo.on("click",function(n){b.Attribute="N";b.Category="N";b.Tax="N";b.UOM="Y";yo.w2overlay(dr.clone(!0));n.stopPropagation()})}function up(){ei.on("change",function(){r[0].style.visibility="visible";bl()});ri.onOkClick=function(n){return ei.val()==0?(VIS.ADialog.error("VA005_SelectPrice"),n!=undefined&&n.preventDefault(),!1):(ny(),!1)};ri.onCancelClick=function(){ri.close()}}function bl(){l=[];h.clear();or=2;window.setTimeout(function(){if(ei.val()>0){var n=VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductManagement/LoadPriceListData",{M_PriceList_ID:ei.val()});n!=null&&(or=n.PricePrecision,il=n.ISO_Code);kc.text(il);VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductManagement/GetProductPrices",{M_Product_ID:u,PriceList:ei.val()},fp)}else r[0].style.visibility="hidden",l=[]},200)}function fp(n){var f,e,u,s,o;if(n.length>0)for(l=n,w2utils.encodeTags(l),h.add(l),f=0;f<h.records.length;f++)e="",t("#grid_gridprice_"+i.windowNo+"_rec_"+h.records[f].recid).find("input[type=text]").val(l[f].Attribute),u=l[f].ImageUrl,u!=null?u!=""?(u=u.substring(u.lastIndexOf("/")+1,u.length),s=new Date,e='<img alt="" title="" style="opacity:1;" src="'+VIS.Application.contextUrl+"Images/Thumb16x16/"+u+"?"+s.getTime()+'">'):e='<i class= "vis vis-image" ><\/i>':e='<i class= "vis vis-image" ><\/i>',o=f+1,t(t("#grid_gridprice_"+i.windowNo+"_rec_"+o).find("div")[0]).empty(),t(t("#grid_gridprice_"+i.windowNo+"_rec_"+o).find("div")[0]).append(e);r[0].style.visibility="hidden";l=[]}function ep(){rr.onOkClick=function(){if(VIS.Utility.Util.getValueOfString(so.val())==""||VIS.Utility.Util.getValueOfInt(vu.val())==0)return VIS.ADialog.error("FillMandatory"),!1;var t=n.StickerProduct.prototype.create(so.val(),vu.val(),bh);return rr.close(),!1};rr.onCancelClick=function(){al()}}function af(){var n,t;r[0].style.visibility="visible";l=[];n=0;st.clear();n=n+1;t="";VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductManagement/LoadReleatedData",{M_Product_ID:u[0]},op)}function op(n){var i=0,t;if(n!=null)for(t in n)i=i+1,l.push({recid:i,Product:n[t].Product,RelatedProduct:n[t].RelatedProduct,RelatedType:n[t].RelatedProductType,M_Product_ID:n[t].RelatedProduct_ID,updated:!1});w2utils.encodeTags(l);st.add(l);l=[];window.setTimeout(function(){r[0].style.visibility="hidden"},60)}function du(){if(r[0].style.visibility="visible",l=[],s.clear(),it.val()>0)VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductManagement/LoadCartData",{VAICNT_InventoryCount_ID:it.val()},sp);else oi=!1,r[0].style.visibility="hidden"}function sp(n){var e=0,u,f,o;if(n!=null)for(u in n)e=e+1,l.push({recid:e,LineID:n[u].VAICNT_InventoryCountLine_ID,product_ID:n[u].M_Product_ID,Product:n[u].Name,C_Uom_ID:n[u].C_UOM_ID,attribute_ID:n[u].M_AttributeSetInstance_ID,Attribute:n[u].Description,UPC:n[u].UPC,Qty:n[u].VAICNT_Quantity,updated:!1});for(w2utils.encodeTags(l),s.add(l),f=0;f<s.records.length;f++)t("#grid_gridcart_"+i.windowNo+"_rec_"+s.records[f].recid).find("input[type=text]").val(l[f].Attribute),o=VIS.dataContext.getJSONRecord("VA005/ProductManagement/GetAttributeSet",l[f].product_ID),o<=0&&(t("#grid_gridcart_"+i.windowNo+"_rec_"+s.records[f].recid).find("input:not([type='checkbox'])").hide(),t("#grid_gridcart_"+i.windowNo+"_rec_"+s.records[f].recid).find("i").hide());s.selectNone();l=[];oi=!1;r[0].style.visibility="hidden"}function hp(){ki.on("change",function(){r[0].style.visibility="visible";kl()});ui.onOkClick=function(n){return ki.val()==0?(VIS.ADialog.error("VA005_SelectSupplier"),n!=undefined&&n.preventDefault(),!1):(ty(),!1)};ui.onCancelClick=function(){ui.close()}}function kl(){l=[];p.clear();or=2;window.setTimeout(function(){VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductManagement/GetSupplierData",{M_Product_ID:u,Supplier:ki.val()},cp)},200)}function cp(n){n.length>0&&(l=n,w2utils.encodeTags(l),p.add(l));r[0].style.visibility="hidden";l=[]}function lp(){ou.length>0&&t.ajax({async:!1,type:"POST",dataType:"json",contentType:"application/json",url:VIS.Application.contextUrl+"VA005/ProductManagement/DeleteProductImage",data:JSON.stringify({images:ou}),success:function(n){var t=JSON.parse(n);i.GetImages()},error:function(n){console.log(n)}})}function ap(n){r[0].style.visibility="visible";VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductManagement/SetRelatedProduct",{M_Product_ID:u[0],RelatedProduct:n},vp)}function vp(n){n==""?af():(VIS.ADialog.error(n),r[0].style.visibility="hidden")}function dl(n,i,r,u){var f=u.find(".vis-group-user-img");t.ajax({type:"GET",dataType:"json",url:VIS.Application.contextUrl+"VA005/ProductManagement/SaveProductImage",data:{imagePath:n,imageName:i,productID:r},success:function(n){var t=JSON.parse(n),i;t!=null&&(i='<img alt="" title="" style="opacity:1;" src="'+t+'">',f.empty(),f.append(i))},error:function(n){console.log(n)}})}function yp(n,i,u,f,e,o){r[0].style.visibility="visible";var s=f.find("img");t.ajax({type:"GET",dataType:"json",url:VIS.Application.contextUrl+"VA005/ProductManagement/SaveAttributeValueImage",data:{imagePath:n,imageName:i,productID:u,attributeValue:e,attimages_id:o},success:function(n){var t=JSON.parse(n);t!=null&&(s.attr("src",t.urls),s.attr("data-attimages_id",t.imgID),s.css({height:"auto",width:"auto"}));r[0].style.visibility="hidden"},error:function(n){console.log(n);r[0].style.visibility="hidden"}})}function pp(){t.ajax({type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",url:VIS.Application.contextUrl+"VA005/VA005_Tree/GetTreeAsString",data:JSON.stringify({editable:!0}),success:function(n){if(n!=null){var t=JSON.parse(n);si&&si.data("kendoTreeView")!=undefined&&(si.data("kendoTreeView").destroy(),si.empty());ha=si.kendoTreeView({dragAndDrop:!1,dataSource:t,template:"<div class='va005-parentss' id=#= item.NodeID #><div style='float:left'><div  class='va005_mouseover'  style='float:left'><p id=#= item.NodeID #>#= item.text #<\/p><\/div><\/div><\/div>"});si.off("click","p",gl);si.on("click","p",gl)}r[0].style.visibility="hidden";si.css({display:"block","margin-top":"10px",cursor:"pointer",height:"70%",width:"100%"});f.find(".k-treeview .k-icon").css({"background-color":"rgba(var(--v-c-on-secondary), .2)","border-radius":"4px"});f.find(".k-top k-bot").css({"background-color":"rgba(var(--v-c-on-secondary), .2)"});f.find(".k-widget k-treeview").css({height:"70%",position:"absolute"});f.find(".VA005-apanel-lb").css({overflow:"inherit",position:"relative"});si.height(ko)},error:function(n){r[0].style.visibility="hidden";console.log(n)}})}function gl(n){d=1;u=[];k=[];ft.val(0);pt.val("");lt.prop("checked",!1);var i=t(n.target);kr=i.attr("id");vi();wp();ti==!0&&hi.trigger("click");e.find(".vis-group-user-wrap").remove();ci("",0,ft.val(),d,tt,kr)}function wp(){var n=VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductManagement/LoadParentData",{M_Product_ID:kr});n!=null&&(le=n.C_TaxCategory_ID,ce=n.M_Product_Category_ID)}var rc,uc,is,rs,us,fs,el,ol,fc,sl,hl,es,ec,av,cl,ku,oc,lf,we,cs;this.frame;this.windowNo;var i=this,f=t('<div class="vis-group-assign-content vis-forms-container VA005-outermainwrapper" style="height:100%;">'),dr=null,vf,gr,be,ls,yf,cc,yi,ot,pf,sr,as,na=t('<div style="display: inline-block;float:left;height:100%;width:250px;background:rgb(87, 87, 87);">'),ta=null,r=null,ke=null,lc=null,li=null,o=null,hr=null,pt=null,ft=null,wf=null,vs=null,ys=null,di=VIS.DisplayType.GetNumberFormat(VIS.DisplayType.Amount),kt=VIS.Env.isDecimalPoint(),gi=null,ac=null,ps=null,ws=null,e=null,bf=null,bs=null,a=null,cr=null,gu=null,c=null,pi=null,nr=null,nu=null,tu=null,ai=null,de=null,vc=null,ge=null,kf=null,df=null,gf=null,ne=null,te=null,ie=null,no=null,ii=null,tr=null,lr=null,wt=null,dt=null,ir=null,ar=null,y=null,ri=null,ui=null,rr=null,ia=!0,nt=t('<div class="vis-forms-container vis-formouterwrpdiv" style="display:none;"><\/div>'),ks=t('<div style="overflow-y:auto;padding-top: 5px;"><\/div>'),ds=t('<div style="width:100%;height:100%;padding-top: 3px;"><\/div>'),cu=t('<div style="width:100%;height:100%;display:none;"><\/div>'),yc=t('<div style="width:100%;height:100%;"><\/div>'),nf=t('<div style="width:100%;height:100%;display:none;"><\/div>'),gs=t('<div style="width:100%;height:100%;"><\/div>'),nh=t('<div style="width:100%;height:100%;"><\/div>'),re=t('<div style="display:none;"><\/div>'),pc=t('<div style="overflow-y:auto;"><\/div>'),wc=t('<div style="width:100%;height:100%;"><\/div>'),th=null,ih=null,rh,bc,ur=null,vr=null,tf=null,kc=null,uh=null,to=null,fh=null,eh=null,oh=null,ue=null,ra=null,ua=null,sh=null,lt=null,rf=null,lu=null,au=null,uf=null,fe=null,ff=null,ef=null,iu=null,hh=null,ch=null,dc=null,gc=null,lh=null,ee=null,ah=null,io=null,ro=null,vh=null,nl=null,yh=null,ph=null,wh=null,uo=null,fo=null,tl=null,eo=null,oo=null,yr=null,so=null,vu=null,oe=null,of=0,ho=0,ru=null,sf=null,hf=null,se=null,pr=null,wr=null,he=!1,uu=null,br=null,wi=null,fi=null,fr=null,bi=null,gt=null,ei=null,ki=null,fa=null,it=null,co=0,lo=null,ao=null,vo=null,yo=null,bh=[],u=[],k=[],rt=[],et=[],bt=[],ut=0,ni=0,g=0,ht=0,at="",vt=0,yu=0,kr=0,ce=0,le=0,kh=0,dh=0,gh=0,po=null,yt=[],fu=[],l=[],pu=[],cf=0,h=null,p=null,st=null,s=null,er=null,wo=null,d=1,bo=1,tt=50,eu=0,wu=null,ou=[],ea=null,oa=[],sa=[],ae=[],w={},b={Attribute:"N",Tax:"N",Category:"N",UOM:"N"},oi=!1,or=2,il=null,rl=null,nc=!1,ha,si=t("<div>"),ko=0,v=null,ul=null,go=null,ve=null,hi=null,ti=!1,ns=null,fl=null,ts=null,ca=null,ct=null,tc=!1;kv();this.Initialize=function(){la()};this.initData=function(){window.setTimeout(function(){ec();ol();fc();ya();i.GetImages();we();cs();bu(gi.val(),bo,tt);si.css({display:"none"});dv();sy()},200)};rc=function(){ho=VIS.context.getContextAsInt("#AD_Org_ID");uu.empty();VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductManagement/LoadOrganization","",ga)};uc=function(){br.empty();VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductManagement/LoadProductType","",nv)};is=function(){wi.empty();VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductManagement/LoadAttributes","",tv)};rs=function(){fi.empty();VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductManagement/LoadTaxCategories","",iv)};us=function(){gt.empty();VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductManagement/LoadProductCategories","",rv)};fs=function(n){po=n;po.empty();VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductManagement/LoadUOM","",uv)};el=function(){yt=[];yt.push({id:0,text:VIS.Msg.getMsg("Select")});VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductManagement/LoadUOM","",fv)};ol=function(){fu=[];fu.push({id:0,text:VIS.Msg.getMsg("Select")});VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductManagement/LoadCurrency","",ev)};fc=function(){bi.empty();VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductManagement/LoadUOM","",ov)};sl=function(){ei.empty();VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductManagement/LoadPriceList","",sv)};hl=function(){ki.empty();VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductManagement/LoadSupplier","",hv)};es=function(){it.empty();VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductManagement/LoadCart","",cv)};ec=function(){ft.empty();VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductManagement/LoadQueries","",lv)};av=function(){nc=VIS.Utility.Util.getValueOfInt(VIS.DB.executeScalar("SELECT COUNT(*) FROM AD_MODULEINFO WHERE PREFIX='DTD001_' "))};cl=function(n){VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductManagement/LoadOnCategorySelect",{ProdCatID:n},vv)};ku=function(n,t){var r=VIS.dataContext.getJSONRecord("VA005/ProductManagement/GetWindow_ID",t),i;try{r>0&&(i=new VIS.Query,t=="Product"?i.addRestriction("M_Product_ID",VIS.Query.prototype.EQUAL,n):t=="Attribute Set"?i.addRestriction("M_AttributeSet_ID",VIS.Query.prototype.EQUAL,n):t=="Product Category"?i.addRestriction("M_Product_Category_ID",VIS.Query.prototype.EQUAL,n):t=="Tax Category"?i.addRestriction("C_TaxCategory_ID",VIS.Query.prototype.EQUAL,n):t=="Unit of Measure"?i.addRestriction("C_Uom_ID",VIS.Query.prototype.EQUAL,n):t=="VAICNT_InventoryCount"?i.addRestriction("VAICNT_InventoryCount_ID",VIS.Query.prototype.EQUAL,n):t=="Vendor Master"&&i.addRestriction("C_BPartner_ID",VIS.Query.prototype.EQUAL,n),i.setRecordCount(1),VIS.viewManager.startWindow(r,i),y!=null&&y.close())}catch(u){console.log(u)}};oc=function(){VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductManagement/LoadProductData",{M_Product_ID:u[0]},oy)};lf=function(){uu.val(ho);sf.val("");hf.val("");fr.val(-1);wi.val(-1);gt.val(ce);br.val("I");fi.val(le);se.val("");yu=0};this.GetImages=function(){t.ajax({type:"GET",dataType:"json",url:VIS.Application.contextUrl+"VA005/ProductManagement/GetImages",success:function(n){var i=JSON.parse(n),t;for(ou=[],wu.children().remove(),t=0;t<i.length;t++)wu.append("<li filename='"+i[t].ImageDetail.fileName+"' path='"+i[t].ImageDetail.filePath+"'><img src="+i[t].ImageDetail.fileBase64Data+" ><\/li>");we()},error:function(n){console.log(n)}})};we=function(){f.find(".VA005-productimgul li").draggable({revert:"invalid",containment:"document",helper:"clone",cursor:"move",cursorAt:{left:-10,down:-5},start:function(n,t){t.helper.animate({width:80,height:50})}});f.find(".vis-group-users-container .vis-group-user-wrap").droppable({drop:function(n,i){dl(t(i.draggable).attr("path"),t(i.draggable).attr("filename"),parseInt(t(this).attr("data-uid")),t(this))},tolerance:"pointer"})};cs=function(){e.find(".vis-group-user-profile").draggable({start:function(n,t){t.helper.css("width",rl);t.helper.addClass("VA005-dragging")},stop:function(n,t){t.helper.removeClass("VA005-dragging")},cursor:"move",cursorAt:{left:5},revert:"invalid",helper:"clone"});ai.droppable({hoverClass:"VA005-dropping",drop:function(n,i){t(i.draggable).data("uid")>0&&ap(t(i.draggable).data("uid"))}})};this.getRoot=function(){return f};this.setSize=function(n){vf.height(n);gr.height(n);sr.height(n);ot.height(sr.height()-43);ko=ot.height()-f.find(".VA005-Serach-Query").height()*2-30;si.height(ko);v.parent().height(li.height()-(f.find(".vis-group-users-container").height()+130));v.height(li.height()-(f.find(".vis-group-users-container").height()+130))};this.refreshUI=function(){st&&st.resize();s&&s.resize()};this.disposeComponent=function(){i=null;f&&f.remove();f=null;dr=null;vf=null;gr=be=ls=yf=yi=ot=pf=null;sr=null;as=null;na=null;ta=null;r=null;ke=null;li=null;o=null;hr=null;pt=null;ft=null;ps=null;ws=null;e=null;bf=null;bs=null;a=null;cr=null;gu=null;c=null;wt=null;dt=null;ir=null;ar=null;pi=null;nu=null;tu=null;de=null;ge=null;kf=null;df=null;gf=null;ne=null;te=null;ie=null;ii=null;tr=null;lr=null;y=null;ri=null;ui=null;ia=null;nt=null;ks=null;cu=null;nf=null;gs=null;nh=null;th=null;ih=null;rh=bc=null;ur=null;vr=null;tf=null;uh=null;to=null;fh=null;eh=null;oh=null;ue=null;btnProdCart=null;ra=null;ua=null;sh=null;lt=null;rf=null;lu=null;au=null;fe=null;ff=null;ef=null;iu=null;hh=null;ch=null;lh=null;ee=null;ah=null;ro=null;io=null;eo=null;vh=null;yh=null;wh=null;ph=null;uo=null;fo=null;oo=null;ru=null;sf=null;hf=null;se=null;pr=null;wr=null;he=!1;uu=null;br=null;wi=null;fi=null;fr=null;bi=null;gt=null;ei=null;ki=null;fa=null;it=null;lo=null;ao=null;vo=null;yo=null;u=[];k=[];rt=[];et=[];bt=[];ut=null;ni=null;g=null;ht=null;at=null;vt=null;kh=null;dh=null;gh=null;wu=null;ou=[];ea=null;yt=null;fu=null;l=[];cf=0;h=null;p=null;s=null;this.getRoot=null;this.disposeComponent=null;eu=null;oa=[];sa=[];yr=null;oe=null;of=0;ho=null;b=null}};n.ProductMgtForm.prototype.refresh=function(){this.refreshUI()};n.ProductMgtForm.prototype.init=function(n,t){this.frame=t;this.windowNo=n;t.setTitle("VA005_ProductMgt");window.setTimeout(function(n){n.Initialize();n.initData()},10,this);this.frame.getContentGrid().append(this.getRoot())};n.ProductMgtForm.prototype.dispose=function(){this.disposeComponent();this.frame&&this.frame.dispose();this.frame=null};n.ProductMgtForm.prototype.sizeChanged=function(n,t){this.setSize(n,t)};n.updateProductPanel=function(n,i,r,u){function rt(){o=h.find("#VA005_drpColumn_"+f.windowNo);divValue1=h.find("#VA005_divValue1_"+f.windowNo);y=h.find("#VA005_btnSave_"+f.windowNo);p=h.find("#VA005_tblQry_"+f.windowNo);b=p.find("tbody")}function ut(){VIS.AEnv.getGridWindow(f.windowNo,i,function(n){var a,e,c,s,i,h,u;if(n.error!=null){VIS.ADialog.error(n.error);return}if(a=t.parseJSON(n.result),VIS.context.setContextOfWindow(t.parseJSON(n.wCtx),f.windowNo),e=new VIS.GridWindow(a),e!=null){if(e.getTabs().length>0)for(item in e.getTabs())if(e.getTabs()[item].gridTable.AD_Table_ID==r){k=e.getTabs()[item];break}if(k!=null){for(l=k.getFields().sort(st),c='<option value="-1"> <\/option>',s=0;s<l.length;s++)if(i=l[s],!i.getIsEncrypted()){if(h=i.getColumnName(),i.getDisplayType()==VIS.DisplayType.Button){if(i.getAD_Reference_Value_ID()==0)continue;h.endsWith("_ID")?i.setDisplayType(VIS.DisplayType.Table):i.setDisplayType(VIS.DisplayType.List)}(u=i.getHeader(),u!=null&&u.length!=0||(u=VIS.Msg.getElement(VIS.context,h),u!=null&&u.Length!=0))&&(i.getIsKey()&&(u+=" (ID)"),c+='<option value="'+h+'">'+u+"<\/option>")}o.html(c);v(!1)}}})}function ft(){o.on("change",function(){var n=o.val(),t;it(!0);n&&n!="-1"&&(t=ht(n),yt(!0,t),vt(y,!0));at(!0)});p.on("click",function(n){if(n.target.nodeName==="I"){var i=t(n.target).data("index");s.splice(i,1);tt(s)}});y.on("click",nt)}function et(n){v(!0);nt();s&&t.ajax({type:"POST",url:VIS.Application.contextUrl+"VA005/ProductManagement/UpdateProduct",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify({prodIDs:u,ColumnName:s}),async:!1,success:function(t){var i=t.result;f.okBtnPressed=!0;i!=""&&(VIS.ADialog.error("","",i,""),n(i));v(!1)},error:function(n,t){console.log(t);v(!1);alert("RecordNotSaved");f.okBtnPressed=!1;return}})}function nt(){var t=o.val(),n,i;return!t||t=="-1"?!1:(n=o.find("option:selected").text(),i="",n==null||n.trim().length==0)?!1:(i=t.toString(),ot(n,i,lt(!0),ct(!0)),o[0].selectedIndex=0,it(!0),!0)}function ot(n,t,i,r){s==null&&(s=[]);var u={};u.KEYNAME=n;u.KEYVALUE=t;u.VALUE1NAME=i;u.VALUE1VALUE=i==""?"":r==null?"NULL":VIS.Utility.Util.getValueOfString(r);s.push(u);tt(s)}function st(n,t){var i=n.vo.Header.toLowerCase(),r=t.vo.Header.toLowerCase();return i==""&&(i=n.vo.ColumnName.toLowerCase()),r==""&&(r=t.vo.ColumnName.toLowerCase()),i<r?-1:i>r?1:0}function tt(n){var i,f;b.empty();var u="",r="",t=null;if(n)for(i=0,f=n.length;i<f;i++)r='<tr class="vis-advancedSearchTableRow">',t=n[i],r+="<td>"+t.KEYNAME+'<\/td><td style="display:none">'+t.KEYVALUE+"<\/td><td>"+t.VALUE1NAME+'<\/td><td style="display:none">'+t.VALUE1VALUE+'<\/td><td><i style="cursor:pointer" data-index = "'+i+'" class="vis vis-delete"><\/i><\/td>',r+="<\/tr>",u+=r;b.html(u)}function ht(n){var t,i;if(n==null||n.length==0)return null;for(t=0;t<l.length;t++)if(i=l[t],n.equals(i.getColumnName()))return i;return null}function ct(n){var t=null;return(n&&(t=a),t!=null)?t.getDisplayType()==VIS.DisplayType.YesNo?t.getValue().toString().toLowerCase()=="true"?"Y":"N":t.getValue():""}function lt(n){var t=null;return(n&&(t=a),t!=null)?t.getDisplay():""}function it(n){var t=null;n&&(t=a);t!=null&&t.setValue(null)}function at(n){var r=divValue1.children()[1],i=null;divValue1.children().length>2&&(i=divValue1.children()[2]);i?t(i).prop("disabled",!n).prop("readonly",!n):r!=null&&t(r).prop("disabled",!n).prop("readonly",!n)}function vt(n,t){n.prop("disabled",!t)}function yt(n,i){var u,e,r,f;n&&(a=null);g=null;u=null;e=null;n&&(u=divValue1.children()[1],divValue1.children().length>2&&(e=divValue1.children()[2]));u!=null&&(t(u).remove(),e!=null&&t(e).remove(),u=null);r=null;r=i!=null?i.getIsKey()?new VIS.Controls.VNumTextBox(i.getColumnName(),!1,!1,!0,i.getDisplayLength(),i.getFieldLength(),i.getColumnName()):VIS.VControlFactory.getControl(null,i,!0,!0,!1):new VIS.Controls.VTextBox("columnName",!1,!0,!1,20,20,"format","GetObscureType",!1);r!=null&&(r.setReadOnly(!1),VIS.DisplayType.Text==i.getDisplayType()||VIS.DisplayType.TextLong==i.getDisplayType()?(r.getControl().attr("rows","1"),r.getControl().css("width","100%")):VIS.DisplayType.YesNo==i.getDisplayType()?r.getControl().css("clear","both"):VIS.DisplayType.IsDate(i.getDisplayType())&&r.getControl().css("line-height","1"),f=null,r.getBtnCount()>0&&!(r instanceof VIS.Controls.VComboBox)&&(f=r.getBtn(0)),n&&(divValue1.append(r.getControl()),a=r,f&&(divValue1.append(f),r.getControl().css("width","calc(100% - 30px)"),f.css("max-width","35px"))))}function pt(){w=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"><\/i><\/div><\/div>');c.append(w)}function v(n){isBusy=n;w.css("visibility",isBusy?"visible":"hidden")}function wt(){e.onOkClick=function(){return d=!0,et(bt),d};e.onCancelClick=function(){f.okBtnPressed=!1;e.close()}}function bt(n){n==""?e.close():d=!1}function kt(){o.off("change");p.off("click");y.off("click")}var h=t('<div style="height:100%">'),c=t('<div style="height:100%">'),w=null;this.windowNo=n;var f=this,e=null,d=!0,y,o,p,b,k=null,l=null,a,g,s=null;this.okBtnPressed=!1;c.append(h);pt();v(!0);h.load(VIS.Application.contextUrl+"VA005/ProductManagement/Index/?windowNo="+f.windowNo,function(){rt();ut();ft()});this.show=function(){v(!0);e=new VIS.ChildDialog;e.setHeight(550);e.setWidth(600);e.setTitle(VIS.Msg.getMsg("VA005_UpdateProduct"));e.setModal(!0);e.onClose=function(){f.onClose&&f.onClose()};e.show();e.setContent(c);wt()};this.disposeComponent=function(){kt();y=null;o=null;c&&c.remove();c=null;s=null;a=g=null;w=null;this.windowNo=null;f=null;e=null;p=b=null;k=null;l=null;this.okBtnPressed=null}};n.updateProductPanel.prototype.dispose=function(){this.disposeComponent()}}(VA005,jQuery);VA005=window.VA005||{},function(n,t){n.ProductCategoryForm=function(){function fr(){wr();n.css("width","100%");n.css("height","100%");n.css("position","relative");n.load(VIS.Application.contextUrl+"VA005/ProductCategory/Index?windowno="+r.windowNo,function(){er()})}function er(){n.find(".VA005-report-tittle").text(VIS.Msg.getElement(VIS.Env.getCtx(),"M_Product_Category_ID"));n.find(".VA005-form-top-fields h4").text(VIS.Msg.getElement(VIS.Env.getCtx(),"M_Product_Category_ID"));n.find("#VA005_Value_"+r.windowNo).text(VIS.Msg.getElement(VIS.Env.getCtx(),"Value"));n.find("#VA005_ProductType_"+r.windowNo).text(VIS.Msg.getElement(VIS.Env.getCtx(),"ProductType")).append("<sup class='.VA005-sup'>*<\/sup>");n.find("#VA005_Attribute_"+r.windowNo).text(VIS.Msg.getElement(VIS.Env.getCtx(),"M_AttributeSet_ID"));n.find("#VA005_MatPol_"+r.windowNo).text(VIS.Msg.getElement(VIS.Env.getCtx(),"MMPolicy"));n.find("#VA005_TaxCat_"+r.windowNo).text(VIS.Msg.getElement(VIS.Env.getCtx(),"C_TaxCategory_ID"));n.find("#VA005_AstGrp_"+r.windowNo).text(VIS.Msg.getElement(VIS.Env.getCtx(),"A_Asset_Group_ID"));n.find(".VA005-effect-on").text(VIS.Msg.getMsg("VA005_multiOn"));n.find(".VA005-effect-off").text(VIS.Msg.getMsg("VA005_multiOff"));n.find("#btnZoomWindow_"+r.windowNo).attr("title",VIS.Msg.getMsg("VA005_Zoom"));n.find("#btnRefresh_"+r.windowNo).attr("title",VIS.Msg.getMsg("VA005_Refresh"));at=n.find("#VA005_zoomWindow_"+r.windowNo);hi=n.find("#divLeft_"+r.windowNo);et=n.find("#divRight_"+r.windowNo);i=n.find("#VA005_ProductCategory_"+r.windowNo);kt=n.find("#VA005_AddCategory_"+r.windowNo);f=n.find("#btnSave_"+r.windowNo);lt=n.find("#btnClose_"+r.windowNo);nt=n.find("#btnDelete_"+r.windowNo);w=n.find("#btnMultiple_"+r.windowNo);e=n.find("#btnUndo_"+r.windowNo);ni=n.find("#btnZoom_"+r.windowNo);vt=n.find("#btnAttributeSet_"+r.windowNo);yt=n.find("#btnTaxCategory_"+r.windowNo);pt=n.find("#btnAssetGroup_"+r.windowNo);c=n.find("#txtName_"+r.windowNo);tt=n.find("#txtValue_"+r.windowNo);it=n.find("#txtDesc_"+r.windowNo);b=n.find("#cmbProductType_"+r.windowNo);rt=n.find("#cmbMatPolicy_"+r.windowNo);k=n.find("#cmbAttributeSet_"+r.windowNo);d=n.find("#cmbTaxCategory_"+r.windowNo);g=n.find("#cmbAssetGroup_"+r.windowNo);v=n.find("#IsConsumable_"+r.windowNo);wt=n.find("#lblConsumable_"+r.windowNo);wt.text(VIS.Msg.getElement(VIS.Env.getCtx(),"DTD001_IsConsumable"));ot=n.find("#fileUpload_"+r.windowNo);ut=n.find("#imgUsrImage_"+r.windowNo);bi=n.find("#lblfileUpload_"+r.windowNo);st=n.find("#chkMultiple_"+r.windowNo);w.hide();bt++;b.val()!="I"&&(v.css({display:"none"}),wt.css({display:"none"}));nr(bt,li);ki();vi();yi();or();sr();i.find("li:eq(1) .VA005-cat-caption").addClass("VA005-highlighted");ft(i.find("li:eq(1)").attr("procatid"));e.attr("disabled","disabled").css("opacity",.6);f.attr("disabled","disabled").css("opacity",.6);nt.attr("disabled","disabled").css("opacity",.6);ni.attr("title",VIS.Msg.getMsg("VA005_Zoom"));ar();s[0].style.visibility="hidden"}function hr(n){if(k.append(" <option value = 0><\/option>"),n.length>0)for(var t=0;t<n.length;t++)key=VIS.Utility.Util.getValueOfInt(n[t].M_AttributeSet_ID),value=VIS.Utility.encodeText(n[t].Name),k.append(" <option value="+key+">"+value+"<\/option>")}function cr(n){if(d.append(" <option value = 0><\/option>"),n.length>0)for(var t=0;t<n.length;t++)key=VIS.Utility.Util.getValueOfInt(n[t].C_TaxCategory_ID),value=VIS.Utility.encodeText(n[t].Name),d.append(" <option value="+key+">"+value+"<\/option>")}function lr(n){if(g.append(" <option value = 0><\/option>"),n.length>0)for(var t=0;t<n.length;t++)key=VIS.Utility.Util.getValueOfInt(n[t].A_Asset_Group_ID),value=n[t].Name,g.append(" <option value="+key+">"+value+"<\/option>")}function yr(n){var t,i;if(n.length>0){for(t=0;t<n.length;t++)ct=n[t].Name,ii=n[t].Value,ri=n[t].M_AttributeSet_ID,ui=n[t].ProductType,ei=n[t].MMPolicy,fi=n[t].Description,oi=n[t].C_TaxCategory_ID,si=n[t].A_Asset_Group_ID,ht=n[t].AD_Image_ID,o=n[t].ImageUrl,c.val(ct),tt.val(ii),it.val(fi),k.val(ri),b.val(ui),rt.val(ei),d.val(oi),g.val(si),ai=="Y"?v.prop("checked",!0):v.prop("checked",!1),o!=""?(o=o.substring(o.lastIndexOf("/")+1,o.length),i=new Date,ut.removeAttr("src").attr("src",VIS.Application.contextUrl+"Images/Thumb140x120/"+o+"?"+i.getTime())):ut.removeAttr("src").attr("src",""),e.attr("disabled","disabled").css("opacity",.6),f.attr("disabled","disabled").css("opacity",.6);s[0].style.visibility="hidden"}}function pr(n){var t,r;if(n.length>0)for(t=0;t<n.length;t++)y=n[t].Name,u=n[t].M_Product_Category_ID,o=n[t].ImageUrl,o!=""?(o=o.substring(o.lastIndexOf("/")+1,o.length),r=new Date,i.append("<li class='VA005-pro-cat' procatID="+u+"><div procatID="+u+" class='VA005-cat-img'><img procatID="+u+" style='height: 100%;width: 100%;' src='"+VIS.Application.contextUrl+"Images/Thumb140x120/"+o+"?"+r.getTime()+"'> <\/div> <div class='VA005-cat-caption'> <input type='checkbox' class='VA005-catboxcheck'><p procatID="+u+" > "+y+" <\/p> <p style='display:none;width:100%;'><input procatID="+u+" type='text' value='"+y+"'><\/p><\/div><\/li>")):i.append("<li class='VA005-pro-cat' procatID="+u+"><div procatID="+u+" class='VA005-cat-img'><img procatID="+u+" style='height: 100%;width: 100%;' src=''> <\/div> <div class='VA005-cat-caption'><input type='checkbox' class='VA005-catboxcheck'> <p procatID="+u+"> "+y+" <\/p> <p style='display:none;width:100%;'><input procatID="+u+" type='text' value='"+y+"'><\/p><\/div><\/li>")}function wr(){s=t('<div class="vis-busyindicatorouterwrap" style="visibility: hidden;"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"><\/i><\/div><\/div>');s[0].style.visibility="visible";n.append(s)}var vi,yi;this.frame;this.windowNo;var r=this,n=t("<div class='vis-forms-container'>"),i=null,kt=null,s=null,hi=null,et=null,y="",u=0,p=0,dt=0,gt="",o=null,tr=null,ci=0,ct="",h=null,f=null,lt=null,nt=null,w=null,vt=null,yt=null,pt=null,e=null,ni=null,c=null,tt=null,it=null,b=null,rt=null,k=null,d=null,g=null,ir=null,rr=null,v=null,wt=null,ot=null,ut=null,bi=null,ur=null,st=null,ti=!1,ht=0,bt=0,li=50,a=[],ii="",ri=0,ui="",fi="",ei="",oi=0,si=0,ai="",at=null,l={Attribute:"N",Tax:"N",Asset:"N"};var or=function(){b.append('<option value="E">'+VIS.Msg.getMsg("VA005_Expense")+'<\/option><option selected="selected" value="I">'+VIS.Msg.getMsg("VA005_Item")+'<\/option><option value="R">'+VIS.Msg.getMsg("VA005_Resource")+'<\/option><option value="S">'+VIS.Msg.getMsg("VA005_Service")+"<\/option>")},sr=function(){rt.append('<option value="F">'+VIS.Msg.getMsg("VA005_Fifo")+'<\/option><option selected="selected" value="L">'+VIS.Msg.getMsg("VA005_Lifo")+"<\/option>")},ki=function(){k.empty();VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductCategory/LoadAttribut","",hr)};vi=function(){d.empty();VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductCategory/LoadTaxCategory","",cr)};yi=function(){g.empty();VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductCategory/LoadAssetGroup","",lr)};var ar=function(){function n(n,t){var r={to:i.find("li:eq(1)"),className:"wsp-ui-effects-transfer"};n.effect("transfer",r,600,t)}if(b.change(function(){b.val()=="I"?(v.css({display:"block"}),wt.css({display:"block"})):(v.css({display:"none"}),wt.css({display:"none"}),v.prop("checked",!1));e.removeAttr("disabled").css("opacity",1);f.removeAttr("disabled").css("opacity",1)}),ot!=null)ot.on("change",function(){ut.show();var t=ot[0].files[0],n=new FileReader;return n.onload=function(n){ut.removeAttr("src").attr("src",n.target.result)},n.readAsDataURL(t),ti=!0,e.removeAttr("disabled").css("opacity",1),f.removeAttr("disabled").css("opacity",1),n=null,t=null,!1});c.change(function(){e.removeAttr("disabled").css("opacity",1);f.removeAttr("disabled").css("opacity",1)});it.change(function(){e.removeAttr("disabled").css("opacity",1);f.removeAttr("disabled").css("opacity",1)});tt.change(function(){e.removeAttr("disabled").css("opacity",1);f.removeAttr("disabled").css("opacity",1)});c.on("keydown",function(){e.removeAttr("disabled").css("opacity",1);f.removeAttr("disabled").css("opacity",1)});it.on("keydown",function(){e.removeAttr("disabled").css("opacity",1);f.removeAttr("disabled").css("opacity",1)});tt.on("keydown",function(){e.removeAttr("disabled").css("opacity",1);f.removeAttr("disabled").css("opacity",1)});if(k.change(function(){e.removeAttr("disabled").css("opacity",1);f.removeAttr("disabled").css("opacity",1)}),g.change(function(){e.removeAttr("disabled").css("opacity",1);f.removeAttr("disabled").css("opacity",1)}),rt.change(function(){e.removeAttr("disabled").css("opacity",1);f.removeAttr("disabled").css("opacity",1)}),d.change(function(){e.removeAttr("disabled").css("opacity",1);f.removeAttr("disabled").css("opacity",1)}),v.change(function(){e.removeAttr("disabled").css("opacity",1);f.removeAttr("disabled").css("opacity",1)}),i!=null){i.on("click","li",function(r){if(h=t(this),h.is(":first-child"))vr(),n(h);else{var f=t(r.target);if(u=h.find("input[type=text]").attr("procatID"),p=h.find("p").attr("procatID"),gt=h.find("p[procatid='"+p+"']").text(),f.hasClass("VA005-catboxcheck"))f.prop("checked")?(window.setTimeout(function(){i.find("li[procatid='"+p+"'] .VA005-cat-caption").addClass("VA005-catboxchecked VA005-highlighted")},200),a.push(p),a.length==1&&nt.removeAttr("disabled").css("opacity",1)):(window.setTimeout(function(){i.find("li[procatid='"+p+"'] .VA005-cat-caption").removeClass("VA005-catboxchecked VA005-highlighted")},200),a.splice(a.indexOf(p),1),a.length==0&&nt.attr("disabled","disabled").css("opacity",.6));else if(st.prop("checked"))if(f.length>0)i.find(".VA005-catboxcheck").prop("checked",!1),f.hasClass("VA005-highlighted")?(i.find("li[procatid='"+p+"'] .VA005-cat-caption").removeClass("VA005-highlighted"),a.splice(a.indexOf(p),1)):(f.addClass("VA005-highlighted"),f.find(".VA005-catboxcheck").prop("checked",!0),a.push(p));else return;else dt!=u&&(dt=u,ft(u)),i.find("li[procatid='"+p+"'] .VA005-cat-caption").hasClass("VA005-highlighted")?wi(!0,h):(i.find("li .VA005-cat-caption").removeClass("VA005-highlighted VA005-catboxchecked"),i.find(".VA005-catboxcheck").prop("checked",!1),a=[],f.addClass("VA005-highlighted"),f.find(".VA005-catboxcheck").prop("checked",!0),a.push(p),nt.removeAttr("disabled").css("opacity",1))}});i.on("keydown","input[type=text]",function(n){(n.keyCode==13||n.keyCode==9)&&(h!=null&&(wi(!1,h),y=n.target.value,u=t(n.target).attr("procatID"),gt!=y&&(di(u,y,h),ft(u))),h=null)});i.on("focusout","input[type=text]",function(){h!=null&&(wi(!1,h),y=event.target.value,u=t(event.target).attr("procatID"),gt!=y&&(di(u,y,h),ft(u)));h=null});hi.on("scroll",function(){t(this).scrollTop()+t(this).innerHeight()>=this.scrollHeight&&(bt++,nr(bt,li))})}if(f!=null)f.on("click",function(){if(VIS.Utility.Util.getValueOfString(c.val())==""){VIS.ADialog.error("VA005_FieldMandatory");return}if(VIS.Utility.Util.getValueOfString(b.val())==""){VIS.ADialog.error("VA005_ProductType");return}if(s[0].style.visibility="visible",ti){var r=new XMLHttpRequest,n=new FormData;n.append("file",ot[0].files[0]);n.append("isDatabaseSave",!1);n.append("ad_image_id",ht);r.open("POST",VIS.Application.contextUrl+"ProductCategory/SaveImage",!0);r.send(n);r.addEventListener("load",function(n){var r=n.target.response;r=JSON.parse(r);ht=r.result;t.ajax({type:"POST",url:VIS.Application.contextUrl+"ProductCategory/Update1",dataType:"json",data:{id:u,Name:c.val(),Value:tt.val(),ProductType:b.val(),MatPolicy:rt.val(),Desc:it.val(),attrSet:VIS.Utility.Util.getValueOfInt(k.val()),taxcat:VIS.Utility.Util.getValueOfInt(d.val()),assetGrp:VIS.Utility.Util.getValueOfInt(g.val()),consumable:v.prop("checked"),imageId:ht},success:function(n){var f=n.result,t,r;if(f){if(ti=!1,i!=null){var e=i.find("input[procatid='"+u+"']"),o=i.find("p[procatid='"+u+"']"),h=i.find("img[procatid='"+u+"']");e.attr("value",c.val());o.text(c.val());t=VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductCategory/GetimgUrl",{ad_image_id:ht});t!=""&&(t=t.substring(t.lastIndexOf("/")+1,t.length),r=new Date,h.removeAttr("src").attr("src",VIS.Application.contextUrl+"Images/Thumb140x120/"+t+"?"+r.getTime()))}ft(u)}s[0].style.visibility="hidden"},error:function(n,t){console.log(t);s[0].style.visibility="hidden";alert("RecordNotSaved");return}})},!0)}else t.ajax({type:"POST",url:VIS.Application.contextUrl+"ProductCategory/Update1",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify({id:u,Name:c.val(),Value:tt.val(),ProductType:b.val(),MatPolicy:rt.val(),Desc:it.val(),attrSet:VIS.Utility.Util.getValueOfInt(k.val()),taxcat:VIS.Utility.Util.getValueOfInt(d.val()),assetGrp:VIS.Utility.Util.getValueOfInt(g.val()),consumable:v.prop("checked"),imageId:ht}),success:function(n){var f=n.result,t,r;f&&(i!=null&&(t=i.find("input[procatid='"+u+"']"),r=i.find("p[procatid='"+u+"']"),t.attr("value",c.val()),r.text(c.val())),ft(u));s[0].style.visibility="hidden"},error:function(n,t){console.log(t);s[0].style.visibility="hidden";alert("RecordNotSaved");return}});e.attr("disabled","disabled").css("opacity",.6);f.attr("disabled","disabled").css("opacity",.6)});if(nt!=null)nt.on("click",function(){var n=[];a.length>0&&VIS.ADialog.confirm("VA005_DeleteIt",!0,"","Confirm",function(r){r==!0&&(s[0].style.visibility="visible",t.ajax({type:"POST",url:VIS.Application.contextUrl+"ProductCategory/DeleteCategory",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify({pcats:a}),success:function(t){var r,u;if(t.result.length>0){for(r=0;r<t.result.length;r++)t.result[r].Name!=""?n.push(t.result[r].Name):(u=i.find("li[procatid='"+t.result[r].Key+"']"),u.remove(),gi());n!=""&&VIS.ADialog.error("VA005_ProductCategory",!0,n.join(", "))}},error:function(n,t){console.log(t);s[0].style.visibility="hidden";alert("RecordNotSaved");return}}),a=[],nt.attr("disabled","disabled").css("opacity",.6),i.find(".VA005-catboxcheck").prop("checked",!1),i.find("li .VA005-cat-caption").removeClass("VA005-catboxchecked"),i.find("li .VA005-cat-caption").removeClass("VA005-highlighted"),i.find("li:eq(1) .VA005-cat-caption").addClass("VA005-highlighted"),ft(i.find("li:eq(1)").attr("procatid")))});s[0].style.visibility="hidden"});if(w!=null)w.on("click",function(){w.hasClass("VA005-btn-Multiple-on")?(w.removeClass("VA005-btn-Multiple-on"),w.addClass("VA005-btn-Multiple"),a=[],st.prop("checked",!1),i.find("li:eq(0)").show(),f.show(),e.show(),et.animate({width:"39%"},500),et.css("padding","15px 0 15px 15px"),i.find("li .VA005-cat-caption").removeClass("VA005-highlighted"),t(".VA005-effect-off").fadeIn(),t(".VA005-effect-off").fadeOut(2e3),i.find("li:eq(1) .VA005-cat-caption").addClass("VA005-highlighted"),ft(i.find("li:eq(1)").attr("procatid"))):(w.removeClass("VA005-btn-Multiple"),w.addClass("VA005-btn-Multiple-on"),st.prop("checked",!0),gi(),dt=0,i.find("li:eq(0)").hide(),f.hide(),e.hide(),et.animate({width:"0%"},500),et.css("padding","0"),t(".VA005-effect-on").fadeIn(),t(".VA005-effect-on").fadeOut(2e3))});if(e!=null)e.on("click",function(){if(s[0].style.visibility="visible",c.val(ct),tt.val(ii),it.val(fi),k.val(ri),b.val(ui),rt.val(ei),d.val(oi),g.val(si),ai=="Y"?v.prop("checked",!0):v.prop("checked",!1),o!=""){o=o.substring(o.lastIndexOf("/")+1,o.length);var n=new Date;ut.removeAttr("src").attr("src",VIS.Application.contextUrl+"Images/Thumb140x120/"+o+"?"+n.getTime())}else ut.removeAttr("src").attr("src","");ot.val("");e.attr("disabled","disabled").css("opacity",.6);f.attr("disabled","disabled").css("opacity",.6);s[0].style.visibility="hidden"});if(vt!=null)vt.on("click",function(n){l.Attribute="Y";l.Asset="N";l.Tax="N";vt.w2overlay(at.clone(!0));n.stopPropagation()});if(yt!=null)yt.on("click",function(n){l.Attribute="N";l.Asset="N";l.Tax="Y";yt.w2overlay(at.clone(!0));n.stopPropagation()});if(pt!=null)pt.on("click",function(n){l.Attribute="N";l.Asset="Y";l.Tax="N";pt.w2overlay(at.clone(!0));n.stopPropagation()});if(ni!=null)ni.on("click",function(){var t=VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductCategory/LoadWindow",{windowName:"Product Category"}),n;try{t>0&&(n=new VIS.Query,n.addRestriction("M_Product_Category_ID",VIS.Query.prototype.EQUAL,VIS.Utility.Util.getValueOfInt(u)),n.setRecordCount(1),VIS.viewManager.startWindow(t,n))}catch(i){console.log(i)}});if(lt!=null)lt.on("click",function(){r.dispose()});if(at!=null)at.on("click","LI",function(n){var i=t(n.target).data("action");i==VIS.Actions.refresh?l.Attribute=="Y"?ki():l.Tax=="Y"?vi():l.Asset=="Y"&&yi():i==VIS.Actions.zoom&&(l.Attribute=="Y"?pi(VIS.Utility.Util.getValueOfInt(k.val()),"Attribute Set"):l.Tax=="Y"?pi(VIS.Utility.Util.getValueOfInt(d.val()),"Tax Category"):l.Asset=="Y"&&pi(VIS.Utility.Util.getValueOfInt(g.val()),"Asset Group"))})},pi=function(n,t){var r=VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductCategory/LoadWindow",{windowName:t}),i;try{r>0&&(i=new VIS.Query,t=="Attribute Set"?i.addRestriction("M_AttributeSet_ID",VIS.Query.prototype.EQUAL,n):t=="Tax Category"?i.addRestriction("C_TaxCategory_ID",VIS.Query.prototype.EQUAL,n):t=="Asset Group"&&i.addRestriction("A_Asset_Group_ID",VIS.Query.prototype.EQUAL,n),i.setRecordCount(1),VIS.viewManager.startWindow(r,i))}catch(u){console.log(u)}},vr=function(){ci=VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductCategory/GetAddCategory","");ct="Category-"+ci;t.ajax({type:"POST",url:VIS.Application.contextUrl+"ProductCategory/Save",dataType:"json",async:!1,data:{Name:ct},success:function(n){n=jQuery.parseJSON(n);var t=n.Key,r=n.Name;t!=""&&(i!=null&&i.find("li:eq(0)").after("<li class='VA005-pro-cat' procatID="+t+"><div procatID="+t+" class='VA005-cat-img'><img style='height: 100%;width: 100%;' procatID="+t+" src=''> <\/div> <div class='VA005-cat-caption'><input type='checkbox' class='VA005-catboxcheck'> <p procatID="+t+" > "+r+" <\/p> <p style='display:none;'><input procatID="+t+" type='text' value='"+r+"'><\/p><\/div><\/li>"),st.prop("checked")||(ft(t),i.find("li .VA005-cat-caption").removeClass("VA005-highlighted"),i.find("li[procatid='"+t+"'] .VA005-cat-caption").addClass("VA005-highlighted"),u=t))},error:function(n,t){console.log(t);returnValue}})},ft=function(n){VIS.Utility.Util.getValueOfInt(n)>0&&(u=n,s[0].style.visibility="visible",et.removeClass("VA005-web_dialog_overlay"),et.find("input, textarea, button, select").removeAttr("disabled"),VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductCategory/GetCategory",{M_Product_Category_ID:n},yr))};var di=function(n,r,u){var f=u.find("p").eq(0),e=u.find("input");t.ajax({type:"POST",url:VIS.Application.contextUrl+"ProductCategory/Update",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify({ID:n,Name:r}),success:function(n){var t=n.result;t&&i!=null&&f.text(r)},error:function(n,t){console.log(t);t}})},wi=function(n,t){var r=t.find("p").eq(0),i=t.find("p").eq(1);n?st.prop("checked")||(r.css({display:"none"}),i.css({display:"block"}),i.find("input").focus(),i.find("input").select()):(r.css({display:"block"}),i.css({display:"none"}))},gi=function(){u=0;c.val("");it.val("");tt.val("");g.val(-1);k.val(-1);rt.val("F");b.val("I");d.val(-1);ut.removeAttr("src").attr("src","")},nr=function(n,t){VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductCategory/LoadCategory",{PGNo:n,PGSize:t},pr)};this.Initialize=function(){fr()};this.getRoot=function(){return n};this.disposeComponent=function(){r=null;n&&n.remove();n=null;f&&f.off("click");lt&&lt.off("click");nt&&nt.off("click");w&&w.off("click");kt&&kt.off("click");i&&(i.off("click"),i.remove());$busyDiv=null;hi=null;et=null;st=null;c=null;i=null;kt=null;s=null;y="";u=0;p=0;dt=0;gt="";o=null;tr=null;ci=0;ct="";h=null;f=null;nt=null;lt=null;w=null;e=null;vt=null;yt=null;pt=null;c=null;tt=null;it=null;b=null;rt=null;k=null;d=null;g=null;ir=null;rr=null;v=null;ot=null;ut=null;bi=null;ur=null;ti=!1;ht=0;bt=0;li=0;ii="";ri=0;ui="";fi="";ei="";oi=0;si=0;ai="";this.getRoot=null;this.disposeComponent=null}};n.ProductCategoryForm.prototype.init=function(n,t){this.frame=t;this.windowNo=n;var i=this.Initialize();this.frame.getContentGrid().append(this.getRoot());this.frame.hideHeader(!0)};n.ProductCategoryForm.prototype.dispose=function(){this.disposeComponent();this.frame&&this.frame.dispose();this.frame=null}}(VA005,jQuery);VA005=window.VA005||{},function(n,t){function i(n,i,r,u,f,e,o,s,h,c,l){function dt(n){var r=n,i;l[0].style.visibility="visible";i={attributeID:n};t.ajax({url:VIS.Application.contextUrl+"Attribute/DeleteAttributeValue",type:"Post",async:!1,datatype:"Json",cache:!1,data:i,success:function(i){var u,f,e;i=JSON.parse(i);u=i;u==""?(g.data("kendoGrid").dataSource.remove(g.data("kendoGrid").select().closest("tr")),f=-1,t.grep(rt,function(t,i){t.attributevalueid==n&&(f=i)}),rt.splice(f,1),e=VIS.dataContext.getJSONData(VIS.Application.contextUrl+"Attribute/GetAttributeCount",{SelectedAttributeID:w}),c.removeatttvaluewithgrid(r,w,e),g.data("kendoGrid").dataSource.read(),tt.attributevallueonattributeclick(w)):(VIS.ADialog.error(u),l[0].style.visibility="hidden")},error:function(n){alert(n);l[0].style.visibility="hidden"}});l[0].style.visibility="hidden"}function st(){l[0].style.visibility="visible";wt={attributevalueid:w};var n=/ipad|iphone|ipod/i.test(navigator.userAgent.toLowerCase()),i=250;n&&(i=210);t.ajax({url:VIS.Application.contextUrl+"Attribute/ShowGrideData",dataType:"json",type:"POST",async:!0,data:wt,success:function(r){var f,e,u,s,o;for(l[0].style.visibility="visible",f={},e=r.result,rt=[],u=0;u<e.length;u++)f={},f.name=e[u].name,f.searchkey=e[u].searchkey,f.attributevalueid=e[u].attributevalueid,rt.push(f),gt=e[u].attributevalueid;s=!1;o=new kendo.data.DataSource({batch:!0,pageSize:10,schema:{model:{id:"attributevalueid",fields:{attributevalueid:{editable:!1,nullable:!1},name:{validation:{required:!0}},searchkey:{}}}},transport:{read:function(n){l[0].style.visibility="visible";n.success(rt);l[0].style.visibility="hidden"},update:function(n){var i=n.data.models[0].name.toString()+", "+n.data.models[0].searchkey.toString()+", "+n.data.models[0].attributevalueid.toString(),r;VIS.dataContext.getJSONRecord("Attribute/Update",i);r=t.grep(rt,function(t){return t.attributevalueid==n.data.models[0].attributevalueid&&(t.name=n.data.models[0].name,t.searchkey=n.data.models[0].searchkey!=null?n.data.models[0].searchkey:n.data.models[0].name),""});g.data("kendoGrid").dataSource.read();tt.attributevallueonattributeclick(w);tt.updateatttvalueintree(n.data.models[0].attributevalueid,n.data.models[0].name)},create:function(n){l[0].style.visibility="visible";var i={searchkey:VIS.Utility.encodeText(n.data.models[0].searchkey),secname:VIS.Utility.encodeText(n.data.models[0].name),attributeID:w};t.ajax({url:VIS.Application.contextUrl+"Attribute/SelectionSavemodel",type:"Post",async:!1,datatype:"Json",cache:!1,data:i,success:function(t){$getidfromattributeset=JSON.parse(t);var i={searchkey:n.data.models[0].searchkey,name:n.data.models[0].name,attributevalueid:$getidfromattributeset};rt.push(i);tt.addatttvaluewithgrid(w,n.data.models[0].name,$getidfromattributeset);st();v.cmboonclick();tt.attributevallueonattributeclick(w)},error:function(){l[0].style.visibility="hidden"}});g.data("kendoGrid").dataSource.read();tt.attributevallueonattributeclick(w);l[0].style.visibility="hidden"},parameterMap:function(n,t){return l[0].style.visibility="visible",t!=="read"&&n.models?{models:kendo.stringify(n.models)}:void 0}}});g&&(g.data("kendoGrid").destroy(),g=null,a.empty());g=a.kendoGrid({dataSource:o,change:ui,pageable:!0,resizable:!0,scrollable:!0,selectable:" ",edit:function(n){n.container.find("input[name=name]").attr("maxlength",28)},dataBound:function(){a.find(".k-grid-edit").addClass("VA005-gridallbtn");a.find(".k-grid-delete").addClass("VA005-gridallbtn");a.find(".k-grid-cancel").addClass("VA005-gridallbtn");a.find(".k-grid-update").addClass("VA005-gridallbtn");a.find(".k-grid-header-wrap").css("position","inherit");a.find(".k-grid-pager").css("position","inherit");n?(a.find(".k-pager-numbers").css({position:"inherit",float:"left","margin-top":"2px"}),a.find(".k-pager-nav").css({position:"inherit",float:"left","margin-top":"2px"}),t(a.find(".k-pager-numbers").siblings()[2]).css({"margin-left":"1px","margin-top":"2px"}),a.find(".k-grid-content").css({height:"100px"}),a.find(".k-pager-nav").css({width:"1px"}),a.find(".k-pager-info").css({"font-size":"11px",padding:"0px"}),a.find(".k-pager-nav").css({width:"1px"}),a.find(".k-label").css({"font-size":"10px",padding:"0px","margin-top":"4px"})):(a.find(".k-pager-numbers").css({position:"inherit"}),a.find(".k-pager-wrap").css("position","inherit"));a.find(".k-widget").css("position","inherit");a.find(".k-pager-nav").css("position","inherit");a.find(".k-grid-content").css("position","inherit");a.find(".k-grid-add").on("click",function(){window.setTimeout(function(){a.find(".k-grid-cancel").addClass("VA005-gridallbtn");a.find(".k-grid-update").addClass("VA005-gridallbtn")},1)});a.find("div").find(".deltemp").on("click",function(){ft=t(t(t(this.parentElement).siblings()).get(2)).html();VIS.ADialog.confirm("VA005_DeleteIt",!0,"","Confirm",function(n){if(n==!0)dt(ft);else return})})},height:i,toolbar:["create"],columns:[{field:"name",title:VIS.Msg.getMsg("Name"),format:"{0:c}"},{field:"searchkey",title:VIS.Msg.getMsg("Value")},{field:"attributevalueid",hidden:!0,title:VIS.Msg.getMsg("attributevalueid")},{command:[{name:"edit",text:{edit:" ",cancel:" ",update:" "},click:function(){a.find(".k-grid-update").css({"min-width":"10px",width:"27px",height:"27px"});a.find(".k-grid-cancel").css({"min-width":"10px",width:"27px",height:"27px"});a.find(".k-grid-cancel").on("click",function(){window.setTimeout(function(){a.find(".k-grid-edit").css({"min-width":"10px",width:"27px",height:"27px"});a.find(".k-grid-delete").css({"min-width":"10px",width:"27px",height:"27px"});a.find("div").find(".deltemp").on("click",function(){ft=t(t(t(this.parentElement).siblings()).get(2)).html();var n=""+VIS.Msg.getMsg("VA005_DeleteIt")+"",i=VIS.ADialog.ask(n);if(i==!0)dt(ft);else return})},1)})}},{name:"Delete",text:" ",template:"<div  class='deltemp' style='float:right'><a  class='VA005-gridallbtn k-button k-button-icontext'><span  class='k-icon k-delete'><\/span><\/a><\/div>"}],title:"&nbsp;",width:85}],editable:"inline"});l[0].style.visibility="hidden"}});l[0].style.visibility="hidden"}function ui(){ft=t(g.data("kendoGrid").select().closest("tr").find("td").get(2)).html()}function fi(){st()}function ei(){VIS.dataContext.getJSONData(VIS.Application.contextUrl+"Attribute/GetFieldLength",{TableID:562,COLUMNNAME:"'Name','Description'"},oi);VIS.dataContext.getJSONData(VIS.Application.contextUrl+"Attribute/GetField",{TableID:558,COLUMNNAME:"'Name','Value'"},si)}function oi(n){if(n!=null)for(var t=0;t<n.length;t++)n[t].COLUMNNAME=="Name"?y.attr("maxlength",n[t].fieldlength):n[t].COLUMNNAME=="Description"&&nt.attr("maxlength",n[t].fieldlength)}function si(n){if(n!=null)for(var t=0;t<n.length;t++)n[t].COLUMNNAME=="Name"?k.attr("maxlength",n[t].fieldlength):n[t].COLUMNNAME=="Value"&&k.attr("maxlength",n[t].fieldlength)}function hi(){it.on("click",function(){v.$getvalueonchange=!0});b.on("click",function(){v.$getvalueonchange=!0;v.$activechkbox=b.is(":checked")?!0:!1});p.on("change",function(){p.val()=="L"?(st(),a.show(),lt.hide()):(a.hide(),lt.show(),s.empty());v.$getvalueonchange=!0;v.$activechkbox=!0;v.$activechkbox=b.is(":checked")?!0:!1;v.$cmbovaluecheck=p.val()});ct.on("click",function(){k.val().trim().length>0&&ai()});y.on("change",function(){v.$getvalueonchange=!0;v.$activechkbox=b.is(":checked")?!0:!1;y.val().trim().length<=0?y.css("background-color","pink"):y.css("background-color","white")});nt.on("change",function(){v.$getvalueonchange=!0;v.$activechkbox=b.is(":checked")?!0:!1});y.on("keydown",function(){v.$getvalueonchange=!0;v.$activechkbox=b.is(":checked")?!0:!1});nt.on("keydown",function(){v.$getvalueonchange=!0;v.$activechkbox=b.is(":checked")?!0:!1});k.on("change",function(){k.val().trim().length<=0?k.css("background-color","pink"):k.css("background-color","white")});ti.on("click",function(){if(k.val().trim().length>0&&y.val().trim().length>0)at(),ot.val(""),k.val(""),i();else return VIS.ADialog.info("VA005_NameMandatory"),!1;et.css("display","inherit");o=1});ii.on("click",function(){ot.val("");k.val("");r.animate({width:"0%"});r.css("display","none");ut.animate({width:"50%"});u.animate({width:"50%"});i();et.animate({width:"50%"});o=1});bt.on("click",function(){if(v.$getvalueonchange==!0){if(y.val().trim().length>0)window.setTimeout(function(){c.updateSelectedAttribute(y.val());b.is(":checked")?c.updatetextcolor(y.val(),!0):c.updatetextcolor(y.val(),!1);at();c.$idgetforattribute&&i();v.$getvalueonchange=!1;v.$activechkbox=!1;ht();t(".VA005-attributedivstatic").parent().attr("VA005_plusimg","N")},200);else return VIS.ADialog.info("VA005_FieldMandatory"),!1;p.val()!="L"?s.empty():tt.attributevallueonattributeclick(w);ht&&ht();ut.css("display","none");et.css("display","inherit")}});kt.on("click",function(){l[0].style.visibility="visible";ut.css("display","none");et.css("display","inherit");r.animate({width:"0%"});r.css("display","none");et.animate({width:"50%"});u.animate({width:"50%"});ut.animate({width:"50%"});t(".VA005-attributedivstatic").parent().attr("VA005_plusimg","N");v.$getvalueonchange=!1;l[0].style.visibility="hidden"})}function ci(){d.append(t("<div>").append(ni));d.append(t('<div class="input-group vis-input-wrap">').append(t('<div class="vis-control-wrap">').append(y).append("<label>"+VIS.Msg.getMsg("Name")+"<\/label>")));d.append(t('<div class="input-group vis-input-wrap">').append(t('<div class="vis-control-wrap">').append(nt).append("<label>"+VIS.Msg.getMsg("Description")+"<\/label>")));d.append(t('<div class="input-group vis-input-wrap">').append(t('<div class="vis-control-wrap">').append(p).append("<label>"+VIS.Msg.getMsg("VA005_AttributeType")+"<\/label>")));d.append(t('<div class="va005-new-att-chkboxWrap">').append(it).append("<label>"+VIS.Msg.getMsg("VA005_Mandatory")+"<\/label>").append(b).append('<label style="margin-bottom:0">'+VIS.Msg.getMsg("VA005_Active")+"<\/label>"));d.append(a);d.append(t('<div style="float: right;">').append(bt).append(kt));ut.append(d);pt.append(d);y.focus()}function li(n){if(n!=null&&n.length>0)for(var t=0;t<n.length;t++)y.val(n[t].name.toString().trim()),n[t].description!=null&&nt.val(n[t].description.toString().trim()),n[t].attributevaluetype!=null&&p.val(n[t].attributevaluetype),n[t].isactive=="Y"?(b.val(n[t].isactive),b.prop("checked",!0)):b.prop("checked",!1),n[t].ismandatory=="Y"?(it.val(n[t].ismandatory),it.prop("checked",!0)):it.prop("checked",!1);fi()}function at(){l[0].style.visibility="visible";vt=it.is(":checked")?!0:!1;yt=b.is(":checked")?!0:!1;var n={name:VIS.Utility.encodeText(y.val().toString().trim()),description:VIS.Utility.encodeText(nt.val().toString().trim()),attributetype:p.val(),mandatory:vt,isactivefield:yt,istanceattribute:!0,ID:w};t.ajax({url:VIS.Application.contextUrl+"Attribute/SaveAttributemodel",type:"Post",datatype:"Json",data:n,success:function(n){tt.isSaveOnItemFocus||(w=JSON.parse(n))},error:function(n){console.log(n);l[0].style.visibility="hidden"}});v.$textnametextvalue=y.val();l[0].style.visibility="hidden"}function ai(){var n={searchkey:VIS.Utility.encodeText(ot.val().toString().trim()),secname:VIS.Utility.encodeText(k.val().toString().trim()),attributeID:w};t.ajax({url:VIS.Application.contextUrl+"Attribute/SelectionSavemodel",type:"Post",async:!1,datatype:"Json",cache:!1,data:n,success:function(){},error:function(){}})}function vi(){p.empty();VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/Attribute/LoadSelectAttribute","",yi)}function yi(n){var u,r,i;if(n!=null)for(r=null,i=0;i<n.length;i++)u=n[i].Key,r=n[i].Name,p.append(t("<Option value="+u+">"+r+"<\/option>"))}function pi(){p.off("change");ct.off("click");y.off("change");k.off("change");d.remove();y.remove();nt.remove();p.remove();ot.remove();k.remove();ct.remove()}var rt,gt,ft;this.windowNo;this.frame;var h=h,et=n,u=u,s=s,f=f,e=e,o=o,r=r,ut=t("<div class='VA005-left-wrap-div-openattributre vis-forms-container' >"),pt=t("<div>"),v=this,ht=null,w=0,wt={},g=null,tt=c,vt=!1,yt=!0;this.$cmbovaluecheck=null;var ni=t('<div class="VA005-top-wrap-treedesign VA005-att-tree-vieww"><h4>'+VIS.Msg.getMsg("VA005_EditAttribute")+"<\/h4><\/div>"),d=t('<div style="height:100%">'),y=t('<input class="VA005-text-color-att-text" type="text" maxlength="20" placeholder=" " data-placeholder=""  >'),nt=t('<input class="VA005-text-color-att-text"  type="text" placeholder=" " data-placeholder="" >'),p=t("<select>"),it=t('<input type="checkbox">'),b=t('<input type="checkbox" checked>'),ot=t('<input  class="VA005-text-color-att-text" type="text" placeholder=" " data-placeholder="" >'),k=t('<input   class="VA005-text-color-att-text" class="vis-ev-col-mandatory" type="text" placeholder=" " data-placeholder="" >'),ct=t('<input type="button" value="Save">'),bt=t('<input style="position:inherit;padding: 6px 14px !important; margin-left: 10px;" type="button" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" value="'+VIS.Msg.getMsg("Ok")+'" >'),kt=t('<input style="position:inherit;padding: 6px 14px !important; margin-left: 10px;" type="button"  class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" value="'+VIS.Msg.getMsg("Cancel")+' ">'),ti=t('<input style="padding: 6px 14px !important; margin-left: 10px;" type="button" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" value="OK" >'),ii=t('<input style="padding: 6px 14px !important; margin-left: 10px;" type="button"  class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" value="Cancel">'),wi=t("<h4>"+VIS.Msg.getMsg("VA005_AddAttributeValue")+"<\/h4>"),a=t('<div  style="position:inherit;float:left;height:50px;width:100%;margin-top:10px;">'),lt=t('<div style="display:none;background-color:white;opacity:0.7;height: 32px;width:28px;float: right;position: absolute;right: 0;">'),ri=null;ci();vi();ei();hi();this.attributecount=function(n){y.val(n)};this.gridkendo=function(){st()};rt=[];gt=0;ft=0;this.cmboonclick=function(){p.val()=="L"?(st(),a.show(),lt.hide()):(a.hide(),lt.show(),s.empty());v.$cmbovaluecheck=p.val()};this.cleartext=function(){y.val("");nt.val("");s.empty();y.val().trim().length<=0?y.css("background-color","pink"):y.css("background-color","white");a.hide();p.attr("disabled",!0);it.attr("disabled",!0);b.attr("disabled",!0)};this.editAttribute=function(n,t){ht=t;w=n;VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/Attribute/LoadAttribute",{Id:n},li);y.val().trim().length<=0?y.css("background-color","pink"):y.css("background-color","white");p.attr("disabled",!1);it.attr("disabled",!1);b.attr("disabled",!1);a.show()};this.saveAttributedata=function(){at()};this.onchangesaveattribute=function(){at()};this.initialize=function(){};this.getRoot=function(){return ut};this.getRoot2=function(){return pt};this.disposeComponent=function(){pi();w=null;d=null;y=null;nt=null;p=null;ot=null;k=null;ct=null;ri=null}}n.AForms=n.AForms||{};n.AForms.attribute=i}(VA005,jQuery);VA005=window.VA005||{},function(n,t){function i(){function vu(){h=t("<div style='height:100%' class='vis-formouterwrpdiv' >");ir="<div id='"+i.windowNo+"leftboxdivwidth' class='VA005-right-wrap-leftboxdiv'><div class='VA005-top-wrap-treedesign'><h4>"+VIS.Msg.getMsg("VA005_Attribute")+"<\/h4><div class='VA005-top-right-treedesign'><span id='"+i.windowNo+"editattributeboxes' class='vis vis-edit' title='"+VIS.Msg.getMsg("VA005_EditAttribute")+"'   ><\/span><span id='"+i.windowNo+"delattributeboxes' class='vis vis-delete' title='"+VIS.Msg.getMsg("VA005_DeleteAttribute")+"' ><\/span><\/div><\/div><div class='VA005-att-tree-vieww'><\/div><div id='"+i.windowNo+"leftboxbackdivforspliter' class='VA005-att-lefttopwrap'><div class='VA005-att-lefttopinnerwrap VA005_maindivleft' id='"+i.windowNo+"attributedivleftdragdrop'><\/div><\/div><div id='"+i.windowNo+"leftboxattvaluebelow'  style='height:45%;'><div id='"+i.windowNo+"AttributeValuegetid' class='VA005-att-tree-vieww''><h5>"+VIS.Msg.getMsg("VA005_AttributeValue")+"<\/h5><\/div><div style='float:left'><\/div><div style='margin-left:0px;overflow:auto;height:76%;float:left' id='"+i.windowNo+"attributevaluedivleftdragdrop'><\/div><\/div><\/div><div id='"+i.windowNo+"middivforattributevalue' class='VA005-right-wrap-leftboxdiv' style='overflow:auto;display:none;width: 30%;'><\/div><div id='"+i.windowNo+"btndiv' class='VA005-right-wrap-div-setlisting-top'><div class='VA005-top-wrap-div-h VA005-top-wrap-treedesign'><h4>"+VIS.Msg.getMsg("VA005_AttributeSetListing")+"<\/h4><div style='position:relative' class='VA005-top-right-treedesign VA005-top-right-div-openattset'><span id='"+i.windowNo+"openattributeset' class='vis vis-plus' title='"+VIS.Msg.getMsg("VA005_OpenAttributeSet")+"'   ><\/span><span id='"+i.windowNo+"deleteattribute' class='VA005-disabled vis vis-delete' title='"+VIS.Msg.getMsg("VA005_DeleteAttributeSet")+"' ><\/span><\/div><\/div><div style='z-index:999999' class='VA005-att-tree-div-showtree'  ><div  id='"+i.windowNo+"showtree' style='min-width:350px;-webkit-overflow-scrolling:touch;' ><\/div><\/div><\/div><span id='"+i.windowNo+"deletemsz' style='display:none;color:red'>"+VIS.Msg.getMsg("VA005_DeletSuccessfully")+"<\/span><\/div>";h.append(ir);ou=h.find("#"+i.windowNo+"deletemsz");pr=h.find("#"+i.windowNo+"AttributeValuegetid");hu=h.find("#"+i.windowNo+"leftboxattvaluebelow");eu=h.find("#"+i.windowNo+"VA005_splitter");ri=h.find("#"+i.windowNo+"leftboxbackdivforspliter");fu=h.find("#"+i.windowNo+"hideshoweditbutton");ot=h.find("#"+i.windowNo+"leftboxdivwidth");b=h.find("#"+i.windowNo+"editattributeboxes");nt=h.find("#"+i.windowNo+"delattributeboxes");w=h.find("#"+i.windowNo+"middivforattributevalue");wi=h.find("#"+i.windowNo+"addnewattribute");r=h.find("#"+i.windowNo+"attributedivleftdragdrop");ru=h.find("#"+i.windowNo+"attributedivleftdragdrop_header");ut=h.find("#"+i.windowNo+"attributevaluedivleftdragdrop");ht=h.find("#"+i.windowNo+"showtree");uu=h.find("#"+i.windowNo+"hideshowrightdiv");bt=h.find("#"+i.windowNo+"openattributeset");kt=h.find("#"+i.windowNo+"deleteattribute");fi.append(h);a=h.find("#"+i.windowNo+"btndiv")}function ci(){r.empty();var n="<div class='VA005-attributedivstatic  VA005-divboxtarget-design-hover' title='"+VIS.Msg.getMsg("VA005_AddAttribute")+"' ><span><i class='vis vis-plus' id='"+i.windowNo+"addnewattribute'><\/i><\/span><\/div><div class='VA005-innerattrb'><\/div>";r.append(t(n));r.find(".VA005-attributedivstatic").on("click",bu);br=r.find(".VA005-attributedivstatic");VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/AttributeListing/GetAttribute","",yu)}function yu(n){var u="",i;if(n.length>0)for(i=0;i<n.length;i++)u+=kr(VIS.Utility.Util.getValueOfInt(n[i].m_attribute_id),VIS.Utility.encodeText(n[i].name),n[i].isactive);r.append(t(u));r.find(".VA005-attributediv").on(VIS.Events.onTouchStartOrClick,di);r.find(".VA005-attributediv").draggable({cursorAt:{left:-10,top:-10},helper:function(){var n=t(r.find(".VA005-attributediv div").find("input:checked")).parent().parent(),i;return n.length===0&&(n=t(this)),i=t("<div/>").attr("id","draggingContainer"),i.append(n.clone()),i},start:function(){at=!0},drag:function(){},stop:function(){at=!1}})}function pu(){ht.find(".k-in").droppable({tolerance:"pointer",drop:function(){e[0].style.visibility="visible";for(var n=0;n<u.length;n++)ki.push(t(t(r.find("[data-id='"+u[n]+"']"))[0]).attr("data-id"));wr=t(this).children().eq(0).attr("NID");wu(ki,wr);ki.length=[]}})}function wu(n,i){e[0].style.visibility="visible";var r=n.toString();t.ajax({url:VIS.Application.contextUrl+"Attribute/SaveAttributeuses",type:"Post",async:!1,datatype:"Json",data:{attributsetid:r,nid:i},success:function(n){var t=JSON.parse(n);vt();e[0].style.visibility="hidden"},error:function(){}})}function bu(){b.removeClass("VA005-disabled");s.$getvalueonchange==!0&&VIS.ADialog.confirm("VA005_SaveAttributeIt",!0,"","Confirm",function(n){n==!0?(s.onchangesaveattribute(),s.$getvalueonchange=!1):s.$getvalueonchange=!1});e[0].style.visibility="visible";nt.removeClass("VA005-disabled");f=0;u=[];ku();ot.animate({width:"40%"});o.css("display","none");a.animate({width:"30%"});a.css("display","inherit");s.cleartext();w.animate({width:"30%"});w.css({display:"inherit",width:"30%"});s.attributecount(si);r.find(".VA005-attributediv").draggable("destroy");var n=kr(f,VIS.Msg.getMsg("VA005_Attribute")+si,"Y");r.find(".VA005-innerattrb").prepend(t(n));st();r.attr("VA005_plusimg","Y");r.find(".VA005-divboxtarget-design").removeClass("VA005-divboxtarget-design");t(r.children()).find("div .VA005-checkboxonleftdiv").removeAttr("checked");t(r.find(".VA005-innerattrb").children("div")[0]).addClass("VA005-divboxtarget-design");t(r.find(".VA005-innerattrb").children("div")[0]).find(".VA005-checkboxonleftdiv").prop("checked",!0);t(t(r.children()).find("label")).removeClass("VA005-textcolorchange-onedit");tt=t(r.find(".VA005-innerattrb").children("div")[0]).find("label");u.push(f);r.find(".VA005-attributediv").off(VIS.Events.onTouchStartOrClick,di);r.find(".VA005-attributediv").on(VIS.Events.onTouchStartOrClick,di);r.find(".VA005-attributediv").draggable({start:function(){at=!0;lu=t(this).find("label")},drag:function(){if(t(this).data("isactive")=="N")return at=!1,!1},stop:function(){at=!1},revert:"invalid",helper:"clone",containment:fi});e[0].style.visibility="hidden"}function kr(n,t,r){return str="<div data-isActive='"+r+"' data-id='"+n+"' title='"+t+"' id='"+i.windowNo+"divappendinleftsideboxes_header' class='VA005-attributediv  VA005-divboxtarget-design-hover'><div class='VA005-attrdiv style='float: left; width: 100%;'><input attid='"+n+"' class='VA005-checkboxonleftdiv' type='checkbox' style='float: left;'><\/div>",str+=r=="Y"?"<label class='VA005-textoverfllowhidden'>"+t+"<\/label>":"<label class='VA005-textoverfllowhidden-lightcolor'>"+t+"<\/label>",str+="<\/div>"}function ku(){VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/AttributeListing/GetAttributeCount","",du)}function du(n){n!=null&&(si=n.value+1);var r={name:VIS.Msg.getMsg("VA005_Attribute")+" "+si,isactivefield:!0,mandatory:!1,istanceattribute:!0};t.ajax({url:VIS.Application.contextUrl+"Attribute/SaveAttributemodel",type:"Post",async:!1,datatype:"Json",data:r,success:function(n){f=JSON.parse(n);i.getidfromdivboxesselect=f+"_2_"+i.windowNo},error:function(){}})}function gu(n){var r="",i;if(n.length>0)for(i=0;i<n.length;i++)r+="<div data-id='"+VIS.Utility.Util.getValueOfInt(n[i].m_attributevalue_id)+"' class='VA005-attributediv  VA005-divboxtarget-design-hover'><label class='VA005-textoverfllowhidden2' title='"+VIS.Utility.encodeText(n[i].name)+"'>"+VIS.Utility.encodeText(n[i].name)+"<\/label><\/div>";ut.append(t(r))}function di(n){n.stopPropagation();i.isSaveOnItemFocus=!1;s.$getvalueonchange==!0&&VIS.ADialog.confirm("VA005_SaveAttributeIt",!0,"","Confirm",function(n){n==!0?(i.isSaveOnItemFocus=!0,s.onchangesaveattribute(),s.cmboonclick(),i.attributevallueonattributeclick(f),tt.is("label")||(tt=tt.hasClass("VA005-attributediv")?tt.find("label"):tt.siblings()[0]),tt.text(s.$textnametextvalue),tt.addClass("VA005-textoverfllowhidden"),vt(),s.$activechkbox?tt.css("color","black"):tt.css("color","#AFA5A5")):s.$getvalueonchange=!1});nt.removeClass("VA005-disabled");var e=t(n.target);tt=e;e.hasClass("VA005-checkboxonleftdiv")?(e.prop("disabled",!0),window.setTimeout(function(){b.removeClass("VA005-disabled");f=VIS.Utility.Util.getValueOfInt(e.attr("attid"));getidfromattboxexforaddnode=f;e.prop("checked")?(u.push(f),e.parent().parent().addClass("VA005-divboxtarget-design"),u.length==1?(st(),s.cmboonclick(),i.attributevallueonattributeclick(f),b.removeClass("VA005-disabled"),nt.removeClass("VA005-disabled")):ut.empty()):(u.length==1&&(b.removeClass("VA005-disabled"),nt.removeClass("VA005-disabled")),u.splice(u.indexOf(f),1),e.parent().parent().removeClass("VA005-divboxtarget-design"),bi=u,bi.length==1&&(f=u[0],st(),s.cmboonclick(),i.attributevallueonattributeclick(bi)));(u.length==0||u.length>1)&&(ut.empty(),b.addClass("VA005-disabled"),w.is(":visible")&&(ot.animate({width:"50%"}),w.animate({width:"30%"}),w.css({display:"none",width:"0%"}),a.animate({width:"50%"}),a.css("display","inherit"),o.animate({width:"50%"}),s.cleartext()));t(r.children().find("label")).removeClass("VA005-textcolorchange-onedit");e.prop("disabled",!1)},200)):e.is("label")?(u=[],e=e.parent(),f=e.data("id"),getidfromattboxexforaddnode=f,u.push(f),t(r.children()).removeClass("VA005-divboxtarget-design"),r.find(".VA005-divboxtarget-design").removeClass("VA005-divboxtarget-design"),e.addClass("VA005-divboxtarget-design"),st(),s.cmboonclick(),i.attributevallueonattributeclick(f),t(r.children()).find("div .VA005-checkboxonleftdiv").removeAttr("checked"),e.find("div .VA005-checkboxonleftdiv").prop("checked","true"),b.removeClass("VA005-disabled"),t(r.children().find("label")).removeClass("VA005-textcolorchange-onedit")):e.hasClass("VA005-attributediv")?(u=[],f=e.data("id"),getidfromattboxexforaddnode=f,u.push(f),t(r.children()).removeClass("VA005-divboxtarget-design"),r.find(".VA005-divboxtarget-design").removeClass("VA005-divboxtarget-design"),e.addClass("VA005-divboxtarget-design"),st(),s.cmboonclick(),i.attributevallueonattributeclick(f),t(r.children()).find("div .VA005-checkboxonleftdiv").removeAttr("checked"),e.find("div .VA005-checkboxonleftdiv").prop("checked","true"),b.removeClass("VA005-disabled"),t(r.children().find("label")).removeClass("VA005-textcolorchange-onedit")):e.parent().hasClass("VA005-attributediv")&&(u=[],e=e.parent(),f=e.data("id"),getidfromattboxexforaddnode=f,u.push(f),t(r.children()).removeClass("VA005-divboxtarget-design"),r.find(".VA005-divboxtarget-design").removeClass("VA005-divboxtarget-design"),e.addClass("VA005-divboxtarget-design"),st(),s.cmboonclick(),i.attributevallueonattributeclick(f),t(r.children()).find("div .VA005-checkboxonleftdiv").removeAttr("checked"),e.find("div .VA005-checkboxonleftdiv").prop("checked","true"),b.removeClass("VA005-disabled"),t(r.children().find("label")).removeClass("VA005-textcolorchange-onedit"));s.$getvalueonchange=!1}function nf(){o=t("<div  class='VA005-left-wrap-div-openattributre' style='display:none;'>");vr="<div class='VA005-att-tree-vieww VA005-top-wrap-treedesign'><h4>"+VIS.Msg.getMsg("VA005_AddAttributeSet")+"<\/h4><\/div><div style='float: left; width: 100%;'><table class='VA005-att-righttable mt-2'><tr><td><div class='input-group vis-input-wrap'><div class='vis-control-wrap'><input class='vis-ev-col-mandatory' id='"+i.windowNo+"txtname' type='text' placeholder=' ' data-placeholder=''><label>"+VIS.Msg.getMsg("Name")+"<\/label><\/div><\/div><\/td><\/tr><tr><td><div class='input-group vis-input-wrap'><div class='vis-control-wrap'><input id='"+i.windowNo+"txtdes'  type='text' placeholder=' ' data-placeholder='' ><label>"+VIS.Msg.getMsg("Description")+"<\/label><\/div><\/div><\/td><\/tr><tr><td><div class='input-group vis-input-wrap'><div class='vis-control-wrap'><select id='"+i.windowNo+"mandatorysec'><\/select><label>"+VIS.Msg.getMsg("VA005_MandatoryType")+"<\/label><\/div><\/div><\/td><\/tr><tr><td><div style='width: 50%; float: left' class='input-group vis-input-wrap'><div class='vis-control-wrap'><label class='vis-ec-col-lblchkbox'><input type='checkbox'  id='"+i.windowNo+"expirydate' />"+VIS.Msg.getMsg("VA005_ExpiryDate")+"<\/label><\/div><\/div><div style='width: 50%; float: left' class='input-group vis-input-wrap'><div class='vis-control-wrap'><label class='vis-ec-col-lblchkbox'><input type='checkbox' disabled id='"+i.windowNo+"mandatoryexpdate' />"+VIS.Msg.getMsg("VA005_MandatoryExpiryDate")+"<\/label><\/div><\/div><\/td><\/tr><tr><td><div style='width: 50%; float: left' class='input-group vis-input-wrap'><div class='vis-control-wrap'><label class='vis-ec-col-lblchkbox'><input id='"+i.windowNo+"lot'  type='checkbox'>"+VIS.Msg.getMsg("VA005_Lot")+"<\/label><\/div><\/div><div style='width: 50%; float: left' class='input-group vis-input-wrap'><div class='vis-control-wrap'><label class='vis-ec-col-lblchkbox'><input id='"+i.windowNo+"serial' type='checkbox' >"+VIS.Msg.getMsg("VA005_Serial")+"<\/label><\/div><\/td><\/tr><tr><td><div class='input-group vis-input-wrap'><div class='vis-control-wrap'><select class='VA005-selectattsetcmb' id='"+i.windowNo+"lotandserialdatadropdown' data-hasbtn=' '><\/select><label id='"+i.windowNo+"lotandserialname'>"+VIS.Msg.getMsg("VA005_Lot&Serial")+"<\/label><\/div> <div class='input-group-append'><span title='"+VIS.Msg.getMsg("VA005_Edit")+"'  id='"+i.windowNo+"editbtn' class='input-group-text vis vis-edit'><\/span>   <span title='"+VIS.Msg.getMsg("VA005_AddLotSerial")+"'    class='input-group-text vis vis-plus'  id='"+i.windowNo+"addbtn'><\/span>        <\/div><\/div>   <\/td><\/tr><tr><td><div class='d-flex justify-content-end'><input id='"+i.windowNo+"okbtnattributeset' class='mr-3 ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only' type='button'  value='"+VIS.Msg.getMsg("OK")+"'/><input id='"+i.windowNo+"cancelbtnattributeset' class='ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only' type='button'  value='"+VIS.Msg.getMsg("Cancel")+"'/><\/div><\/td><\/tr><\/table><\/div>";o.append(vr);h.append(o);c=o.find("#"+i.windowNo+"txtname");yt=o.find("#"+i.windowNo+"txtdes");ct=o.find("#"+i.windowNo+"mandatorysec");k=o.find("#"+i.windowNo+"expirydate");d=o.find("#"+i.windowNo+"mandatoryexpdate");l=o.find("#"+i.windowNo+"lot");v=o.find("#"+i.windowNo+"serial");pt=o.find("#"+i.windowNo+"lotandserialname");y=o.find("#"+i.windowNo+"lotandserialdatadropdown");g=o.find("#"+i.windowNo+"addbtn");vi=o.find("#"+i.windowNo+"divhideandshow");lt=o.find("#"+i.windowNo+"editbtn");hr=o.find("#"+i.windowNo+"okbtnattributeset");cr=o.find("#"+i.windowNo+"cancelbtnattributeset");ef()}function tf(){et=t("<div>");ar="<div id='"+i.windowNo+"divhideandshow' style='height:auto;width:100%;'><table style='width:100%'><tr><td><div class='input-group vis-input-wrap'><div class='vis-control-wrap'><input class='vis-ev-col-mandatory' id='"+i.windowNo+"divnametxt' type='text' ><label>"+VIS.Msg.getMsg("Name")+"<\/label><\/div><\/div><\/td><\/tr><tr><td><div class='input-group vis-input-wrap'><div class='vis-control-wrap'><input id='"+i.windowNo+"divstarttext' type='number' value='100' /><label>"+VIS.Msg.getMsg("VA005_StartNo")+"<\/label><\/div><\/div><\/td><\/tr><tr><td><div class='input-group vis-input-wrap'><div class='vis-control-wrap'><input id='"+i.windowNo+"divcurrenttext' type='number'  value='100' /><label>"+VIS.Msg.getMsg("VA005_CurrentNext")+"<\/label><\/div><\/div><\/td><\/tr><tr><td><div class='input-group vis-input-wrap'><div class='vis-control-wrap'><input id='"+i.windowNo+"incrementtext' type='number'  value='1' /><label>"+VIS.Msg.getMsg("VA005_Increment")+"<\/label><\/div><\/div><\/td><\/tr><tr><td><div class='input-group vis-input-wrap'><div class='vis-control-wrap'><input id='"+i.windowNo+"prefixtxt' type='text' /><label>"+VIS.Msg.getMsg("VA005_Prefix")+"<\/label><\/div><\/div><\/td><\/tr><tr><td><div class='input-group vis-input-wrap'><div class='vis-control-wrap'><input id='"+i.windowNo+"serfixtxt' type='text' /><label>"+VIS.Msg.getMsg("VA005_Suffix")+"<\/label><\/div><\/div><\/td><\/tr><\/table><\/div>";et.append(ar);it=et.find("#"+i.windowNo+"divnametxt");rt=et.find("#"+i.windowNo+"divstarttext");dt=et.find("#"+i.windowNo+"divcurrenttext");gt=et.find("#"+i.windowNo+"incrementtext");ni=et.find("#"+i.windowNo+"prefixtxt");ti=et.find("#"+i.windowNo+"serfixtxt")}function rf(){tf();oe();var n=new VIS.ChildDialog;n.setHeight(450);n.setWidth(450);n.setEnableResize(!1);l.prop("checked")?n.setTitle(VIS.Msg.getMsg("VA005_AddLot")):n.setTitle(VIS.Msg.getMsg("VA005_AddSerial"));n.setModal(!0);n.setContent(et);n.show();n.onClose=function(){nr()};n.onOkClick=function(){if(it.val().trim().length>0)l.prop("checked")&&(re(),li()),v.prop("checked")&&(ue(),gi());else return VIS.ADialog.info("VA005_NameFieldRequired"),!1;nr()};n.onCancelClick=function(){nr()}}function uf(){s=new n.AForms.attribute(a,ci,w,ot,nt,b,yr,ut,br,i,e);ei=s.getRoot();h.append(ei);ur=s.getRoot2();w.append(ur);ei.css("display","none")}function st(){s.editAttribute(f,vt);ei.css("display","inherit")}function ff(){var n=[];t.ajax({url:VIS.Application.contextUrl+"AttributeListing/DeleteAttributeFromData",type:"Post",async:!1,datatype:"Json",contentType:"application/json",data:JSON.stringify({values:u}),success:function(t){if(ut.empty(),t.value.length>0)for(var i=0;i<t.value.length;i++)t.value[i].Name!=""&&n.push(t.value[i].Name);n!=""&&VIS.ADialog.error("VA005_AttributeCategory",!0,n.join(", "))},error:function(n){n.value!=null&&VIS.ADialog.error(n.value)}})}function ef(){ft>0?gr(ft):ai();c.val().trim().length<=0?c.addClass("vis-ev-col-mandatory"):c.removeClass("vis-ev-col-mandatory")}function of(){g.prop("disabled",!1)}function sf(){ct.empty();VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/AttributeListing/GetMandatoryType","",hf)}function hf(n){var u,r,i;if(n!=null)for(r=null,i=0;i<n.length;i++)u=n[i].Key,r=n[i].Name,ct.append(t("<Option value="+u+">"+r+"<\/option>"))}function li(){y.empty();VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/AttributeListing/GetLotData","",cf)}function cf(n){var u,r,i;if(n!=null)for(r=null,y.append(t("<Option value=''> <\/option>")),i=0;i<n.length;i++)u=n[i].Key,r=n[i].Name,y.append(t("<Option value="+u+">"+VIS.Utility.encodeText(r)+"<\/option>"))}function gi(){y.empty();VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/AttributeListing/GetSerialData","",lf)}function lf(n){var u,r,i;if(n!=null)for(r=null,y.append(t("<Option value=''> <\/option>")),i=0;i<n.length;i++)u=n[i].Key,r=n[i].Name,y.append(t("<Option value="+u+">"+VIS.Utility.encodeText(r)+"<\/option>"))}function af(){l.is(":checked")?(or=y.val(),yi="true"):yi="false";v.is(":checked")?(sr=y.val(),pi="true"):pi="false";var n={name:VIS.Utility.encodeText(c.val()),description:VIS.Utility.encodeText(yt.val()),mandatorytype:ct.val(),IsGuaranteeDate:k.prop("checked"),IsGuaranteeDateMandatory:d.prop("checked"),lotvalue:or,serialvalue:sr,islotcheck:yi,isserialcheck:pi,ID:ft};t.ajax({url:VIS.Application.contextUrl+"AttributeListing/SaveAttributeSetValue",type:"Post",async:!1,datatype:"Json",cache:!1,data:n,success:function(n){iu=JSON.parse(n)},error:function(){}})}function gr(n){ai();VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/AttributeListing/GetAttributeSetData",{NodeID:n},vf)}function vf(n){if(n!=null&&n.length>0)for(var t=0;t<n.length;t++)c.val(n[t].name),yt.val(n[t].description),ct.val(n[t].mandatorytype),k.val(n[t].isguaranteedate),n[t].isguaranteedate=="Y"?(k.prop("checked",!0),d.prop("disabled",!1)):k.prop("checked",!1),d.val(n[t].isguaranteedatemandatory),n[t].isguaranteedatemandatory=="Y"?(d.attr("disabled",!1),d.prop("checked",!0)):d.prop("checked",!1),l.val(n[t].m_lotctl_id),n[t].islot=="Y"?(l.prop("checked",!0),li(),y.val(n[t].lotctl_id),ii=n[t].m_lotctl_id):l.prop("checked",!1),v.val(n[t].m_sernoctl_id),n[t].isserno=="Y"?(v.prop("checked",!0),gi(),y.val(n[t]._sernoctl_id),wt=n[t].m_sernoctl_id):v.prop("checked",!1);g.prop("disabled",!0);c.val().trim().length<=0?c.addClass("vis-ev-col-mandatory"):c.removeClass("vis-ev-col-mandatory")}function yf(){e=t("<div>");e.css("position","absolute");e.css("bottom","0");e.css("background","url('"+VIS.Application.contextUrl+"Areas/VIS/Images/busy.gif') no-repeat");e.css("background-position","center center");e.css("width","98%");e.css("height","98%");e.css("text-align","center");e.css("z-index","1000");e[0].style.visibility="visible";fi.append(e)}function pf(){p.data("kendoTreeView").wrapper.find(".va005-parentss").parent().on({mouseenter:function(){if(at==!0){var n=t(this).find(".classforgetnod");n.length>0?t(this).find(".va005-parentss").addClass("VA005-classforgetnod"):t(this).css({cursor:"not-allowed"})}},mouseleave:function(){if(at==!0){var n=t(this).find(".classforgetnod");n.length>0?t(this).find(".va005-parentss").removeClass("VA005-classforgetnod"):t(this).css({cursor:"auto"})}}})}function wf(n){var u=t(this).data("nodeid"),i,r;n.preventDefault();i=p.data("kendoTreeView");i.remove(t(this).closest(".k-item"));r=t(this).data("parentid");VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/AttributeListing/DeleteAttributeUse",{AttributeID:u,ParentId:r})}function kf(){var n=t(this).data("dtype");n=="1"?(e[0].style.visibility="visible",ft=t(this).data("nodeid"),a.css("display","none"),ot.animate({width:"50%"}),w.animate({width:"0%"}),w.css({display:"none",width:"0%"}),o.animate({width:"50%"}),o.css("display","inherit"),gr(ft),s.gridkendo(),t(r.children()).find("div .VA005-checkboxonleftdiv").removeAttr("checked"),r.find(".VA005-divboxtarget-design").removeClass("VA005-divboxtarget-design"),u=[],nt.addClass("VA005-disabled"),e[0].style.visibility="hidden"):n=="2"&&(a.animate({width:"30%"}),e[0].style.visibility="visible",b.addClass("VA005-disabled"),f=t(this).data("nodeid"),getidfromattboxexforaddnode=f,tt=t(r.find("[data-id='"+f+"']")).find("label"),i.$idgetforattribute=!0,st(),w.is(":visible")||(ot.animate({width:"40%"}),o.css("display","none"),a.animate({width:"30%"}),w.animate({width:"30%"}),w.css({display:"inherit",width:"30%"})),r.find(".VA005-divboxtarget-design").removeClass("VA005-divboxtarget-design"),t(r.children()).find("div .VA005-checkboxonleftdiv").removeAttr("checked"),nt.addClass("VA005-disabled"),u=[],ht.css("overflow","auto"),s.cmboonclick(),i.attributevallueonattributeclick(f),e[0].style.visibility="hidden")}function df(){var n,i;e[0].style.visibility="visible";n=p.data("kendoTreeView").select();ft=t(n.find(".data-id ")).data("nodeid");i=t(n.find(".data-id ")).data("dtype");i=="1"&&VIS.ADialog.confirm("VA005_DeleteIt",!0,"","Confirm",function(i){if(i==!0){var r={attributesetdelID:ft};t.ajax({url:VIS.Application.contextUrl+"AttributeListing/DeleteAttributeSetValue",type:"Post",async:!1,datatype:"Json",cache:!1,data:r,success:function(t){t=JSON.parse(t);var i=t;i==""?p.data("kendoTreeView").remove(n.closest(".k-item")):VIS.ADialog.error(i)},error:function(n){n!=null&&VIS.ADialog.error(n)}})}});e[0].style.visibility="hidden"}function gf(){oi=t("<div>");fr="<div style='height:auto;width:100%'><ul style='line-height: 1.7em;padding-left: 2rem;;margin:0' id='"+i.windowNo+"iconUi'><\/ul><\/div>";oi.append(fr);er=oi.find("#"+i.windowNo+"iconUi")}function ne(n){VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/AttributeListing/LoadAttributeUse",{AttributeID:n},te)}function te(n){if(n!=null)for(var i=0;i<n.value.length;i++)er.append(t("<li>"+VIS.Utility.Util.getValueOfString(n.value[i])+"<\/li>"))}function ie(){rr=t(this).data("nodeid");gf();ne(rr);var n=new VIS.ChildDialog;n.setHeight(300);n.setWidth(350);n.setEnableResize(!1);n.setTitle(VIS.Msg.getMsg("VA005_LinkAttributeSetAndAttribute"));n.setModal(!0);n.setContent(oi);n.show();n.onClose=function(){};n.onOkClick=function(){};n.onCancelClick=function(){}}function re(){var n={Name:VIS.Utility.encodeText(it.val()),StartNo:VIS.Utility.encodeText(rt.val()),CurrentNext:VIS.Utility.encodeText(dt.val()),Increment:VIS.Utility.encodeText(gt.val()),prefix:VIS.Utility.encodeText(ni.val()),Suffix:VIS.Utility.encodeText(ti.val()),IsLot:!0};t.ajax({url:VIS.Application.contextUrl+"AttributeListing/SaveLotData",type:"Post",async:!1,datatype:"Json",cache:!1,data:n,success:function(n){lr=JSON.parse(n)},error:function(){}});ii=lr}function nr(){it.val("");rt.val("");dt.val("");gt.val("");ni.val("");ti.val("");it.trigger("change")}function ue(){var n={name:it.val(),startno:rt.val(),currentnext:dt.val(),incrementno:gt.val(),prefix:ni.val(),sufix:ti.val(),IsLot:!0};t.ajax({url:VIS.Application.contextUrl+"AttributeListing/saveSerialData",type:"Post",async:!1,datatype:"Json",cache:!1,data:n,success:function(n){tr=JSON.parse(n)},error:function(){}});wt=tr}function ai(){c.val("");yt.val("");k.prop("checked",!1);d.prop("checked",!1);d.prop("disabled",!0);l.prop("checked",!1);v.prop("checked",!1);y.empty()}function fe(){VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/AttributeListing/GetFieldLength",{TableID:560,COLUMNNAME:"'Name','Description'"},ee)}function ee(n){if(n!=null)for(var t=0;t<n.length;t++)n[t].COLUMNNAME=="Name"?c.attr("maxlength",n[t].fieldlength):n[t].COLUMNNAME=="Description"&&$addatttextdes.attr("maxlength",n[t].fieldlength)}function oe(){it.on("change",function(){it.val().trim().length<=0?it.css("background-color","pink"):it.css("background-color","white")});se()}function se(){VIS.dataContext.getJSONData(VIS.Application.contextUrl+"AttributeListing/GetFieldLength",{TableID:556,COLUMNNAME:"'Name','StartNo','CurrentNext','IncrementNo','Prefix','Suffix'"},he)}function he(n){if(n!=null)for(var t=0;t<n.length;t++)n[t].COLUMNNAME=="Name"?it.attr("maxlength",n[t].fieldlength):n[t].COLUMNNAME=="StartNo"?rt.attr("maxlength",n[t].fieldlength):n[t].COLUMNNAME=="CurrentNext"?rt.attr("maxlength",n[t].fieldlength):n[t].COLUMNNAME=="IncrementNo"?rt.attr("maxlength",n[t].fieldlength):n[t].COLUMNNAME=="Prefix"?rt.attr("maxlength",n[t].fieldlength):n[t].COLUMNNAME=="Suffix"&&rt.attr("maxlength",n[t].fieldlength)}function ce(){bt.off("click");l.off("click");v.off("click");g.off("click");k.off("click");c.off("click");h.remove();ht.remove();bt.remove();o.remove();c.remove();yt.remove();ct.remove();k.remove();d.remove();l.remove();v.remove();pt.remove();y.remove();g.remove()}var ui,dr,vt,bf,tr,wt;this.windowNo;this.frame;var i=this,fi=t("<div class='vis-forms-container' style='height:100%;background-color:white;' >"),e=null,h=null,ir=null,a=null,ht=null,bt=null,kt=null,o=null,c=null,yt=null,ct=null,k=null,d=null,l=null,v=null,pt=null,y=null,g=null,nu=null,it=null,rt=null,dt=null,gt=null,ni=null,ti=null,tu=null,vi=null,p=null,iu=null,f=0,ft=0,rr=0,s=null,ei=null,ur=null,oi=null,fr=null,er=null,or=null,sr=null,hr=null,cr=null,lr=null,ii=null,ar=null,et=null,yi=!1,pi=!1,vr=null,lt=null,wi=null,r=null,ru=null,ut=null,w=null,ot=null,uu=null,nt=null,yr=null;this.flag=1;yr=1;var b=null,fu=null,ri=null,eu=null,ou=null,at=!1,si=null,u=[],su=null,hu=null,pr=null,cu=null,tt=null,lu=null;this.Expandable=!1;this.getidfromattboxexforaddnode=null;this.getidfromdivboxesselect=null;this.isSaveOnItemFocus=!1;var hi=null,bi=0,au=!0;this.initialize=function(){yf();vu();vt();nf();sf();fe();uf();dr();ci();window.setTimeout(function(){i.formSizeChanged()},200)};this.ShowDialog=function(){};this.getRoot=function(){return fi};var ki=[],wr=null,br=null;this.updateSelectedAttribute=function(n){t(r.find(".VA005-divboxtarget-design").find("label")).text(n);t(r.find(".VA005-divboxtarget-design").find("label")).css({"word-break":"break-word","line-height":"20px"})};this.updatetextcolor=function(n,i){i?(t(r.find(".VA005-divboxtarget-design").find("label")).text(n),hi=t(r.find(".VA005-divboxtarget-design").find("label")).text(n),hi.css("color","black"),t(t(r.find(".VA005-divboxtarget-design").find("label")).parent()).data("isactive","Y")):(t(r.find(".VA005-divboxtarget-design").find("label")).text(n),hi=t(r.find(".VA005-divboxtarget-design").find("label")).text(n),hi.css("color","#AFA5A5"),t(t(r.find(".VA005-divboxtarget-design").find("label")).parent()).data("isactive","N"))};ui=0;this.attributevallueonattributeclick=function(n){s.$cmbovaluecheck=="L"&&(ut.empty(),VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/AttributeListing/GetAttributeValue",{SelectAttributeID:n},gu))};dr=function(){u.length==0&&nt.addClass("VA005-disabled");b.addClass("VA005-disabled");nt.on("click",function(){e[0].style.visibility="visible";u.length>0&&VIS.ADialog.confirm("VA005_DeleteIt",!0,"","Confirm",function(n){var i,t;if(n==!0){for(i="",t=0;t<u.length;t++)i+=t==0?u[t]:","+u[t];ff();vt();ci();e[0].style.visibility="hidden";nt.addClass("VA005-disabled");s.cleartext();u=[];b.addClass("VA005-disabled")}else nt.removeClass("VA005-disabled")});e[0].style.visibility="hidden"});l.is(":checked")&&(pt.text(VIS.Msg.getMsg("VA005_LotValue")),li());ri.resizable({});ri.on("resize",function(n,t){var r=t.size.height,i;ri.css("width","100%");i=null;i=ot.height()-(pr.height()+10);ri.css("max-height",i)});b.on("click",function(){(cu=f,s.$getvalueonchange!=!0)&&u.length==1&&(st(),w.is(":visible")||(ot.animate({width:"40%"}),w.animate({width:"30%"}),w.css({display:"inherit",width:"30%"}),a.animate({width:"30%"}),a.css("display","inherit"),o.animate({width:"30%"})),s.cmboonclick())});kt.on("click",function(){df()});bt.on("click",function(){ft=0;l.attr("checked",!1);v.attr("checked",!1);a.css("display","none");o.css("display","inherit");c.trigger("change");c.val("");w.animate({width:"0%"});w.css({display:"none",width:"0%"});ot.animate({width:"50%"});o.animate({width:"50%"});ut.empty()});ft==null&&k.prop("checked",!1);k.attr("checked")&&k.trigger("click");l.prop("checked")&&l.trigger("click");v.prop("checked")&&v.trigger("click");g.prop("disabled",!0);l.off("off");l.on("click",function(){l.is(":checked")?(v.prop("checked",!1),lt.removeClass("VA005-disabled"),g.removeClass("VA005-disabled"),li()):(lt.addClass("VA005-disabled"),g.addClass("VA005-disabled"),y.empty());pt.text(VIS.Msg.getMsg("VA005_LotValue"))});v.on("click",function(){lt.removeClass("VA005-disabled");g.removeClass("VA005-disabled");v.is(":checked")?(l.prop("checked",!1),lt.removeClass("VA005-disabled"),g.removeClass("VA005-disabled"),gi()):(lt.addClass("VA005-disabled"),g.addClass("VA005-disabled"),y.empty());pt.text(VIS.Msg.getMsg("VA005_SerialValue"));of()});g.on("click",function(n){(l.is(":checked")||v.is(":checked"))&&(n.stopPropagation(),vi.toggle(),rf())});k.on("click",function(){k.prop("checked")?d.attr("disabled",!1):(d.attr("disabled",!0),d.attr("checked",!1))});c.on("change",function(){c.val().trim().length<=0?c.addClass("vis-ev-col-mandatory"):c.removeClass("vis-ev-col-mandatory")});hr.on("click",function(){if(c.val().trim().length>0)af(),ai(),a.css("display","inherit"),o.css("display","none"),a.animate({width:"50%"});else return VIS.ADialog.info("VA005_NameFieldRequired"),!1;c.trigger("change");vt();c.trigger("change");a.css("display","inherit");o.css("display","none")});cr.on("click",function(){ai();c.trigger("change");a.css("display","inherit");o.css("display","none");a.animate({width:"50%"});t(".VA005-attributedivstatic").parent().attr("VA005_plusimg","N");ci();u=[];b.addClass("VA005-disabled");nt.addClass("VA005-disabled")});lt.on("click",function(){var t,n;ii!="null"||wt!="null"?(l.is(":checked")&&(t=VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/AttributeListing/GetWindow_ID",{Control:"Lot Control"}),n=new VIS.Query,n.addRestriction("M_LotCtl_ID",VIS.Query.prototype.EQUAL,ii),VIS.viewManager.startWindow(t,n)),v.is(":checked")&&(t=VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/AttributeListing/GetWindow_ID",{Control:"Serial No Control"}),n=new VIS.Query,n.addRestriction("M_SerNoCtl_ID",VIS.Query.prototype.EQUAL,wt),VIS.viewManager.startWindow(t,n))):VIS.ADialog.info("VA005_Selectlotorserialcheck")});y.on("change",function(){l.is(":checked")?ii=VIS.Utility.Util.getValueOfInt(y.val()):v.is(":checked")&&(wt=VIS.Utility.Util.getValueOfInt(y.val()))});wi.off("click");wi.on("click",function(){f=0;a.animate({width:"20%"});w.css({display:"inherit",width:"30%"});st();s.cleartext();o.css("display","inherit");var n="";n="<div id='"+i.windowNo+"divappendinleftsideboxes' class='VA005-attributediv  VA005-divboxtarget-design-hover'><label>"+VIS.Msg.getMsg("VA005_AddAttribute")+"<\/label><\/div>";r.prepend(t(n))})};this.removeatttvaluewithgrid=function(n,r,u){var h,o,f,s;for(e[0].style.visibility="visible",h=n+"_3_"+i.windowNo,o=t(p.find(".k-group").find("div[id='"+n+"_3_"+i.windowNo+"']")),f=0;f<o.length;f++)u<=0&&(s=t(p.find("div[id='"+n+"_3_"+i.windowNo+"']").parent().parent().parent().parent().parent()).find(".k-minus"),s.remove()),t(o[f]).parent().parent().parent().remove(),t(o[f]).remove();e[0].style.visibility="hidden"};this.updateatttvalueintree=function(n,t){var f,r,u;for(f=n+"_3_"+i.windowNo,r=p.find("div[id='"+f+"']"),u=0;u<r.length;u++)r.find("p").text(t)};this.addatttvaluewithgrid=function(n,r,u){var s,o,e,f;for(s=u+"_3_"+i.windowNo,n=n+"_2_"+i.windowNo,o=p.find("div[id='"+n+"']"),e=0;e<o.length;e++)f=p.data("kendoTreeView").append({text:r,NodeID:u,UID:s},t(o[e])),f.find("p").css({margin:"7px 12px 0px 67px"}),f.find("img").css("display","none"),t(f.find(".va005-editiconattvaluehide")).css("display","none"),f.find(".k-in").css("height","33px"),t(f.find(".va005-editiconattinfoclosehide")).css("display","none")};vt=function(){e[0].style.visibility="visible";t.ajax({url:VIS.Application.contextUrl+"AttributeListing/TreeViewForAttributeSetListing",type:"Get",async:!1,data:{Expend:i.windowNo},success:function(n){var i=JSON.parse(n);p&&p.data("kendoTreeView")!=undefined&&(p.data("kendoTreeView").destroy(),p.empty());p=ht.kendoTreeView({dragAndDrop:!1,dataSource:i,dataBound:function(){},select:function(n){au=!1;var r=t(n.node),i=t(r.find(".data-id ")).data("dtype");i==1?(su=i,kt.removeClass("VA005-disabled")):i==2?kt.addClass("VA005-disabled"):i==3&&kt.addClass("VA005-disabled")},template:"<div  id='#= item.UID #'  nid='#= item.NID #'  class='va005-parentss'><div class='#= item.classforgetnod #'><div  class='va005_mouseover' style='float:left'><i class='#= item.ImageSource #' style='display:#= item.visibility #''><\/i><p>#= item.text #<\/p><\/div><\/div><div class='va005-editiconattvaluehide'  ><div style='display:#= item.visibility #'><a  style='display:#= item.visibility #' data-nodeid='#= item.NodeID #' data-dType= '#= item.Type #' class='data-id va005_editSet vis vis-edit va005-editattributecls' ><\/a><\/div><\/div><div style='margin: 0;float:left' class='va005-editiconattinfoclosehide'><div style='width:58px;float:right;display:#= item.ShowInfo #'><a style='cursor:pointer;display:#= item.ShowInfo #'><span  data-nodeid='#= item.NodeID #' class='va005_editattribute fa fa-italic'  style='float: left;margin: 9px 0px 10px 9px;display:#= item.ShowInfo #''><\/span><\/a><a style='cursor:pointer;display:#= item.ShowInfo #'><span  data-parentid='#= item.ParentID #'  data-nodeid='#= item.NodeID #' class='va005_remove fa fa-times'  style='float: left;margin: 9px 0px 10px 9px;display:#= item.ShowInfo #''><\/span><\/a><\/div><\/div><\/div>"});p.off(VIS.Events.onTouchStartOrClick,".va005_editSet");p.on(VIS.Events.onTouchStartOrClick,".va005_editSet",kf);p.off(VIS.Events.onTouchStartOrClick,".va005_editattribute");p.on(VIS.Events.onTouchStartOrClick,".va005_editattribute",ie);p.on(VIS.Events.onTouchStartOrClick,".va005_remove",wf);e[0].style.visibility="hidden";pu()},error:function(n){alert(n);e[0].style.visibility="hidden"}});pf()};bf=!1;tr=null;wt=null;this.disposeComponent=function(){s.disposeComponent();ce();h=null;ht=null;bt=null;o=null;c=null;yt=null;ct=null;k=null;d=null;l=null;v=null;pt=null;y=null;g=null;nu=null;it=null;rt=null;dt=null;gt=null;ni=null;ti=null;tu=null;vi=null};this.formSizeChanged=function(){ht.height(a.height()-(a.find(".VA005-top-wrap-div-h").height()+10))};this.sizeChanged=function(n,t){this.formSizeChanged(n,t)}}i.prototype.init=function(n,t){this.windowNo=n;this.frame=t;var i=this.initialize();this.frame.getContentGrid().append(this.getRoot());this.formSizeChanged()};i.prototype.sizeChanged=function(n,t){this.formSizeChanged(n,t)};i.prototype.refresh=function(){this.formSizeChanged()};i.prototype.dispose=function(){this.disposeComponent();this.frame&&this.frame.dispose();this.frame=null};n.AForms=n.AForms||{};n.AForms.AttributeSetListing=i}(VA005,jQuery);VA005=window.VA005||{},function(n,t){n.uploadImage=function(n,i,r,u,f,e){function br(){cr();ci();lr();b();p.val("1.0");vr()}function cr(){o=t("<div class='va005-imageupload-popupwrap'><\/div>");st=t('<div class="demo-section k-header"><\/div>');vt=t('<input name="files" id="files" type="file" capture="camera" accept="image/*"/>');st.append(vt);o.append(st);y=t('<div"><\/div>');nt=t("<div><\/div>");tt=t('<div style="float:left"><\/div>');it=t('<div style="float:left;margin-left:60px;"><\/div>');rt=t('<div style="margin-top:80px;"><\/div>');gt=t("<p>"+VIS.Msg.getMsg("VADMS_DocName")+"<p>");ni=t('<input type="text" style="width:100%;"><\/input>');ti=t("<p>"+VIS.Msg.getMsg("VADMS_MetaDataName")+"<p>");ii=t('<input type="text" style="width:350px;"><\/input>');ri=t("<p>"+VIS.Msg.getMsg("VADMS_FileType")+"<p>");ui=t('<input type="text" style="width:350px;"><\/input>');fi=t("<p>"+VIS.Msg.getMsg("VADMS_Description")+"<p>");ei=t('<textarea type="text" style="width:100%;"><\/textarea>');nt.append(gt);nt.append(ni);tt.append(ti);tt.append(ii);it.append(ri);it.append(ui);rt.append(fi);rt.append(ei);y.append(nt);y.append(tt);y.append(it);y.append(rt);y.css("display","none");w=t("<div><\/div>");ut=t('<div style="margin-top:10px;"><\/div>');ft=t('<div style="float:right;margin-left:428px;margin-top:-50px;"><\/div>');et=t('<div style="margin-top:10px;"><\/div>');ot=t('<div style="float:right;margin-top:-50px;"><\/div>');yt=t('<p style="display:none">'+VIS.Msg.getMsg("VADMS_DocType")+"<p>");d=t('<select style="width:320px;display:none"><\/select>');d.append(oi);pt=t('<p style="display:none">'+VIS.Msg.getMsg("VADMS_Version")+"<\/p>");p=t('<input type="text" style="width:320px;display:none" maxlength="10" pattern="[0-9.]*"><\/input>');wt=t('<p style="display:none">'+VIS.Msg.getMsg("VADMS_IskeepVersion")+"<\/p>");ht=t('<select style="width:320px;display:none"><\/select>');bt=t('<p style="display:none">'+VIS.Msg.getMsg("VADMS_SaveIn")+"<\/p>");dt=t('<div style="display:none"><\/div>');ut.append(yt);ut.append(d);ft.append(pt);ft.append(p);et.append(wt);et.append(ht);ot.append(bt);ot.append(dt);w.append(ut);w.append(ft);w.append(et);w.append(ot);k=t('<div class="VA005-doc_information"><\/div>');g=t('<div class="vis-pull-right"><\/div>');c=t('<input type="submit" class="VA005-upload-buttons VA005-poupOkCancelBtn" value='+VIS.Msg.getMsg("OK")+"><\/input>");ct=t('<input type="submit" class="VA005-poupOkCancelBtn" value='+VIS.Msg.getMsg("Cancel")+"><\/input>");g.append(ct);g.append(c);k.append(y);k.append(w);k.append(g);o.append(k);var n=t('<script id="fileTemplate" type="text/x-kendo-template"> <span class="k-progress"><\/span>  <div class="file-wrapper" style="margin-top:5px;"> <div class="VA005-attach-file-top"><a class="file-close-ico"><\/a><\/div> <div class="VA005-attach-file-content">  <div class="VA005-file-icon #=addExtensionClass(files[0].extension)#"><\/div> <div class="VA005-attach-file-text" style="margin-bottom:10px">   <h4 class="file-heading file-name-heading">#=CheckName(files[0].name)#<\/h4>  <h4 class="file-heading file-size-heading">#=size# bytes<\/h4>  <h4 class="file-heading file-size-heading" style="display: none;">#=getUID(files[0].uid)#<\/h4><\/div><\/div>  <button type="button" class="k-upload-action"><\/button> <\/div>  <\/script>');o.append(n);o.append(t('<script>function addExtensionClass(extension) {switch (extension) {  case ".jpg": case ".img": case ".png":  case ".gif":     return "VA005-img-file";  case ".doc": case ".docx":     return "vadms-doc-file"; case ".xls": case ".xlsx":     return "vadms-xls-file"; case ".pdf":     return "vadms-pdf-file"; case ".txt":     return "vadms-text-file";case ".zip":case ".rar":   return "vadms-zip-file";default:   return "vadms-default-file";}}<\/script>'));o.append(t("<script> function CheckName(name) {var lblFName = $(\"<p>\");if (name.length > 17) {var shortName = name.toString().substr(0, 17);lblFName.append(shortName); var aFName = $(\"<a class='VIS_Pref_tooltip'>\").append('...');var span = $(\"<span style='top:40px'>\");span.append($(\"<img class='VIS_Pref_callout'>\").attr('src', VIS.Application.contextUrl + 'Areas/VIS/Images/ccc.png').append('ToolTip Text'));span.append($(\"<label class='VIS_Pref_Label_Font'>\").append(name));aFName.append(span);lblFName.append(aFName)}else {lblFName.append(name);}return lblFName.html();}<\/script>"));o.append(t("<script>function getUID(uid) {return uid;}<\/script>"));c.prop("disabled",!0)}function lr(){function r(n){lt+=1;b();sr=t(".file-close-ico");f();var i=n.files;s>0&&lt==v&&c.prop("disabled",!1)}function n(n){n>3&&l.css("height","380px");n==0?(l.css("height","247px"),t(".k-upload-files").css("overflow","hidden")):n>6?(t(".k-upload-files").css("overflow","scroll"),l.css("height","450px")):n>0&&n<=3&&(l.css("height","280px"),t(".k-upload-files").css("overflow","hidden"))}function u(t){v=v-1;for(var i=0;i<a.length;i++)a[i].name==t.files[0].name&&(at=jQuery.grep(at,function(n){return n!==a[i].folderKey}),a.splice(i,1),s--);n(s);lt==v&&c.prop("disabled",!1)}function f(){sr.on("click",function(){var r=t(t(t(t(this).parent()).parent()).children()[4]).text(),n=t(t(t(this).parent()).parent()).parent(),i;n.css("display","none");i=n.html();s==1&&t(t(t(t(this).parent()).parent()).parent()).parent().remove();n.remove();n.empty();n=null;i!=null&&s>0&&s--;t.ajax({async:!1,type:"GET",url:VIS.Application.contextUrl+"VA005/ProductManagement/RemoveFile?uid="+r,dataType:"Json",success:function(){},error:function(n){console.log(n)}});s==0&&(l.css("height","252px"),t(".k-upload-files").css("height","0px"),c.prop("disabled",!0),t(".k-upload-files").css("overflow","hidden"),t(t(t("#files").parent()).parent()).children()[2].remove());s>3?l.css("height","380px"):s>0&&s<=3&&(l.css("height","280px"),t(".k-upload-files").css("overflow","hidden"));s>6&&(t(".k-upload-files").css("overflow","scroll"),l.css("height","453px"))})}function e(n){var t;hr=n.files;c.prop("disabled",!0);t=lt;lt=0;v=hr.length;b()}var i=VIS.Application.contextUrl+"VA005/ProductManagement/SaveImages";t("#files").kendoUpload({async:{saveUrl:i,autoUpload:!0,localization:{select:"customSelect"}},select:e,upload:function(i){var e=i.files[0].extension,o=e.toLowerCase(),r,u,f;if(t.inArray(o,[".jpg",".jpeg",".gif",".png",".img",".bmp",".tiff",".bpg",".thumb",".psd"])==-1){v=v-1;i.preventDefault();hi>0&&c.prop("disabled",!1);return}for(r=0;r<a.length;r++)if(i.files[0].name==a[r].name){v=v-1;i.preventDefault();hi>0&&c.prop("disabled",!1);return}for(u=(new Date).getTime(),i.data={folderKey:u},b(),hi++,f=0;f<i.files.length;f++)a[s]=i.files[f],t(a[s]).attr("folderKey",u),at[s]=u,s++;n(s)},success:r,cancel:u,error:function(){b()},progress:function(){b()},template:kendo.template(t("#fileTemplate").html())});si=t("#files").data("kendoUpload")}function b(){o.find(".k-file").css("display","-webkit-inline-box");o.find(".k-file").css("width","194px");o.find(".k-file").css("margin","9px 11px 0px 0px");o.find(".k-file").css("float","left");o.find(".k-button").css("color","rgba(var(--v-c-on-primary), 1)");o.find(".k-button").css("background-color","rgba(var(--v-c-primary), 1)");o.find(".k-button").css("background-image","none");o.find(".k-button").css("border","none");o.find(".k-button").css("margin-left","-3px");o.find(".k-header").css("background-color","white");o.find(".k-upload-files").css("max-height","200px");o.find(".k-upload-empty").css("border-width","1px");o.find(".k-upload-files").css("overflow","hidden");o.find(".k-upload-files").css("background","white");o.find(".k-upload-files").css("margin-left","10px");o.find(".k-upload-files.k-reset").css({"margin-left":"0px",overflow:"hidden","max-height":"300px",background:"white",float:"left",width:"100%","box-sizing":"border-box",padding:"0 10px"});o.find(".k-widget.k-upload.k-header").css({float:"left",width:"100%"});o.find(".k-progress").css("background-color","#ddffd0")}function ar(){t.ajax({async:!0,type:"POST",url:VIS.Application.contextUrl+"VA005/ProductManagement/Remove",dataType:"Json",contentType:"application/json; charset=utf-8",data:JSON.stringify({fKey:at,cancle:li}),success:function(){},error:function(n){console.log(n)}});at=[]}function ci(){h=new VIS.ChildDialog;h.setContent(o);h.setHeight(230);h.setWidth(705);h.setTitle(VIS.Msg.getMsg("VA005_UploadImage"));h.setEnableResize(!1);h.setModal(!0);l=h.show();h.hidebuttons()}function vr(){c.on("click",function(){pr.GetImages();h.close()});p.on("keypress",function(n){n.stopPropagation();var t=n.keyCode?n.keyCode:n.which;if(!/^[0-9. ]*$/.test(String.fromCharCode(n.keyCode))&&t!=13){n.preventDefault();return}});ct.on("click",function(){li=!0;h.close();ar();yr()});ci.onClose=function(){yr()}}function yr(){o=null;st=null;vt=null;k=null;vi=null;yi=null;pi=null;wi=null;bi=null;ki=null;yt=null;d=null;pt=null;p=null;di=null;gi=null;nr=null;tr=null;ir=null;wt=null;ht=null;bt=null;kt=null;g=null;c=null;ct=null;oi=null;rr=null;ur=null;fr=null;er=null;h=null;dt=null;or=null;y=null;nt=null;tt=null;it=null;rt=null;gt=null;ni=null;ti=null;ii=null;ri=null;ui=null;fi=null;ei=null;w=null;ut=null;ft=null;et=null;ot=null;s=0;si.destroy()}var li=!1,pr=e,ai=f,kr=VIS.Logging.VLogger.getVLogger("UploadDocument"),dr=this,o=null,st=null,vt=null,k=null,vi=null,yi=null,pi=null,wi=null,bi=null,ki=null,yt=null,d=null,pt=null,p=null,di=null,gi=null,nr=null,tr=null,ir=null,wt=null,ht=null,bt=null,kt=null,g=null,c=null,ct=null,oi="",rr="",ur="",fr=null,er=null,s=0,a=[],h=null,si=null,dt=null,or=null,sr=null,hr=null,l=null,v=null,lt=0,hi=0,y=null,nt=null,tt=null,it=null,rt=null,gt=null,ni=null,ti=null,ii=null,ri=null,ui=null,fi=null,ei=null,w=null,ut=null,ft=null,et=null,ot=null,at=[],wr;this.FileArray=[];wr=0;br();this.initialize=function(){cr();ci();lr();b();p.val("1.0");vr()};t(window).on("resize",function(){});this.disposeComponent=function(){o=null;st=null;vt=null;k=null;vi=null;yi=null;pi=null;wi=null;bi=null;ki=null;yt=null;d=null;pt=null;p=null;di=null;gi=null;nr=null;tr=null;ir=null;wt=null;ht=null;bt=null;kt=null;g=null;c=null;ct=null;oi=null;rr=null;ur=null;fr=null;er=null;h=null;ar();dt=null;or=null;y=null;nt=null;tt=null;it=null;rt=null;gt=null;ni=null;ti=null;ii=null;ri=null;ui=null;fi=null;ei=null;w=null;ut=null;ft=null;et=null;ot=null;s=0;si.destroy()}};n.uploadImage.prototype.init=function(n,t){this.frame=t;this.windowNo=n};n.uploadImage.prototype.dispose=function(){this.disposeComponent();this.frame&&this.frame.dispose();this.frame=null}}(VA005,jQuery);VA005=window.VA005||{},function(n,t){n.StickerProduct=function(){};n.StickerProduct.prototype.create=function(n,i,r){function e(){var l,s;var h={output:"css",bgColor:"#FFFFFF",color:"#000000",barWidth:1,barHeight:30,moduleSize:2,addQuietZone:1},f=0,a=0,v=0,y=0,p=0,w="",d="",b="",u="",e=null,c=t("#VA005_Barcode"),k=VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductManagement/LoadPriceListData",{M_PriceList_ID:i});k!=null&&(b=k.ISO_Code);for(item in r)if(a=VIS.Utility.Util.getValueOfInt(r[item].product_ID),d=VIS.Utility.Util.getValueOfString(r[item].product),u=VIS.Utility.Util.getValueOfString(r[item].UPC),v=VIS.Utility.Util.getValueOfInt(r[item].C_Uom_ID),y=VIS.Utility.Util.getValueOfInt(r[item].attribute_ID),p=VIS.Utility.Util.getValueOfInt(r[item].Qty),o(u)!=!0&&u.indexOf(":")==-1&&u.indexOf(";")==-1&&u.indexOf("!")==-1&&u.indexOf("~")==-1)for(w=VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VA005/ProductManagement/GetListPrice",{PriceListVersion_ID:i,Product_ID:a,UOM:v,Attribute:y}),l=0;l<p;l++)f=f+1,e=f==1?u.length==13?'<div style="text-align: center;width:100%;margin-left: -13px;margin-top: 0px  " >':'<div style="text-align: center;width:100%;margin-left: -4px;margin-top: 0px  " >':u.length==13?'<div style="text-align: center;width:100%;margin-top: 20px;margin-left: -13px; " >':'<div style="text-align: center;width:100%;margin-top: 20px;margin-left: -4px; " >',e+=n!=null?"<div id=VA005_Header"+f+' style="font-size: small;width:100%;">'+n+"<\/div>":"<div id=VA005_Header"+f+' style="font-size: small;width:100%;"> &nbsp; <\/div>',e+="<div id=VA005_Bars"+f+' style="margin: 0 auto;"><\/div>',e+="<div id=VA005_Price"+f+' style="font-size: small;width:100%">'+w+" "+b+"<\/div>",e+="<\/div>",c.append(e),e=null,u.length==12?t("#VA005_Bars"+f).html("").show().barcode(u,"ean13",h):u.length==7?t("#VA005_Bars"+f).html("").show().barcode(u,"ean8",h):u.length==4?t("#VA005_Bars"+f).html("").show().barcode(u,"code39",h):t("#VA005_Bars"+f).html("").show().barcode(u,"code128",h);s=window.open();s.document.write("<html><head>");s.document.write("<\/head><body >");s.document.write(c.html());s.document.write("<\/body><\/html>");s.print();s.close();c.empty()}function o(n){return/[@#$%^&*()_\\"|?/`,.<>{}+=]/.test(n)}var f,u;f=t('<div style="width: 100%;" >');f=t('<div id="VA005_Barcode" style="width:112px"><\/div>');f.append(t("<\/div>"));u=new VIS.ChildDialog;u.setContent(f);u.setTitle(VIS.Msg.getMsg("VA005_GenerateSticker"));u.setWidth("40%");u.setEnableResize(!1);u.setModal(!0);u.show();u.onOkClick=function(){e()}}}(VA005,jQuery),function(n){var u=n(window),o={},f=[],e=[],h,s=null,c="_open",v="_close",i=[],l=null,a,y=/(iPad|iPhone|iPod)/g.test(navigator.userAgent),p="a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]",t={_init:function(i){var r=n(i),u=r.data("popupoptions");e[i.id]=!1;f[i.id]=0;r.data("popup-initialized")||(r.attr("data-popup-initialized","true"),t._initonce(i));u.autoopen&&setTimeout(function(){t.show(i,0)},0)},_initonce:function(i){var u=n(i),v=n("body"),f,r=u.data("popupoptions"),o,p,w,a,e;if(s=parseInt(v.css("margin-right"),10),l=document.body.style.webkitTransition!==undefined||document.body.style.MozTransition!==undefined||document.body.style.msTransition!==undefined||document.body.style.OTransition!==undefined||document.body.style.transition!==undefined,r.type=="tooltip"&&(r.background=!1,r.scrolllock=!1),r.backgroundactive&&(r.background=!1,r.blur=!1,r.scrolllock=!1),r.scrolllock&&typeof h=="undefined"&&(p=n('<div style="width:50px;height:50px;overflow:auto"><div/><\/div>').appendTo("body"),w=p.children(),h=w.innerWidth()-w.height(99).innerWidth(),p.remove()),u.attr("id")||u.attr("id","j-popup-"+parseInt(Math.random()*1e8,10)),u.addClass("popup_content"),v.prepend(i),u.wrap('<div id="'+i.id+'_wrapper" class="popup_wrapper" />'),f=n("#"+i.id+"_wrapper"),f.addClass("VA005-popupcontentwrapper"),f.css({opacity:0,visibility:"hidden",position:"absolute"}),y&&f.css("cursor","pointer"),r.type=="overlay"&&f.css("overflow","auto"),u.css({opacity:0,visibility:"hidden",display:"inline-block"}),r.setzindex&&!r.autozindex&&f.css("z-index","100001"),r.outline||u.css("outline","none"),r.transition&&(u.css("transition",r.transition),f.css("transition",r.transition)),u.attr("aria-hidden",!0),r.background&&!n("#"+i.id+"_background").length&&(v.prepend('<div id="'+i.id+'_background" class="popup_background"><\/div>'),a=n("#"+i.id+"_background"),a.css({opacity:0,visibility:"hidden",backgroundColor:r.color,position:"fixed",top:0,right:0,bottom:0,left:0}),r.setzindex&&!r.autozindex&&a.css("z-index","100000"),r.transition&&a.css("transition",r.transition)),r.type=="overlay"&&(u.css({textAlign:"left",position:"relative",verticalAlign:"middle"}),o={position:"fixed",width:"100%",height:"100%",top:0,left:0,textAlign:"center"},r.backgroundactive&&(o.position="relative",o.height="0",o.overflow="visible"),f.css(o),f.append('<div class="popup_align" />'),n(".popup_align").css({display:"inline-block",verticalAlign:"middle",height:"100%"})),u.attr("role","dialog"),e=r.openelement?r.openelement:"."+i.id+c,n(e).each(function(t,i){n(i).attr("data-popup-ordinal",t);i.id||n(i).attr("id","open_"+parseInt(Math.random()*1e8,10))}),u.attr("aria-labelledby")||u.attr("aria-label")||u.attr("aria-labelledby",n(e).attr("id")),r.action=="hover"){r.keepfocus=!1;n(e).on("mouseenter",function(){t.show(i,n(this).data("popup-ordinal"))});n(e).on("mouseleave",function(){t.hide(i)})}else n(document).on("click",e,function(r){r.preventDefault();var u=n(this).data("popup-ordinal");setTimeout(function(){t.show(i,u)},0)});r.closebutton&&t.addclosebutton(i);r.detach?u.hide().detach():f.hide()},show:function(o,c){var p=n(o),k,b;if(!p.data("popup-visible")){p.data("popup-initialized")||t._init(o);p.attr("data-popup-initialized","true");var d=n("body"),y=p.data("popupoptions"),w=n("#"+o.id+"_wrapper"),nt=n("#"+o.id+"_background");if(r(o,c,y.beforeopen),e[o.id]=c,setTimeout(function(){i.push(o.id)},0),y.autozindex){var tt=document.getElementsByTagName("*"),it=tt.length,g=0;for(k=0;k<it;k++)b=n(tt[k]).css("z-index"),b!=="auto"&&(b=parseInt(b,10),g<b&&(g=b));f[o.id]=g;y.background&&f[o.id]>0&&n("#"+o.id+"_background").css({zIndex:f[o.id]+1});f[o.id]>0&&w.css({zIndex:f[o.id]+2})}if(y.detach?(w.prepend(o),p.show()):w.show(),a=setTimeout(function(){w.css({visibility:"visible",opacity:1});n("html").addClass("popup_visible").addClass("popup_visible_"+o.id);w.addClass("popup_wrapper_visible")},20),y.scrolllock&&(d.css("overflow","hidden"),d.height()>u.height()&&d.css("margin-right",s+h)),y.backgroundactive&&p.css({top:(u.height()-(p.get(0).offsetHeight+parseInt(p.css("margin-top"),10)+parseInt(p.css("margin-bottom"),10)))/2+"px"}),p.css({visibility:"visible",opacity:1}),y.background&&(nt.css({visibility:"visible",opacity:y.opacity}),setTimeout(function(){nt.css({opacity:y.opacity})},0)),p.data("popup-visible",!0),t.reposition(o,c),p.data("focusedelementbeforepopup",document.activeElement),y.keepfocus&&(p.attr("tabindex",-1),setTimeout(function(){y.focuselement==="closebutton"?n("#"+o.id+" ."+o.id+v+":first").focus():y.focuselement?n(y.focuselement).focus():p.focus()},y.focusdelay)),n(y.pagecontainer).attr("aria-hidden",!0),p.attr("aria-hidden",!1),r(o,c,y.onopen),l)w.one("transitionend",function(){r(o,c,y.opentransitionend)});else r(o,c,y.opentransitionend)}},hide:function(t,u){var c=n.inArray(t.id,i);if(c!==-1){a&&clearTimeout(a);var v=n("body"),f=n(t),o=f.data("popupoptions"),h=n("#"+t.id+"_wrapper"),y=n("#"+t.id+"_background");if(f.data("popup-visible",!1),i.length===1?n("html").removeClass("popup_visible").removeClass("popup_visible_"+t.id):n("html").hasClass("popup_visible_"+t.id)&&n("html").removeClass("popup_visible_"+t.id),i.splice(c,1),h.hasClass("popup_wrapper_visible")&&h.removeClass("popup_wrapper_visible"),o.keepfocus&&!u&&setTimeout(function(){n(f.data("focusedelementbeforepopup")).is(":visible")&&f.data("focusedelementbeforepopup").focus()},0),h.css({visibility:"hidden",opacity:0}),f.css({visibility:"hidden",opacity:0}),o.background&&y.css({visibility:"hidden",opacity:0}),n(o.pagecontainer).attr("aria-hidden",!1),f.attr("aria-hidden",!0),r(t,e[t.id],o.onclose),l&&f.css("transition-duration")!=="0s")f.one("transitionend",function(){f.data("popup-visible")||(o.detach?f.hide().detach():h.hide());o.scrolllock&&setTimeout(function(){v.css({overflow:"visible","margin-right":s})},10);r(t,e[t.id],o.closetransitionend)});else o.detach?f.hide().detach():h.hide(),o.scrolllock&&setTimeout(function(){v.css({overflow:"visible","margin-right":s})},10),r(t,e[t.id],o.closetransitionend)}},toggle:function(i,r){n(i).data("popup-visible")?t.hide(i):setTimeout(function(){t.show(i,r)},0)},reposition:function(t,i){var s=n(t),r=s.data("popupoptions"),f=n("#"+t.id+"_wrapper"),h=n("#"+t.id+"_background"),o,e;i=i||0;r.type=="tooltip"?(f.css({position:"absolute"}),o=r.tooltipanchor?n(r.tooltipanchor):r.openelement?n(r.openelement).filter('[data-popup-ordinal="'+i+'"]'):n("."+t.id+c+'[data-popup-ordinal="'+i+'"]'),e=o.offset(),r.horizontal=="right"?f.css("left",e.left+o.outerWidth()+r.offsetleft):r.horizontal=="leftedge"?f.css("left",e.left+o.outerWidth()-o.outerWidth()+r.offsetleft):r.horizontal=="left"?f.css("right",u.width()-e.left-r.offsetleft):r.horizontal=="rightedge"?f.css("right",u.width()-e.left-o.outerWidth()-r.offsetleft):f.css("left",e.left+o.outerWidth()/2-s.outerWidth()/2-parseFloat(s.css("marginLeft"))+r.offsetleft),r.vertical=="bottom"?f.css("top",e.top+o.outerHeight()+r.offsettop):r.vertical=="bottomedge"?f.css("top",e.top+o.outerHeight()-s.outerHeight()+r.offsettop):r.vertical=="top"?f.css("bottom",u.height()-e.top-r.offsettop):r.vertical=="topedge"?f.css("bottom",u.height()-e.top-s.outerHeight()-r.offsettop):f.css("top",e.top+o.outerHeight()/2-s.outerHeight()/2-parseFloat(s.css("marginTop"))+r.offsettop)):r.type=="overlay"&&(r.horizontal?f.css("text-align",r.horizontal):f.css("text-align","center"),r.vertical?s.css("vertical-align",r.vertical):s.css("vertical-align","middle"))},addclosebutton:function(t){var i;i=n(t).data("popupoptions").closebuttonmarkup?n(o.closebuttonmarkup).addClass(t.id+"_close"):'<button class="popup_close '+t.id+'_close" title="Close" aria-label="Close"><span aria-hidden="true">×<\/span><\/button>';$el.data("popup-initialized")&&$el.append(i)}},r=function(t,i,r){var u=n(t).data("popupoptions"),f=u.openelement?u.openelement:"."+t.id+c,e=n(f+'[data-popup-ordinal="'+i+'"]');typeof r=="function"&&r.call(n(t),t,e)};n(document).on("keydown",function(r){if(i.length){var f=i[i.length-1],u=document.getElementById(f);n(u).data("popupoptions").escape&&r.keyCode==27&&t.hide(u)}});n(document).on("click",function(r){if(i.length){var f=i[i.length-1],u=document.getElementById(f),e=n(u).data("popupoptions").closeelement?n(u).data("popupoptions").closeelement:"."+u.id+v;n(r.target).closest(e).length&&(r.preventDefault(),t.hide(u));n(u).data("popupoptions").blur&&!n(r.target).closest("#"+f).length&&r.which!==2&&n(r.target).is(":visible")&&(n(u).data("popupoptions").background?(t.hide(u),r.preventDefault()):t.hide(u,!0))}});n(document).on("keydown",function(t){if(i.length&&t.which==9){var o=i[i.length-1],f=document.getElementById(o),s=n(f).find("*"),r=s.filter(p).filter(":visible"),h=n(":focus"),u=r.length,e=r.index(h);u===0?(n(f).focus(),t.preventDefault()):t.shiftKey?e===0&&(r.get(u-1).focus(),t.preventDefault()):e==u-1&&(r.get(0).focus(),t.preventDefault())}});n.fn.popup=function(i){return this.each(function(){var r=n(this),u;typeof i=="object"?(u=n.extend({},n.fn.popup.defaults,i),r.data("popupoptions",u),o=r.data("popupoptions"),t._init(this)):typeof i=="string"?(r.data("popupoptions")||(r.data("popupoptions",n.fn.popup.defaults),o=r.data("popupoptions")),t[i].call(this,this)):(r.data("popupoptions")||(r.data("popupoptions",n.fn.popup.defaults),o=r.data("popupoptions")),t._init(this))})};n.fn.popup.defaults={type:"overlay",autoopen:!1,background:!0,backgroundactive:!1,color:"black",opacity:"0.5",horizontal:"center",vertical:"middle",offsettop:0,offsetleft:0,escape:!0,blur:!0,setzindex:!0,autozindex:!1,scrolllock:!1,closebutton:!1,closebuttonmarkup:null,keepfocus:!0,focuselement:null,focusdelay:50,outline:!1,pagecontainer:null,detach:!1,openelement:null,closeelement:null,transition:null,tooltipanchor:null,beforeopen:null,onclose:null,onopen:null,opentransitionend:null,closetransitionend:null}}(jQuery)